(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"2Doj":function(t,o,a){"use strict";a.r(o),a.d(o,"NewPurchaseModule",function(){return wt});var e=a("SVse"),r=a("s7LF"),i=a("GmJt"),s=a("3kSh"),c=a("3sEA"),n=a("vpPe"),l=a("wd/R"),u=a("cp0P"),m=a("JX91"),p=a("lJxs"),d=a("Sp5M"),h=a("CHRX"),f=a("qA6C"),b=a("UVsP"),g=a("AytR"),v=a("8Y7J"),_=a("IheW");let C=(()=>{class t{constructor(t){this.http=t}obtenerImpuestos(){return this.http.get(g.a.apiURL+'Impuestos?filter={"where":{"deletedon":{"eq":null}}}')}obtenerSucursales(){return this.http.get(g.a.apiURL+'Sucursales?filter={"where":{"deletedon":{"eq":null}},"order":"sdescripcion ASC"}')}obtenerDepositoXSucursal(t){return this.http.get(`${g.a.apiURL}Sucursales/DepositoXSucursal?idsucursal=${t}`)}guardarCompra(t){return this.http.post(g.a.apiURL+"Compras",t)}guardarCompraItem(t){return this.http.post(g.a.apiURL+"ComprasItems",t)}guardarImpuestos(t){return this.http.post(g.a.apiURL+"ImpuestosXCompra",t)}}return t.\u0275fac=function(o){return new(o||t)(v.bc(_.c))},t.\u0275prov=v.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var F=a("zHaW"),D=a("iInd"),w=a("VDRc"),O=a("Q2Ze"),x=a("e6WT"),E=a("vrAh"),W=a("ZTz/"),y=a("pMoy"),S=a("n1FK"),X=a("TN/R"),k=a("Dxy4"),I=a("Tj54"),M=a("PDjf"),P=a("w9WL"),A=a("UhP/"),R=a("TSSN");function N(t,o){if(1&t&&(v.Xb(0,"mat-option",53),v.Oc(1),v.Wb()),2&t){const t=o.$implicit;v.pc("value",t),v.Eb(1),v.Qc(" ",null==t?null:t.srazonsocial," ")}}function j(t,o){if(1&t&&(v.Xb(0,"mat-option",53),v.Oc(1),v.Wb()),2&t){const t=o.$implicit;v.pc("value",t),v.Eb(1),v.Qc(" ",t," ")}}function V(t,o){if(1&t&&(v.Xb(0,"mat-option",53),v.Oc(1),v.Wb()),2&t){const t=o.$implicit;v.pc("value",t),v.Eb(1),v.Qc(" ",t," ")}}function U(t,o){if(1&t&&(v.Xb(0,"mat-option",53),v.Oc(1),v.Wb()),2&t){const t=o.$implicit;v.pc("value",t),v.Eb(1),v.Qc(" ",t.sdescripcion," ")}}function T(t,o){if(1&t){const t=v.Yb();v.Xb(0,"mat-form-field",23),v.Xb(1,"mat-label"),v.Oc(2),v.kc(3,"translate"),v.Wb(),v.Xb(4,"mat-select",8),v.fc("ngModelChange",function(o){return v.Dc(t),v.jc().form_sucursal=o}),v.Mc(5,U,2,2,"mat-option",5),v.Wb(),v.Wb()}if(2&t){const t=v.jc();v.Eb(2),v.Pc(v.lc(3,3,"Dep\xf3sito de la Sucursal")),v.Eb(2),v.pc("ngModel",t.form_sucursal),v.Eb(1),v.pc("ngForOf",t.sucursales_data)}}function L(t,o){if(1&t&&(v.Xb(0,"mat-option",53),v.Oc(1),v.Wb()),2&t){const t=o.$implicit;v.pc("value",t),v.Eb(1),v.Rc(" ",null==t?null:t.scodproducto," - ",null==t?null:t.snombre," ")}}function H(t,o){if(1&t){const t=v.Yb();v.Xb(0,"mat-form-field",54),v.Xb(1,"mat-label"),v.Oc(2),v.kc(3,"translate"),v.Wb(),v.Sb(4,"input",55),v.Xb(5,"mat-autocomplete",3,56),v.fc("optionSelected",function(o){return v.Dc(t),v.jc().selectedItemChangeProducto(o.option.value)}),v.Mc(7,L,2,3,"mat-option",5),v.kc(8,"async"),v.Wb(),v.Wb()}if(2&t){const t=v.Ac(6),o=v.jc();v.Eb(2),v.Pc(v.lc(3,5,"Producto")),v.Eb(2),v.pc("formControl",o.editorProducto)("matAutocomplete",t),v.Eb(1),v.pc("displayWith",o.displayFnProductos),v.Eb(2),v.pc("ngForOf",v.lc(8,7,o.filteredProductos))}}function G(t,o){if(1&t&&(v.Xb(0,"mat-form-field",57),v.Xb(1,"mat-label"),v.Oc(2,"Detalle"),v.Wb(),v.Sb(3,"input",58),v.Wb()),2&t){const t=v.jc();v.Eb(3),v.pc("formControl",t.form_servicio)}}function q(t,o){1&t&&(v.Xb(0,"mat-label"),v.Oc(1,"Precio Neto"),v.Wb())}function B(t,o){1&t&&(v.Xb(0,"mat-label"),v.Oc(1,"Precio Unitario"),v.Wb())}function $(t,o){if(1&t&&(v.Xb(0,"mat-form-field",14),v.Xb(1,"mat-label"),v.Oc(2,"Precio Final"),v.Wb(),v.Sb(3,"input",59),v.Wb()),2&t){const t=v.jc();v.Eb(3),v.pc("formControl",t.form_precio_final)}}function Q(t,o){if(1&t&&(v.Oc(0),v.kc(1,"number")),2&t){const t=o.row;v.Qc(" ",v.lc(1,1,null==t?null:t.rcantidad)," ")}}function z(t,o){if(1&t&&v.Oc(0),2&t){const t=o.row;v.Qc(" ",null==t?null:t.sconcepto," ")}}function Y(t,o){if(1&t&&(v.Oc(0),v.kc(1,"currency")),2&t){const t=o.row;v.Qc(" ",v.lc(1,1,null==t?null:t.rpreciou)," ")}}function K(t,o){if(1&t&&(v.Xb(0,"ngx-datatable-column",38),v.kc(1,"translate"),v.Mc(2,Y,2,3,"ng-template",39),v.Wb()),2&t){const t=v.jc();v.qc("name",v.lc(1,3,"Precio")),v.pc("cellClass",t.getCellClass)("flexGrow",1)}}function J(t,o){if(1&t&&(v.Oc(0),v.kc(1,"currency")),2&t){const t=o.row;v.Qc(" ",v.lc(1,1,null==t?null:t.rtotal)," ")}}function Z(t,o){if(1&t&&(v.Xb(0,"ngx-datatable-column",38),v.kc(1,"translate"),v.Mc(2,J,2,3,"ng-template",39),v.Wb()),2&t){const t=v.jc();v.qc("name",v.lc(1,3,"Total")),v.pc("cellClass",t.getCellClass)("flexGrow",1)}}function tt(t,o){if(1&t&&(v.Oc(0),v.kc(1,"currency")),2&t){const t=o.row;v.Qc(" ",v.lc(1,1,null==t?null:t.rprecioneto)," ")}}function ot(t,o){if(1&t&&(v.Xb(0,"ngx-datatable-column",38),v.kc(1,"translate"),v.Mc(2,tt,2,3,"ng-template",39),v.Wb()),2&t){const t=v.jc();v.qc("name",v.lc(1,3,"Precio Neto")),v.pc("cellClass",t.getCellClass)("flexGrow",1)}}function at(t,o){if(1&t&&(v.Oc(0),v.kc(1,"currency")),2&t){const t=o.row;v.Qc(" ",v.lc(1,1,null==t?null:t.rtotalneto)," ")}}function et(t,o){if(1&t&&(v.Xb(0,"ngx-datatable-column",38),v.kc(1,"translate"),v.Mc(2,at,2,3,"ng-template",39),v.Wb()),2&t){const t=v.jc();v.qc("name",v.lc(1,3,"Total Neto")),v.pc("cellClass",t.getCellClass)("flexGrow",1)}}function rt(t,o){if(1&t){const t=v.Yb();v.Xb(0,"button",60),v.fc("click",function(){v.Dc(t);const a=o.row;return v.jc().editarItem(a)}),v.Xb(1,"mat-icon"),v.Oc(2,"edit"),v.Wb(),v.Wb(),v.Xb(3,"button",61),v.fc("click",function(){v.Dc(t);const a=o.row;return v.jc().eliminarItem(a)}),v.Xb(4,"mat-icon"),v.Oc(5,"delete"),v.Wb(),v.Wb()}}function it(t,o){1&t&&(v.Xb(0,"h4",44),v.Oc(1," Impuestos"),v.Wb())}function st(t,o){if(1&t){const t=v.Yb();v.Xb(0,"mat-form-field",44),v.Xb(1,"mat-label"),v.Oc(2),v.Wb(),v.Xb(3,"input",64),v.fc("ngModelChange",function(t){return o.$implicit.total=t})("change",function(){return v.Dc(t),v.jc(2).calcular_total(!1)})("keyup",function(){return v.Dc(t),v.jc(2).calcular_total(!1)}),v.Wb(),v.Wb()}if(2&t){const t=o.$implicit;v.Eb(2),v.Pc(t.simpuesto),v.Eb(1),v.pc("ngModel",t.total)}}function ct(t,o){if(1&t&&(v.Xb(0,"div",62),v.Mc(1,st,4,2,"mat-form-field",63),v.Wb()),2&t){const t=v.jc();v.Eb(1),v.pc("ngForOf",t.lista_impuestos)}}function nt(t,o){if(1&t){const t=v.Yb();v.Xb(0,"mat-form-field",44),v.Xb(1,"mat-label"),v.Oc(2,"Impuestos"),v.Wb(),v.Xb(3,"input",65),v.fc("change",function(){return v.Dc(t),v.jc().verificar_iva()})("keyup",function(){return v.Dc(t),v.jc().verificar_iva()}),v.Wb(),v.Wb()}if(2&t){const t=v.jc();v.Eb(3),v.pc("formControl",t.iva)}}function lt(t,o){1&t&&(v.Xb(0,"div",66),v.Xb(1,"b"),v.Oc(2,"Atenci\xf3n"),v.Wb(),v.Oc(3,": esta configurado para que esta compra NO afecte el stock.\n"),v.Wb())}const ut=function(){return{y:"50px",delay:"300ms"}},mt=function(t){return{value:"*",params:t}},pt=function(){return["/purchases/purchases-by-document/"]},dt=[{path:"",component:(()=>{class t{constructor(t,o,a,e,i,s,c,n,u){this.servicioUUID=t,this.loader=o,this.snack=a,this.router=e,this.servicioNuevaCompra=i,this.servicioProductos=s,this.servicioEmpresas=c,this.servicioSucursales=n,this.confirmService=u,this.guardando=!1,this.editorProveedor=new r.e(""),this.editorProducto=new r.e(""),this.sucursal="",this.startDate=new r.e,this.endDate=new r.e,this.tiposFactura=["PRODUCTOS","SERVICIOS"],this.form_precio=new r.e(""),this.form_cantidad=new r.e(""),this.form_servicio=new r.e(""),this.form_tipoFactura="",this.form_tipoDocumento="",this.form_precio_final=new r.e(""),this.fecha=new r.e,this.fechacontable=new r.e,this.fechacaicae=new r.e,this.form_numero=new r.e(""),this.form_caicae=new r.e(""),this.form_afectarStock=new r.e(""),this.form_descuento=new r.e(""),this.subtotal=new r.e(""),this.iva=new r.e(""),this.total=new r.e(""),this.form_numero_sucursal=new r.e(""),this.form_acredito=new r.e(""),this.error_iva=!1,this.tipoFacturaBloqueado=!1,this.formModal=function(){this.confirmService.confirm({message:"\xbfDesea guardar la compra?"}).subscribe(t=>{if(t){var o,a=1;this.form_sucursal||(this.form_sucursal=this.sucursales_data[0]),o=this.form_sucursal.idsucursal,this.loader.open(),this.servicioNuevaCompra.obtenerDepositoXSucursal(o).subscribe(t=>{a=t[0].DepositoXSucursal,this.loader.close(),null==a?this.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3}):(this.guardando=!0,this.generarCompra(o,a))},t=>{this.loader.close(),this.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3})})}})},this.sucursal="",this.tiposDocumento=[],this.detalle=[],this.detalleimpuestos=[],this.fechaFiltroInicio=new Date,this.fechaFiltroFin=l().add(1,"days").toDate()}_filterProveedores(t){if("string"==typeof t){const o=t.toLowerCase();return this.proveedores.filter(t=>t.srazonsocial.toLowerCase().includes(o))}return[]}displayFnProveedores(t){return t&&t.srazonsocial?t.srazonsocial:""}_filterProductos(t){if("string"==typeof t){const o=t.toLowerCase();return this.productos.filter(t=>t.snombre.toLowerCase().includes(o))}return[]}displayFnProductos(t){return t&&t.snombre?t.snombre:""}getRowHeight(t){return 50}getCellClass({row:t,column:o}){return{ngxgroup:t.isGroup,"ngx-alert-success ngx-alert-padding":"status"==o.prop&&t.idTipoDoc&&("F"==t.idTipoDoc[0]||"P"==t.idTipoDoc[0])&&"F"==t.bAnulado,"ngx-alert-danger ngx-alert-padding":"status"==o.prop&&t.idTipoDoc&&"N"==t.idTipoDoc[0]&&"F"==t.bAnulado,"ngx-alert-warning ngx-alert-padding":"status"==o.prop&&t.bAnulado&&"T"==t.bAnulado}}tabla1OnActivate(t){"click"==t.type&&t.row.isGroup&&this.tabla1.setGroup(t.row)}ngOnInit(){this.tabla1=new h.a,this.tabla1.groupField="",this.tabla1.secondarySort="",this.tabla1.sum=[],this.tabla1.summaryRow=!1,this.tabla1.emptyRow=!1;var t=new Date;t.setHours(0,0,0,0);var o=new Date;o.setHours(23,59,59,999),this.startDate.setValue(t),this.endDate.setValue(o),this.loader.open(),this.servicioProductos.traerProductos("snombre ASC",()=>{this.productos=this.servicioProductos.listaProductos,Object(u.a)([this.servicioEmpresas.obtenerEmpresas(),this.servicioProductos.obtenerProveedores(),this.servicioNuevaCompra.obtenerImpuestos(),this.servicioNuevaCompra.obtenerSucursales()]).subscribe(t=>{this.empresas=t[0],this.cantidaddecimales=this.empresas[0].icantidaddecimales,this.proveedores=t[1],this.impuestos=t[2],this.sucursales_data=t[3],this.filteredProveedores=this.editorProveedor.valueChanges.pipe(Object(m.a)(""),Object(p.a)(t=>this._filterProveedores(t))),this.filteredProductos=this.editorProducto.valueChanges.pipe(Object(m.a)(""),Object(p.a)(t=>this._filterProductos(t))),this.nuevaCompra(),this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}renameKeys(t,o){const a=Object.keys(t).map(a=>({[o[a]||a]:t[a]}));return Object.assign({},...a)}obtenerNombreProveedor(t){if(this.proveedores)for(var o=0;o<this.proveedores.length;o++)if(this.proveedores[o].id==t)return this.proveedores[o].srazonsocial;return""}obtenerNombreProducto(t,o){for(var a=0;a<this.productos.length;a++)if(this.productos[a].id==t)return this.productos[a].snombre;return o}obtenerCodigoProducto(t){for(var o=0;o<this.productos.length;o++)if(this.productos[o].id==t)return this.productos[o].scodproducto;return""}cambiarTiposFactura(){this.form_servicio.setValue("")}cambiarProveedor(t){var o="T"==t.bdeproductos,a="T"==t.bdeservicios;this.tipoFacturaBloqueado=!1,this.form_tipoFactura=this.tiposFactura[0],o&&!a&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[0]),a&&!o&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[1]),this.cargarTiposDocumento(t.scondicioniva,o)}cargarTiposDocumento(t,o){this.tiposDocumento=["Presupuesto de Compra","Nota de Cr\xe9dito Presupuesto de Compra"],this.form_tipoDocumento="Presupuesto de Compra",o&&this.tiposDocumento.push("Remito de Compra"),"Monotributista"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Responsable Inscripto"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra A"),this.tiposDocumento.push("Nota de Cr\xe9dito A"),this.form_tipoDocumento="Factura de Compra A"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Consumidor Final"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C"))}buscarProducto(t){for(var o=0;o<this.productos.length;o++)if(this.productos[o].id==t)return this.productos[o];return{}}editarItem(t){this.temp_item=t,this.form_tipoFactura==this.tiposFactura[0]?(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_producto=this.buscarProducto(t.idproducto)):(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_servicio.setValue(t.sconcepto))}eliminarItem(t){var o=this.tabla1.data.indexOf(t);this.tabla1.data.splice(o,1),this.calcular_total(!0),this.tabla1.sortData(),0==this.tabla1.data.length&&this.editorProveedor.enable()}guardarItem(){try{this.form_cantidad.setValue(this.form_cantidad.value?this.form_cantidad.value:1);var t=this.tabla1.data.indexOf(this.temp_item),o=this.form_precio.value,a=this.form_precio_final.value;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento&&(o=parseFloat((a/1.21).toFixed(this.cantidaddecimales))),-1!=t?(this.form_tipoFactura==this.tiposFactura[0]?(this.tabla1.data[t].idproducto=this.form_producto.id,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=o,this.tabla1.data[t].rporciva=this.form_producto.rporciva,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=o*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-o),this.tabla1.data[t].sconcepto=this.form_producto.snombre):(this.tabla1.data[t].idproducto=null,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=o,this.tabla1.data[t].rporciva=21,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=o*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-o),this.tabla1.data[t].sconcepto=this.form_servicio.value),this.tabla1.data[t].impuesto_iva=this.tabla1.data[t].rporciva/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_dgr=this.tabla1.data[t].rporcdgr/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_interno=this.tabla1.data[t].rvalorimpinterno*this.tabla1.data[t].rcantidad):(this.tabla1.data.push(this.form_tipoFactura==this.tiposFactura[0]?{id:this.servicioUUID.generateUUID(),idproducto:this.form_producto.id,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:o,rporciva:this.form_producto.rporciva,rtotal:this.form_cantidad.value*a,rtotalneto:o*this.form_cantidad.value,rimpuestos:Math.abs(a-o),sconcepto:this.form_producto.snombre}:{id:this.servicioUUID.generateUUID(),idproducto:null,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:o,rporciva:21,rtotal:this.form_cantidad.value*a,rtotalneto:o*this.form_cantidad.value,rimpuestos:Math.abs(a-o),sconcepto:this.form_servicio.value}),this.tabla1.data[this.tabla1.data.length-1].impuesto_iva=this.tabla1.data[this.tabla1.data.length-1].rporciva/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_dgr=this.tabla1.data[this.tabla1.data.length-1].rporcdgr/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_interno=this.tabla1.data[this.tabla1.data.length-1].rvalorimpinterno*this.tabla1.data[this.tabla1.data.length-1].rcantidad),this.form_precio.setValue(0),this.form_precio_final.setValue(0),this.form_cantidad.setValue(1),this.form_servicio.setValue(""),this.temp_item=null,this.calcular_total(!0),this.tabla1.sortData(),this.editorProveedor.disable()}catch(e){console.error(e)}}tipoComprobanteDeCompra(t){return"Presupuesto de Compra"==t?"PDC":"Remito de Compra"==t?"RMC":"Factura de Compra A"==t?"CCA":"Factura de Compra B"==t?"CCB":"Factura de Compra C"==t?"CCC":"Nota de Cr\xe9dito A"==t?"CNA":"Nota de Cr\xe9dito B"==t?"CNB":"Nota de Cr\xe9dito C"==t?"CNC":"Nota de Cr\xe9dito Presupuesto de Compra"==t?"PSC":void 0}querySearch(t){if(""==t)return this.proveedores;var o=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.proveedores.length;a++){for(var e=this.proveedores[a].srazonsocial.toLowerCase(),r=!0,i=0;i<t.length;i++)if(-1==e.indexOf(t[i])){r=!1;break}r&&o.push(this.proveedores[a])}return o}querySearchProducto(t){if(""==t)return this.productos;var o=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.productos.length;a++)for(var e=this.productos[a],r=0;r<t.length;r++){var i=t[r];if(-1==e.snombre.toLowerCase().indexOf(i)&&e.scodproducto.toLowerCase()!=i&&e.sean!=i&&e.sean2!=i)break;o.push(this.productos[a])}return o}selectedItemChangeProducto(t){this.form_producto=t,t&&null!=t.rcostou&&this.form_precio.setValue(t.rcostou),this.calcular_precio_neto(),this.calcular_precio_final()}calcular_precio_neto(){var t=this.form_producto;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||(this.form_precio.setValue(parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales))),this.form_precio.setValue(t&&t.rcostou&&t.rporciva&&t.rporcdgr&&null!=t.rvalorimpinterno?parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales)):0))}calcular_precio_final(){var t=this.form_producto;this.form_precio_final.setValue(!t||"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento?this.form_precio.value:parseFloat((this.form_precio.value*(t.rporciva/100+t.rporcdgr/100+1)+t.rvalorimpinterno).toFixed(this.cantidaddecimales)))}nuevaCompra(){var t=new Date;t.setHours(0,0,0,0),this.fecha.setValue(t);var o=new Date;o.setHours(0,0,0,0),this.fechacontable.setValue(o);var a=new Date;a.setHours(0,0,0,0),this.fechacaicae.setValue(l(a).add(10,"days").toDate()),this.tabla1.data=[],this.form_precio.setValue(0),this.form_cantidad.setValue(1),this.form_producto="",this.form_servicio.setValue(""),this.form_tipoFactura=this.tiposFactura[0],this.form_tipoDocumento=this.tiposDocumento[0],this.form_numero.setValue(""),this.form_caicae.setValue(""),this.form_afectarStock.setValue(!1),this.form_descuento.setValue(0),this.form_sucursal=this.sucursales_data[0],this.editorProveedor.setValue(this.proveedores[0]),this.cambiarProveedor(this.proveedores[0]),this.subtotal.setValue(0),this.iva.setValue(0),this.total.setValue(0),this.lista_impuestos=[],this.lista_impuestos=[];for(var e=0;e<this.impuestos.length;e++)this.lista_impuestos.push({id:this.impuestos[e].id,simpuesto:this.impuestos[e].simpuesto,total:0,idempresa:this.impuestos[e].idempresa,rporc:this.impuestos[e].rporc})}cancelarCompra(){}fechaAfip(){var t=this.fechacaicae.value,o=t.getUTCMonth()+1,a=t.getUTCDate(),e=t.getUTCFullYear();return e=o<10?e+"0"+o:e+""+o,a<10?e+"0"+a:e+""+a}EsNotaDeCredito(t){return"CNA"==t||"CNB"==t||"CNC"==t||"CND"==t||"PSC"==t}generarCompra(t,o){var a={id:this.servicioUUID.generateUUID(),idproveedor:this.editorProveedor.value.id,idtipodoc:this.tipoComprobanteDeCompra(this.form_tipoDocumento),idpv:this.form_numero_sucursal.value?this.form_numero_sucursal.value:1,idnumdoc:this.form_numero.value?this.form_numero.value:0,idsucursal:t,fdocumento:this.fecha.value.toISOString(),fcarga:(new Date).toISOString(),fvencimiento:this.fecha.value.toISOString(),fcontable:this.fechacontable.value.toISOString(),rtotneto:this.subtotal.value,rtotdescuento:this.form_descuento.value,rtotimpuestos:"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?this.iva.value:0,rtotbruto:this.total.value,rtotsaldo:this.form_acredito.value?this.total:0,scondpago:"EFE",banulado:"F",cae:this.form_caicae.value,caefchvto:this.fechaAfip(),bafectarstock:this.form_afectarStock.value?"T":"F",scondventa:this.form_acredito.value?"CRE":"CDO",cncdisponible:0,iaplicstock:this.EsNotaDeCredito(this.tipoComprobanteDeCompra(this.form_tipoDocumento))?-1:1,soperadoranulacion:"",idnctipodoc:"",idncpv:null,idnunumdoc:null,fanulacion:null,facancelacion:null};this.loader.open(),this.servicioNuevaCompra.guardarCompra(a).subscribe(a=>{var e=[],r=a;this.tabla1.data.slice(0).forEach((a,i)=>{a.idcompra=r.id,a.idnumlinea=i+1,a.idsucursal=t,a.rimpuestos=a.rimpuestos?a.rimpuestos:0,a.rimpuestos=a.rimpuestos*a.rcantidad,this.form_afectarStock.value&&(a.iddeposito=o),delete a.rtotalneto,delete a.impuesto_iva,delete a.impuesto_dgr,delete a.impuesto_interno,e.push(this.servicioNuevaCompra.guardarCompraItem(a))}),"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||this.lista_impuestos.forEach(o=>{if(o.total){var a={id:this.servicioUUID.generateUUID(),idcompra:r.id,idimpuesto:o.id,rmonto:o.total,idempresa:o.idempresa,idsucursal:t};e.push(this.servicioNuevaCompra.guardarImpuestos(a))}}),Object(u.a)(e).subscribe(t=>{this.loader.close(),this.snack.open("\xa1Compra Guardada!","OK",{duration:4e3}),this.router.navigateByUrl("purchases/purchases-by-document")},t=>{console.error(t),this.loader.close(),this.snack.open("ERROR al guardar los items o el iva","OK",{duration:4e3})})},t=>{console.error(t),this.loader.close(),this.snack.open("ERROR al guardar la compra","OK",{duration:4e3})})}verificar_iva(){this.error_iva=this.total_impuestos!=this.iva.value}calcular_total_impuestos(){for(var t=0,o=0;o<this.lista_impuestos.length;o++)t+=this.lista_impuestos[o].total;this.total_impuestos=parseFloat(t.toFixed(this.cantidaddecimales)),this.iva.setValue(this.total_impuestos)}calcular_total(t){for(var o=0,a=0,e=0;e<this.tabla1.data.length;e++)o+=this.tabla1.data[e].rtotal,a+=this.tabla1.data[e].rtotalneto;if(t){for(var r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=0;for(e=0;e<this.tabla1.data.length;e++)for(r=0;r<this.lista_impuestos.length;r++){if(this.tabla1.data[e].rporciva==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_iva;break}if(this.tabla1.data[e].rporcdgr==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_dgr;break}if(this.tabla1.data[e].rvalorimpinterno==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_interno;break}}for(r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=parseFloat(this.lista_impuestos[r].total.toFixed(this.cantidaddecimales))}"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?(this.calcular_total_impuestos(),this.subtotal.setValue(parseFloat(a.toFixed(this.cantidaddecimales)))):(this.subtotal.setValue(parseFloat(o.toFixed(this.cantidaddecimales))),this.iva.setValue(0)),this.total.setValue(parseFloat((this.subtotal.value-this.form_descuento.value+this.iva.value).toFixed(this.cantidaddecimales)))}}return t.\u0275fac=function(o){return new(o||t)(v.Rb(n.a),v.Rb(c.a),v.Rb(F.a),v.Rb(D.g),v.Rb(C),v.Rb(f.a),v.Rb(d.a),v.Rb(b.a),v.Rb(s.a))},t.\u0275cmp=v.Lb({type:t,selectors:[["app-new-purchase"]],decls:134,vars:133,consts:[["fxLayout","row wrap"],["appearance","fill","fxFlex","100",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Proveedor","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["appearance","fill","fxFlex","30",1,"m-8","graphic-select-form-field"],[3,"ngModel","ngModelChange"],["fxFlex","25","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_numero_sucursal","matInput","","type","number","max","9999","min","0",3,"formControl"],["name","form_numero","matInput","","type","number","max","99999999","min","0",3,"formControl"],["fxFlex","10",1,"m-8",2,"padding-top","15px"],["name","form_acredito",3,"formControl"],["fxFlex","10","appearance","fill",1,"m-8","graphic-select-form-field"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","color","enableMeridian","disableMinute","hideTime"],["picker",""],["picker2",""],["fxFlex","15","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_caicae","matInput","","type","number","min","0",3,"formControl"],["picker3",""],["appearance","fill","fxFlex","15",1,"m-8","graphic-select-form-field"],[3,"ngModel","disabled","ngModelChange","selectionChange"],["fxFlex","10",1,"m-8",2,"padding-top","15px",3,"hidden"],["name","form_afectarStock",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","15",4,"ngIf"],["name","form_cantidad","matInput","","type","number","min","0",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","50",4,"ngIf"],["class","m-8 graphic-select-form-field","fxFlex","50","appearance","fill",4,"ngIf"],[4,"ngIf"],["name","form_precio","matInput","","type","number","min","0",3,"formControl","change","keyup"],["class","m-8 graphic-select-form-field","fxFlex","10","appearance","fill",4,"ngIf"],["mat-button","","color","primary",1,"m-8",3,"click"],[1,"p-0"],["summaryRow","false",1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","selectionType","activate"],["myTable",""],[3,"cellClass","name","flexGrow"],["ngx-datatable-cell-template",""],[3,"cellClass","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","minWidth"],["class","m-8",4,"ngIf"],["layout-gt-xs","row",4,"ngIf"],[1,"m-8"],["matInput","","type","number","min","0","name","subtotal","aria-label","Subtotal",3,"formControl"],["matInput","","type","number","min","0","name","form_descuento","aria-label","Descuentos",3,"formControl","change","keyup"],["matInput","","type","number","min","0","name","total","aria-label","Total",3,"formControl"],["class","red-400 red-400-fg p-16",4,"ngIf"],["fxFlex","100",1,"mt-16"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"disabled","routerLink"],[3,"value"],["appearance","fill","fxFlex","50",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Producto","matInput","",3,"formControl","matAutocomplete"],["auto2","matAutocomplete"],["fxFlex","50","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_servicio","matInput","","type","text","min","0",3,"formControl"],["readonly","","name","form_precio_final","matInput","","type","number","min","0",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",1,"mr-16",3,"click"],["layout-gt-xs","row"],["class","m-8",4,"ngFor","ngForOf"],["matInput","","type","number","min","0","aria-label","Impuesto",3,"ngModel","ngModelChange","change","keyup"],["matInput","","type","number","min","0","name","iva","aria-label","Impuestos",3,"formControl","change","keyup"],[1,"red-400","red-400-fg","p-16"]],template:function(t,o){if(1&t&&(v.Xb(0,"div"),v.Xb(1,"div",0),v.Xb(2,"mat-form-field",1),v.Xb(3,"mat-label"),v.Oc(4),v.kc(5,"translate"),v.Wb(),v.Sb(6,"input",2),v.Xb(7,"mat-autocomplete",3,4),v.fc("optionSelected",function(t){return o.cambiarProveedor(t.option.value)}),v.Mc(9,N,2,2,"mat-option",5),v.kc(10,"async"),v.Wb(),v.Wb(),v.Wb(),v.Xb(11,"div",6),v.Xb(12,"mat-form-field",7),v.Xb(13,"mat-label"),v.Oc(14),v.kc(15,"translate"),v.Wb(),v.Xb(16,"mat-select",8),v.fc("ngModelChange",function(t){return o.form_tipoDocumento=t}),v.Mc(17,j,2,2,"mat-option",5),v.Wb(),v.Wb(),v.Xb(18,"mat-form-field",9),v.Xb(19,"mat-label"),v.Oc(20,"N\xfamero (primeros 4 d\xedgitos)"),v.Wb(),v.Sb(21,"input",10),v.Wb(),v.Xb(22,"mat-form-field",9),v.Xb(23,"mat-label"),v.Oc(24,"N\xfamero (\xfaltimos 8 d\xedgitos)"),v.Wb(),v.Sb(25,"input",11),v.Wb(),v.Xb(26,"div",12),v.Xb(27,"mat-checkbox",13),v.Oc(28,"A Cr\xe9dito"),v.Wb(),v.Wb(),v.Wb(),v.Xb(29,"div",6),v.Xb(30,"mat-form-field",14),v.Xb(31,"mat-label"),v.Oc(32),v.kc(33,"translate"),v.Wb(),v.Sb(34,"input",15),v.Sb(35,"mat-datepicker-toggle",16),v.Sb(36,"ngx-mat-datetime-picker",17,18),v.Wb(),v.Xb(38,"mat-form-field",14),v.Xb(39,"mat-label"),v.Oc(40),v.kc(41,"translate"),v.Wb(),v.Sb(42,"input",15),v.Sb(43,"mat-datepicker-toggle",16),v.Sb(44,"ngx-mat-datetime-picker",17,19),v.Wb(),v.Xb(46,"mat-form-field",20),v.Xb(47,"mat-label"),v.Oc(48,"CAI/CAE"),v.Wb(),v.Sb(49,"input",21),v.Wb(),v.Xb(50,"mat-form-field",14),v.Xb(51,"mat-label"),v.Oc(52),v.kc(53,"translate"),v.Wb(),v.Sb(54,"input",15),v.Sb(55,"mat-datepicker-toggle",16),v.Sb(56,"ngx-mat-datetime-picker",17,22),v.Wb(),v.Xb(58,"mat-form-field",23),v.Xb(59,"mat-label"),v.Oc(60),v.kc(61,"translate"),v.Wb(),v.Xb(62,"mat-select",24),v.fc("ngModelChange",function(t){return o.form_tipoFactura=t})("selectionChange",function(){return o.cambiarTiposFactura()}),v.Mc(63,V,2,2,"mat-option",5),v.Wb(),v.Wb(),v.Xb(64,"div",25),v.Xb(65,"mat-checkbox",26),v.Oc(66,"Afectar Stock"),v.Wb(),v.Wb(),v.Mc(67,T,6,5,"mat-form-field",27),v.Wb(),v.Wb(),v.Xb(68,"div",6),v.Xb(69,"mat-form-field",14),v.Xb(70,"mat-label"),v.Oc(71,"Cantidad"),v.Wb(),v.Sb(72,"input",28),v.Wb(),v.Mc(73,H,9,9,"mat-form-field",29),v.Mc(74,G,4,1,"mat-form-field",30),v.Xb(75,"mat-form-field",14),v.Mc(76,q,2,0,"mat-label",31),v.Mc(77,B,2,0,"mat-label",31),v.Xb(78,"input",32),v.fc("change",function(){return o.calcular_precio_final()})("keyup",function(){return o.calcular_precio_final()}),v.Wb(),v.Wb(),v.Mc(79,$,4,1,"mat-form-field",33),v.Xb(80,"button",34),v.fc("click",function(){return o.guardarItem()}),v.Xb(81,"mat-icon"),v.Oc(82,"save"),v.Wb(),v.Oc(83),v.kc(84,"translate"),v.Wb(),v.Wb(),v.Xb(85,"mat-card",35),v.Xb(86,"mat-card-content",35),v.Xb(87,"ngx-datatable",36,37),v.fc("activate",function(t){return o.tabla1OnActivate(t)}),v.Xb(89,"ngx-datatable-column",38),v.kc(90,"translate"),v.Mc(91,Q,2,3,"ng-template",39),v.Wb(),v.Xb(92,"ngx-datatable-column",38),v.kc(93,"translate"),v.Mc(94,z,1,1,"ng-template",39),v.Wb(),v.Mc(95,K,3,5,"ngx-datatable-column",40),v.Mc(96,Z,3,5,"ngx-datatable-column",40),v.Mc(97,ot,3,5,"ngx-datatable-column",40),v.Mc(98,et,3,5,"ngx-datatable-column",40),v.Xb(99,"ngx-datatable-column",41),v.kc(100,"translate"),v.Mc(101,rt,6,0,"ng-template",39),v.Wb(),v.Wb(),v.Wb(),v.Wb(),v.Mc(102,it,2,0,"h4",42),v.Mc(103,ct,2,1,"div",43),v.Xb(104,"h4",44),v.Oc(105,"Resumen"),v.Wb(),v.Xb(106,"div",6),v.Xb(107,"mat-form-field",44),v.Xb(108,"mat-label"),v.Oc(109,"Subtotal"),v.Wb(),v.Sb(110,"input",45),v.Wb(),v.Xb(111,"mat-form-field",44),v.Xb(112,"mat-label"),v.Oc(113,"Descuentos"),v.Wb(),v.Xb(114,"input",46),v.fc("change",function(){return o.calcular_total(!0)})("keyup",function(){return o.calcular_total(!0)}),v.Wb(),v.Wb(),v.Mc(115,nt,4,1,"mat-form-field",42),v.Xb(116,"mat-form-field",44),v.Xb(117,"mat-label"),v.Oc(118,"Total"),v.Wb(),v.Sb(119,"input",47),v.Wb(),v.Wb(),v.Mc(120,lt,4,0,"div",48),v.Xb(121,"div",6),v.Xb(122,"div",49),v.Xb(123,"button",50),v.fc("click",function(){return o.formModal()}),v.Xb(124,"mat-icon"),v.Oc(125,"save"),v.Wb(),v.Oc(126),v.kc(127,"translate"),v.Wb(),v.Sb(128,"span",51),v.Xb(129,"button",52),v.Xb(130,"mat-icon"),v.Oc(131,"cancel"),v.Wb(),v.Oc(132),v.kc(133,"translate"),v.Wb(),v.Wb(),v.Wb()),2&t){const t=v.Ac(8),a=v.Ac(37),e=v.Ac(45),r=v.Ac(57);v.Eb(4),v.Pc(v.lc(5,103,"Proveedor")),v.Eb(2),v.pc("formControl",o.editorProveedor)("matAutocomplete",t),v.Eb(1),v.pc("displayWith",o.displayFnProveedores),v.Eb(2),v.pc("ngForOf",v.lc(10,105,o.filteredProveedores)),v.Eb(5),v.Pc(v.lc(15,107,"Documento")),v.Eb(2),v.pc("ngModel",o.form_tipoDocumento),v.Eb(1),v.pc("ngForOf",o.tiposDocumento),v.Eb(4),v.pc("formControl",o.form_numero_sucursal),v.Eb(4),v.pc("formControl",o.form_numero),v.Eb(2),v.pc("formControl",o.form_acredito),v.Eb(5),v.Pc(v.lc(33,109,"Fecha")),v.Eb(2),v.pc("ngxMatDatetimePicker",a)("formControl",o.fecha),v.Eb(1),v.pc("for",a),v.Eb(1),v.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),v.Eb(4),v.Pc(v.lc(41,111,"Fecha Contable")),v.Eb(2),v.pc("ngxMatDatetimePicker",e)("formControl",o.fechacontable),v.Eb(1),v.pc("for",e),v.Eb(1),v.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),v.Eb(5),v.pc("formControl",o.form_caicae),v.Eb(3),v.Pc(v.lc(53,113,"Fecha CAI / CAE")),v.Eb(2),v.pc("ngxMatDatetimePicker",r)("formControl",o.fechacaicae),v.Eb(1),v.pc("for",r),v.Eb(1),v.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),v.Eb(4),v.Pc(v.lc(61,115,"Tipo de Factura")),v.Eb(2),v.pc("ngModel",o.form_tipoFactura)("disabled",o.tabla1.data.length>0||o.tipoFacturaBloqueado),v.Eb(1),v.pc("ngForOf",o.tiposFactura),v.Eb(1),v.pc("hidden",o.form_tipoFactura!=o.tiposFactura[0]),v.Eb(1),v.pc("formControl",o.form_afectarStock),v.Eb(2),v.pc("ngIf",o.form_tipoFactura==o.tiposFactura[0]&&o.form_afectarStock.value),v.Eb(5),v.pc("formControl",o.form_cantidad),v.Eb(1),v.pc("ngIf",o.form_tipoFactura==o.tiposFactura[0]),v.Eb(1),v.pc("ngIf",o.form_tipoFactura==o.tiposFactura[1]),v.Eb(2),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),v.Eb(1),v.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),v.Eb(1),v.pc("formControl",o.form_precio),v.Eb(1),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),v.Eb(4),v.Qc("",v.lc(84,117,"Guardar")," "),v.Eb(2),v.pc("@animate",v.vc(130,mt,v.uc(129,ut))),v.Eb(2),v.pc("columnMode","flex")("headerHeight",50)("footerHeight",50)("rowHeight",o.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",o.tabla1.rows)("selectionType","single"),v.Eb(2),v.qc("name",v.lc(90,119,"Cantidad")),v.pc("cellClass",o.getCellClass)("flexGrow",1),v.Eb(3),v.qc("name",v.lc(93,121,"Concepto")),v.pc("cellClass",o.getCellClass)("flexGrow",2),v.Eb(3),v.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),v.Eb(1),v.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),v.Eb(1),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),v.Eb(1),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),v.Eb(1),v.qc("name",v.lc(100,123,"SALES.ACTIONS")),v.pc("flexGrow",1)("minWidth",100),v.Eb(3),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),v.Eb(1),v.pc("ngIf",("Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento)&&0!=o.lista_impuestos.length),v.Eb(7),v.pc("formControl",o.subtotal),v.Eb(4),v.pc("formControl",o.form_descuento),v.Eb(1),v.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),v.Eb(4),v.pc("formControl",o.total),v.Eb(1),v.pc("ngIf",!o.form_afectarStock.value),v.Eb(3),v.pc("disabled",o.guardando),v.Eb(3),v.Qc("",v.lc(127,125,"Guardar")," "),v.Eb(3),v.pc("disabled",o.guardando)("routerLink",v.uc(132,pt)),v.Eb(3),v.Qc("",v.lc(133,127,"Cancelar")," ")}},directives:[w.c,O.c,w.a,O.f,x.b,r.c,E.c,r.o,r.f,E.a,e.n,W.a,r.r,r.s,y.a,S.a,X.h,O.h,S.b,e.o,k.b,I.a,M.a,M.b,P.d,P.b,P.a,D.h,A.n],pipes:[R.c,e.b,e.g,e.d],styles:[""],data:{animation:[i.a]}}),t})(),data:{title:"NUEVA COMPRA"}}];var ht=a("u9T3"),ft=a("f44v"),bt=a("iELJ"),gt=a("jMqV"),vt=a("M9ds"),_t=a("ZFy/"),Ct=a("PCNd"),Ft=a("BxcV"),Dt=a("OaSA");let wt=(()=>{class t{}return t.\u0275mod=v.Pb({type:t}),t.\u0275inj=v.Ob({factory:function(o){return new(o||t)},imports:[[e.c,r.t,ht.a,P.f,x.c,x.c,M.c,x.c,k.c,ft.a,x.c,_t.b,bt.f,F.b,gt.b,vt.c,W.b,I.b,R.b,Ct.a,E.b,Ft.a,r.j,X.g,S.c,S.e,S.d,y.b,Dt.a,D.k.forChild(dt)]]}),t})()},CHRX:function(t,o,a){"use strict";a.d(o,"a",function(){return r});var e=a("wd/R");class r{constructor(){this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.summaryRow=!0,this.emptyRow=!0,this.customFilter=function(t){return t}}static prepararFiltroAPI(t){var o="";for(var a in t)t[a].search&&(o+="number"==typeof t[a].search?`{"${a}":${t[a].search}},`:t[a].exact?`{"${a}":"${t[a].search}"},`:`{"${a}":{"ilike":"%${t[a].search}%"}},`);return o}setGroup(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}setData(t){this.data=t,this.sortData()}sortData(){this.data.sort((t,o)=>{if(t[this.groupField]==o[this.groupField]){if(this.secondarySort){if(null==t[this.secondarySort])return 1;if(null==o[this.secondarySort])return-1;if(t[this.secondarySort]>o[this.secondarySort])return 1*("desc"===this.sortDir?-1:1);if(t[this.secondarySort]<o[this.secondarySort])return-1*("desc"===this.sortDir?-1:1)}}else{if(null==t[this.groupField])return 1;if(null==o[this.groupField])return-1;if(t[this.groupField]>o[this.groupField])return 1;if(t[this.groupField]<o[this.groupField])return-1}return 0}),this.filterRows()}filterRows(){var t=[];t=this.data.filter(t=>{for(var o in this.filter){if(this.filter[o]&&null==t[o])return!1;switch(typeof t[o]){case"number":if(this.filter[o]&&Math.trunc(t[o]).toString()!==Math.trunc(this.filter[o]).toString())return!1;break;case"string":if("f"==o.charAt(0).toLowerCase()&&e(t[o]).isValid){if(-1==e(t[o]).format("DD/MM/YYYY HH:mm:ss").indexOf(this.filter[o]))return!1;break}if(-1==t[o].toLowerCase().indexOf(this.filter[o].toLowerCase()))return!1}}return!0}),t=this.customFilter(t);var o={};this.groupField?o[this.groupField]=t.length.toString():o.count=t.length.toString(),this.sum.forEach(t=>o[t]=0);for(var a=0;a<t.length;a++)this.sum.forEach(e=>o[e]+=t[a][e]);if(o.isGroup=!0,this.footer=o,this.groupField){var r=[];t.forEach(t=>{-1==r.indexOf(t[this.groupField])&&r.push(t[this.groupField])}),r=r.map(t=>({name:t,count:1}));var i=[],s=!0,c=0,n=null,l=()=>{n&&(n[this.groupField]+=" ("+r[c-1].count.toString()+")")};for(a=0;a<t.length;a++){if(s&&t[a][this.groupField]==r[c].name){l();var u="+";this.groups[r[c].name]&&(u="-"),n={[this.groupField]:u+" "+r[c].name,isGroup:!0,name:r[c].name},this.sum.forEach(t=>n[t]=0),i.push(n),s=++c<r.length}else r[c-1].count++;this.sum.forEach(o=>n[o]+=t[a][o]),i.push(t[a])}l(),t=null,i=i.filter(t=>!!t.isGroup||!!this.groups[t[this.groupField]]||void 0),this.rows=i}else this.rows=t;this.summaryRow&&this.rows.push(this.footer),0==this.rows.length&&this.emptyRow&&this.rows.push({})}updateFilter(t,o){if(t&&o){var a=t.target.value;t instanceof MouseEvent&&(a=""),this.filter[o]=a,this.filterRows()}return!0}updateFilterBoolean(t,o){return this.filter[o]=t,this.filterRows(),!0}}},GmJt:function(t,o,a){"use strict";a.d(o,"a",function(){return i});var e=a("GS7A");const r=Object(e.g)([Object(e.l)({opacity:"{{opacity}}",transform:"scale({{scale}}) translate3d({{x}}, {{y}}, {{z}})"}),Object(e.e)("{{duration}} {{delay}} cubic-bezier(0.0, 0.0, 0.2, 1)",Object(e.l)("*"))],{params:{duration:"200ms",delay:"0ms",opacity:"0",scale:"1",x:"0",y:"0",z:"0"}}),i=[Object(e.n)("animate",[Object(e.m)("void => *",[Object(e.o)(r)])]),Object(e.n)("fadeInOut",[Object(e.k)("0",Object(e.l)({opacity:0,display:"none"})),Object(e.k)("1",Object(e.l)({opacity:1,display:"block"})),Object(e.m)("0 => 1",Object(e.e)("300ms")),Object(e.m)("1 => 0",Object(e.e)("300ms"))])]}}]);