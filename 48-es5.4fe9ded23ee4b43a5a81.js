!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var c=0;c<e.length;c++){var a=e[c];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function c(t,c,a){return c&&e(t.prototype,c),a&&e(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{"0edY":function(e,a,o){"use strict";o.r(a),o.d(a,"StockModule",function(){return gt});var n,i=o("SVse"),r=o("iInd"),l=o("u9T3"),u=o("s7LF"),b=o("Dxy4"),s=o("PDjf"),f=o("f44v"),p=o("iELJ"),m=o("Tj54"),d=o("e6WT"),g=o("ZTz/"),v=o("jMqV"),h=o("zHaW"),k=o("M9ds"),S=o("ZFy/"),y=o("TSSN"),w=o("w9WL"),W=o("PCNd"),E=o("TN/R"),X=o("GmJt"),A=o("3sEA"),x=o("GyhO"),M=o("IAdc"),O=o("bPAe"),P=o("CHRX"),F=o("7M/S"),j=o("rGvg"),D=o("AytR"),C=o("8Y7J"),I=o("IheW"),R=((n=function(){function e(c){t(this,e),this.http=c}return c(e,[{key:"obtenerDepositos",value:function(){return this.http.get(encodeURI(D.a.apiURL+'Depositos?filter={"where":{"deletedon":{"eq":null}}}'))}},{key:"obtenerStock",value:function(t){return this.http.get(encodeURI("".concat(D.a.apiURL,"Productos/GetStock?idDeposito=").concat(t)))}},{key:"obtenerHistorialProducto",value:function(t,e){return this.http.get(encodeURI("".concat(D.a.apiURL,"Productos/GetHistorialStock?idProducto=").concat(e,"&idDeposito=").concat(t)))}}]),e}()).\u0275fac=function(t){return new(t||n)(C.bc(I.c))},n.\u0275prov=C.Nb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),T=o("VDRc"),N=o("Q2Ze"),H=o("UhP/");function L(t,e){if(1&t&&(C.Xb(0,"mat-option",24),C.Oc(1),C.Wb()),2&t){var c=e.$implicit;C.pc("value",c),C.Eb(1),C.Pc(null==c?null:c.sdescripcion)}}function Y(t,e){if(1&t&&(C.Xb(0,"div",1),C.Xb(1,"mat-slide-toggle",25),C.Oc(2),C.kc(3,"translate"),C.Wb(),C.Xb(4,"mat-slide-toggle",25),C.Oc(5),C.kc(6,"translate"),C.Wb(),C.Wb()),2&t){var c=C.jc();C.Eb(1),C.pc("formControl",c.toggle),C.Eb(1),C.Pc(C.lc(3,4,"Solo Activos")),C.Eb(2),C.pc("formControl",c.toggleStock),C.Eb(1),C.Pc(C.lc(6,6,"Solo Stock debajo del m\xednimo"))}}function V(t,e){if(1&t&&C.Oc(0),2&t){var c=e.row;C.Qc(" ",null==c?null:c.sCodProducto," ")}}function q(t,e){if(1&t&&C.Oc(0),2&t){var c=e.row;C.Qc(" ",null==c?null:c.sProducto," ")}}function U(t,e){if(1&t&&C.Oc(0),2&t){var c=e.row;C.Qc(" ",(null==c?null:c.sEAN)||(null==c?null:c.sEAN2)," ")}}function G(t,e){if(1&t&&C.Oc(0),2&t){var c=e.row;C.Qc(" ",null==c?null:c.sFamilia," ")}}function Q(t,e){if(1&t&&(C.Oc(0),C.kc(1,"number")),2&t){var c=e.row;C.Qc(" ",C.lc(1,1,null==c?null:c.rStock)," ")}}function J(t,e){if(1&t&&(C.Oc(0),C.kc(1,"number")),2&t){var c=e.row;C.Qc(" ",C.lc(1,1,null==c?null:c.rStockMinimo)," ")}}function K(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",27),C.fc("click",function(){C.Dc(c);var t=C.jc().row;return C.jc().openPopUp(t)}),C.Xb(1,"mat-icon"),C.Oc(2,"info"),C.Wb(),C.Wb()}}function B(t,e){if(1&t&&C.Mc(0,K,3,0,"button",26),2&t){var c=e.row,a=C.jc();C.pc("ngIf",!c.isGroup&&a.puedeVerHistorial)}}function Z(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",5),C.fc("click",function(){return C.Dc(c),C.jc(3).export()}),C.Xb(1,"mat-icon"),C.Oc(2,"save_alt"),C.Wb(),C.Oc(3),C.kc(4,"translate"),C.Wb()}2&t&&(C.Eb(3),C.Pc(C.lc(4,1,"SALES.EXCEL")))}function z(t,e){if(1&t&&(C.Xb(0,"div",29),C.Mc(1,Z,5,3,"button",30),C.Wb()),2&t){var c=C.jc(2);C.Eb(1),C.pc("ngIf",c.tabla1.data.length>0)}}function $(t,e){1&t&&(C.Xb(0,"ngx-datatable-footer"),C.Mc(1,z,2,1,"ng-template",28),C.Wb())}function _(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"sCodProducto")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function tt(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",32,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"sCodProducto")}),C.Wb(),C.Mc(3,_,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}function et(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"sProducto")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function ct(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",32,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"sProducto")}),C.Wb(),C.Mc(3,et,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}function at(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"sEAN")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function ot(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",32,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"sEAN")}),C.Wb(),C.Mc(3,at,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}function nt(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"sFamilia")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function it(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",32,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"sFamilia")}),C.Wb(),C.Mc(3,nt,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}function rt(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"rStock")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function lt(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",36,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"rStock")}),C.Wb(),C.Mc(3,rt,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}function ut(t,e){if(1&t){var c=C.Yb();C.Xb(0,"button",35),C.fc("click",function(t){C.Dc(c),C.jc();var e=C.Ac(2);return C.jc().tabla1.updateFilter(t,"rStockMinimo")&&(e.value="")}),C.Xb(1,"mat-icon"),C.Oc(2,"close"),C.Wb(),C.Wb()}}function bt(t,e){if(1&t){var c=C.Yb();C.Xb(0,"mat-form-field",31),C.Xb(1,"input",36,33),C.fc("keyup",function(t){return C.Dc(c),C.jc().tabla1.updateFilter(t,"rStockMinimo")}),C.Wb(),C.Mc(3,ut,3,0,"button",34),C.Wb()}if(2&t){var a=C.Ac(2);C.Eb(3),C.pc("ngIf",a.value)}}var st,ft,pt=function(){return{y:"50px",delay:"300ms"}},mt=function(t){return{value:"*",params:t}},dt=[{path:"",component:(st=function(){function e(c,a,o,n,i,r){var l=this;t(this,e),this.dialog=c,this.servicioStock=a,this.servicioExportarExcel=o,this.loader=n,this.snack=i,this.servicioPermisos=r,this.toggle=new u.e(!0,[]),this.toggleValue=!0,this.toggleStock=new u.e(!1,[]),this.toggleStockValue=!1,this.puedeVerHistorial=!1,this.toggle.valueChanges.subscribe(function(t){l.toggleValue=t,l.tabla1.updateFilterBoolean(l.toggleValue?"T":"","bActivo")}),this.toggleStock.valueChanges.subscribe(function(t){l.toggleStockValue=t,l.tabla1.filterRows()})}return c(e,[{key:"ngOnInit",value:function(){var t=this;this.tabla1=new P.a,this.tabla1.groupField="",this.tabla1.secondarySort="sProducto",this.tabla1.sum=[],this.tabla1.updateFilterBoolean("T","bActivo"),this.tabla1.customFilter=function(e){return t.toggleStockValue?e.filter(function(t){return t.rStock<t.rStockMinimo}):e},this.loader.open(),Object(x.a)(this.servicioPermisos.puedeVer("actHistorialProducto")).pipe(Object(M.a)()).subscribe(function(e){t.puedeVerHistorial=e[0]}),this.servicioStock.obtenerDepositos().subscribe(function(e){t.depositos=e,t.depositos.sort(function(t,e){return t.sdescripcion>e.sdescripcion?1:t.sdescripcion<e.sdescripcion?-1:0}),t.depositoActual=t.depositos[0],t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"refresh",value:function(){var t=this;this.loader.open(),this.servicioStock.obtenerStock(this.depositoActual.id).subscribe(function(e){e.forEach(function(t){t.sEAN||(t.sEAN=""),t.sEAN2||(t.sEAN2=""),t.rStock=parseFloat(t.rStock),t.rStockMinimo=parseFloat(t.rStockMinimo)}),t.tabla1.setData(e.filter(function(){return!0})),t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"seleccionarDeposito",value:function(t){this.depositoActual=t}},{key:"getRowHeight",value:function(t){return 50}},{key:"export",value:function(){var t=this.tabla1.data.map(function(t){return{"Dep\xf3sito":t.sDeposito,"C\xf3digo":t.sCodProducto,Nombre:t.sProducto,Familia:t.sFamilia,Stock:t.rStock}});this.servicioExportarExcel.exportExcel(t,"stock","stock")}},{key:"onSort",value:function(t){var e=t.sorts[0];this.tabla1.secondarySort=e.prop,this.tabla1.sortDir=e.dir,this.tabla1.sortData()}},{key:"openPopUp",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loader.open(),this.servicioStock.obtenerHistorialProducto(this.depositoActual.id,e.idProducto).subscribe(function(c){t.loader.close(),t.dialog.open(j.a,{width:"720px",disableClose:!0,data:{title:"HISTORIAL DE STOCK",payload:e,historialstock:c}}).afterClosed().subscribe(function(t){})})}}]),e}(),st.\u0275fac=function(t){return new(t||st)(C.Rb(p.b),C.Rb(R),C.Rb(O.a),C.Rb(A.a),C.Rb(h.a),C.Rb(F.a))},st.\u0275cmp=C.Lb({type:st,selectors:[["app-stock"]],decls:52,vars:59,consts:[[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","end center",1,"p-8"],["appearance","fill","fxFlex","100","fxFlex.gt-xs","25","fxFlex.gt-sm","16",1,"m-8"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"m-8",3,"click"],["class","p-8","fxLayout","row wrap","fxLayoutAlign","end center",4,"ngIf"],[1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],["prop","sCodProducto",3,"summaryTemplate","name","width"],["ngx-datatable-cell-template",""],["prop","sProducto",3,"summaryTemplate","name","width"],["prop","sEAN",3,"summaryTemplate","name","width"],["prop","sFamilia",3,"summaryTemplate","name","width"],["prop","rStock",3,"summaryTemplate","name","width"],["prop","rStockMinimo",3,"summaryTemplate","name","width"],[3,"name","flexGrow","sortable"],[4,"ngIf"],["tabla1sCodProducto",""],["tabla1sProducto",""],["tabla1sEAN",""],["tabla1sFamilia",""],["tabla1rStock",""],["tabla1rStockMinimo",""],[3,"value"],[1,"m-8",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground","class","mr-16",3,"click",4,"ngIf"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["ngx-datatable-footer-template",""],[1,"p-8",2,"margin-left","auto"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],[1,"margin-333",2,"width","100%"],["matInput","","placeholder","","value","",3,"keyup"],["searchinput",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","number","matInput","","placeholder","","value","",3,"keyup"]],template:function(t,e){if(1&t&&(C.Xb(0,"mat-card",0),C.Xb(1,"div",1),C.Xb(2,"mat-form-field",2),C.Xb(3,"mat-label"),C.Oc(4),C.kc(5,"translate"),C.Wb(),C.Xb(6,"mat-select",3),C.fc("selectionChange",function(t){return e.seleccionarDeposito(t.value)})("valueChange",function(t){return e.depositoActual=t}),C.Mc(7,L,2,2,"mat-option",4),C.Wb(),C.Wb(),C.Xb(8,"button",5),C.fc("click",function(){return e.refresh()}),C.Xb(9,"mat-icon"),C.Oc(10,"search"),C.Wb(),C.Oc(11),C.kc(12,"translate"),C.Wb(),C.Wb(),C.Mc(13,Y,7,8,"div",6),C.Wb(),C.Xb(14,"mat-card",0),C.Xb(15,"mat-card-content",0),C.Xb(16,"ngx-datatable",7,8),C.fc("sort",function(t){return e.onSort(t)}),C.Xb(18,"ngx-datatable-column",9),C.kc(19,"translate"),C.Mc(20,V,1,1,"ng-template",10),C.Wb(),C.Xb(21,"ngx-datatable-column",11),C.kc(22,"translate"),C.Mc(23,q,1,1,"ng-template",10),C.Wb(),C.Xb(24,"ngx-datatable-column",12),C.kc(25,"translate"),C.Mc(26,U,1,1,"ng-template",10),C.Wb(),C.Xb(27,"ngx-datatable-column",13),C.kc(28,"translate"),C.Mc(29,G,1,1,"ng-template",10),C.Wb(),C.Xb(30,"ngx-datatable-column",14),C.kc(31,"translate"),C.Mc(32,Q,2,3,"ng-template",10),C.Wb(),C.Xb(33,"ngx-datatable-column",15),C.kc(34,"translate"),C.Mc(35,J,2,3,"ng-template",10),C.Wb(),C.Xb(36,"ngx-datatable-column",16),C.kc(37,"translate"),C.Mc(38,B,1,1,"ng-template",10),C.Wb(),C.Mc(39,$,2,0,"ngx-datatable-footer",17),C.Wb(),C.Wb(),C.Wb(),C.Mc(40,tt,4,1,"ng-template",null,18,C.Nc),C.Mc(42,ct,4,1,"ng-template",null,19,C.Nc),C.Mc(44,ot,4,1,"ng-template",null,20,C.Nc),C.Mc(46,it,4,1,"ng-template",null,21,C.Nc),C.Mc(48,lt,4,1,"ng-template",null,22,C.Nc),C.Mc(50,bt,4,1,"ng-template",null,23,C.Nc)),2&t){var c=C.Ac(41),a=C.Ac(43),o=C.Ac(45),n=C.Ac(47),i=C.Ac(49),r=C.Ac(51);C.Eb(4),C.Pc(C.lc(5,38,"Dep\xf3sitos")),C.Eb(2),C.pc("value",e.depositoActual),C.Eb(1),C.pc("ngForOf",e.depositos),C.Eb(4),C.Pc(C.lc(12,40,"SALES.SHOW")),C.Eb(2),C.pc("ngIf",e.tabla1.data.length>0),C.Eb(1),C.pc("@animate",C.vc(57,mt,C.uc(56,pt))),C.Eb(2),C.pc("columnMode","standard")("headerHeight",50)("footerHeight",100)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!0)("rows",e.tabla1.rows)("summaryRow",!0)("externalSorting",!0)("selectionType","single"),C.Eb(2),C.qc("name",C.lc(19,42,"C\xf3digo")),C.pc("summaryTemplate",c)("width",200),C.Eb(3),C.qc("name",C.lc(22,44,"Nombre")),C.pc("summaryTemplate",a)("width",500),C.Eb(3),C.qc("name",C.lc(25,46,"C\xf3digo de Barras")),C.pc("summaryTemplate",o)("width",150),C.Eb(3),C.qc("name",C.lc(28,48,"Familia")),C.pc("summaryTemplate",n)("width",225),C.Eb(3),C.qc("name",C.lc(31,50,"Stock")),C.pc("summaryTemplate",i)("width",150),C.Eb(3),C.qc("name",C.lc(34,52,"Stock M\xednimo")),C.pc("summaryTemplate",r)("width",150),C.Eb(3),C.qc("name",C.lc(37,54,"SALES.ACTIONS")),C.pc("flexGrow",1)("sortable",!1),C.Eb(3),C.pc("ngIf",e.tabla1.data.length>0)}},directives:[s.a,T.c,T.b,N.c,T.a,N.f,g.a,i.n,b.b,m.a,i.o,s.b,w.d,w.b,w.a,H.n,v.a,u.n,u.f,w.e,w.c,d.b,N.h],pipes:[y.c,i.g],styles:[""],data:{animation:[X.a]}}),st),data:{title:"STOCK"}}],gt=((ft=function e(){t(this,e)}).\u0275mod=C.Pb({type:ft}),ft.\u0275inj=C.Ob({factory:function(t){return new(t||ft)},imports:[[i.c,u.s,l.a,w.f,d.c,d.c,s.c,d.c,b.c,f.a,d.c,S.b,p.f,h.b,v.b,k.c,g.b,m.b,y.b,W.a,E.c,r.k.forChild(dt)]]}),ft)}}])}();