!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{CHRX:function(t,e,o){"use strict";o.d(e,"a",function(){return c});var a=o("wd/R"),c=function(){function t(){n(this,t),this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.customFilter=function(t){return t}}return r(t,[{key:"setGroup",value:function(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}},{key:"setData",value:function(t){this.data=t,this.sortData()}},{key:"sortData",value:function(){var t=this;this.data.sort(function(e,i){if(e[t.groupField]==i[t.groupField]){if(t.secondarySort){if(e[t.secondarySort]>i[t.secondarySort])return 1*("desc"===t.sortDir?-1:1);if(e[t.secondarySort]<i[t.secondarySort])return-1*("desc"===t.sortDir?-1:1)}}else{if(e[t.groupField]>i[t.groupField])return 1;if(e[t.groupField]<i[t.groupField])return-1}return 0}),this.filterRows()}},{key:"filterRows",value:function(){var t=this,e=[];e=this.data.filter(function(e){for(var i in t.filter)switch(typeof e[i]){case"number":if(t.filter[i]&&e[i].toString()!==t.filter[i].toString())return!1;break;case"string":if("f"==i.charAt(0).toLowerCase()&&a(e[i]).isValid){if(-1==a(e[i]).format("DD/MM/YYYY HH:mm:ss").indexOf(t.filter[i]))return!1;break}if(-1==e[i].toLowerCase().indexOf(t.filter[i].toLowerCase()))return!1}return!0}),e=this.customFilter(e);var n={};this.groupField?n[this.groupField]=e.length.toString():n.count=e.length.toString(),this.sum.forEach(function(t){return n[t]=0});for(var o=0;o<e.length;o++)this.sum.forEach(function(t){return n[t]+=e[o][t]});if(n.isGroup=!0,this.footer=n,this.groupField){var r=[];e.forEach(function(e){-1==r.indexOf(e[t.groupField])&&r.push(e[t.groupField])}),r=r.map(function(t){return{name:t,count:1}});var c=[],s=!0,l=0,u=null,d=function(){u&&(u[t.groupField]+=" ("+r[l-1].count.toString()+")")};for(o=0;o<e.length;o++){if(s&&e[o][this.groupField]==r[l].name){var f;d();var p="+";this.groups[r[l].name]&&(p="-"),i(f={},this.groupField,p+" "+r[l].name),i(f,"isGroup",!0),i(f,"name",r[l].name),u=f,this.sum.forEach(function(t){return u[t]=0}),c.push(u),s=++l<r.length}else r[l-1].count++;this.sum.forEach(function(t){return u[t]+=e[o][t]}),c.push(e[o])}d(),e=null,c=c.filter(function(e){return!!e.isGroup||!!t.groups[e[t.groupField]]||void 0}),this.rows=c}else this.rows=e;this.rows.push(this.footer),0==this.rows.length&&this.rows.push({})}},{key:"updateFilter",value:function(t,e){t&&e&&(this.filter[e]=t.target.value,this.filterRows())}},{key:"updateFilterBoolean",value:function(t,e){this.filter[e]=t,this.filterRows()}}]),t}()},yElb:function(e,i,o){"use strict";o.r(i),o.d(i,"ClientsUploadModule",function(){return st});var a,c=o("SVse"),s=o("s7LF"),l=o("GmJt"),u=o("3sEA"),d=o("vpPe"),f=o("GyhO"),p=o("VRyK"),b=o("Cfvw"),h=o("CHRX"),g=o("EUZL"),m=o("AytR"),v=o("8Y7J"),y=o("IheW"),C=((a=function(){function t(e){n(this,t),this.http=e,this.listaClientes=[]}return r(t,[{key:"obtenerDatos",value:function(t,e,i){return this.http.get(encodeURI("".concat(m.a.apiURL,'Clientes?filter={"where":').concat(t,',"limit":').concat(e,',"skip":').concat(i,',"order":"srazonsocial ASC"}')))}},{key:"traerClientes",value:function(){return this.http.get(encodeURI(m.a.apiURL+"Clientes"))}},{key:"actualizarCliente",value:function(t){return this.http.put("".concat(m.a.apiURL,"Clientes/").concat(t.id),t)}},{key:"obtenerTiposClientes",value:function(){return this.http.get(encodeURI(m.a.apiURL+'Tiposcliente?filter={"where":{"deletedon":{"eq":null}}}'))}},{key:"obtenerEmpresas",value:function(){return this.http.get(m.a.apiURL+"Empresas")}},{key:"agregarCliente",value:function(t){return this.http.post(m.a.apiURL+"Clientes",t)}},{key:"traerClientesPagina",value:function(t,e,i,n){var o=this;this.http.get(encodeURI("".concat(m.a.apiURL,'Clientes?filter={"limit":').concat(t,',"skip":').concat(e,',"order":"').concat(i,'"}'))).subscribe(function(r){r.length>0?(o.listaClientes=o.listaClientes.concat(r),o.traerClientesPagina(t,e+t,i,n)):n()})}},{key:"traerProductos",value:function(t,e){this.listaClientes.length=0,this.traerClientesPagina(2e4,0,t,e)}}]),t}()).\u0275fac=function(t){return new(t||a)(v.bc(y.c))},a.\u0275prov=v.Nb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),O=o("5+tZ"),w=o("vkgz"),E=o("IAdc"),S=o("zHaW"),k=o("PDjf"),T=o("w9WL"),I=o("Dxy4"),M=o("Tj54"),R=o("jMqV"),N=o("TSSN");function F(t,e){if(1&t){var i=v.Yb();v.Xb(0,"div"),v.Oc(1),v.Xb(2,"button",9),v.fc("click",function(){return v.Dc(i),v.jc(),v.Ac(3).click()}),v.Xb(3,"mat-icon"),v.Oc(4,"attach_file"),v.Wb(),v.Oc(5,"Cargar archivo "),v.Wb(),v.Wb()}if(2&t){var n=v.jc();v.Eb(1),v.Qc(" ",n.fileName||"Ning\xfan archivo cargado todav\xeda."," ")}}function j(t,e){if(1&t){var i=v.Yb();v.Xb(0,"button",9),v.fc("click",function(){return v.Dc(i),v.jc(2).upload()}),v.Xb(1,"mat-icon"),v.Oc(2,"cloud_upload"),v.Wb(),v.Oc(3,"Subir "),v.Wb()}}function D(t,e){if(1&t&&(v.Xb(0,"div"),v.Oc(1),v.Xb(2,"mat-slide-toggle",10),v.Oc(3),v.kc(4,"translate"),v.Wb(),v.Mc(5,j,4,0,"button",11),v.Wb()),2&t){var i=v.jc();v.Eb(1),v.Qc(" ",i.fileName||"Ning\xfan archivo cargado todav\xeda."," "),v.Eb(1),v.pc("formControl",i.toggle),v.Eb(1),v.Pc(v.lc(4,4,"Mostrar clientes")),v.Eb(2),v.pc("ngIf",0==i.total)}}function W(t,e){if(1&t&&(v.Xb(0,"div"),v.Xb(1,"p"),v.Xb(2,"strong"),v.Oc(3,"Hay c\xf3digos duplicados:"),v.Wb(),v.Oc(4," por favor vuelva a editar el archivo de Excel y aseg\xfarese que los clientes tengan un c\xf3digo distinto cada uno que no se repita. Tambi\xe9n puede tener clientes con c\xf3digos duplicados ya cargados, en ese caso aseg\xfarese de editar los clientes con el editor."),v.Wb(),v.Xb(5,"p"),v.Oc(6),v.Wb(),v.Wb()),2&t){var i=v.jc();v.Eb(6),v.Pc(i.duplicados.join(", "))}}function X(t,e){if(1&t&&(v.Xb(0,"div"),v.Xb(1,"div",12),v.Xb(2,"p"),v.Oc(3),v.Wb(),v.Xb(4,"p"),v.Xb(5,"b",13),v.Oc(6),v.Wb(),v.Wb(),v.Wb(),v.Wb()),2&t){var i=v.jc();v.Eb(3),v.Rc("Subida: ",i.count," / ",i.total,""),v.Eb(3),v.Qc("",i.percent," %")}}function L(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.scodcliente," ")}}function P(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.srazonsocial," ")}}function A(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.sdomicilio," ")}}function U(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.scuit," ")}}function x(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.scondicioniva," ")}}function V(t,e){1&t&&(v.Xb(0,"span"),v.Oc(1,"Si"),v.Wb())}function H(t,e){1&t&&(v.Xb(0,"span"),v.Oc(1,"No"),v.Wb())}function z(t,e){if(1&t&&(v.Mc(0,V,2,0,"span",2),v.Mc(1,H,2,0,"span",2)),2&t){var i=e.row;v.pc("ngIf","T"==(null==i?null:i.bcredito)),v.Eb(1),v.pc("ngIf","F"==(null==i?null:i.bcredito))}}function q(t,e){if(1&t&&v.Oc(0),2&t){var i=e.row;v.Qc(" ",null==i?null:i.rlimitecredito," ")}}function Q(t,e){1&t&&(v.Xb(0,"span"),v.Oc(1,"Si"),v.Wb())}function _(t,e){1&t&&(v.Xb(0,"span"),v.Oc(1,"No"),v.Wb())}function Y(t,e){if(1&t&&(v.Mc(0,Q,2,0,"span",2),v.Mc(1,_,2,0,"span",2)),2&t){var i=e.row;v.pc("ngIf","T"==(null==i?null:i.bactivo)),v.Eb(1),v.pc("ngIf","F"==(null==i?null:i.bactivo))}}var G,J,B=function(){return{y:"50px",delay:"300ms"}},Z=function(t){return{value:"*",params:t}},K=[{path:"",component:(G=function(){function e(t,i,o,r){var a=this;n(this,e),this.servicioClientes=t,this.loader=i,this.snack=o,this.servicioUUID=r,this.fileName="",this.toggle=new s.e(!1,[]),this.toggleValue=!1,this.count=0,this.percent=0,this.total=0,Object.is||(Object.is=function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}),this.toggle.valueChanges.subscribe(function(t){a.toggleValue=t}),this.empresas=[],this.duplicados=[],this.tipoCliente=[]}return r(e,[{key:"ngOnInit",value:function(){var t=this;this.tabla1=new h.a,this.tabla1.groupField="",this.tabla1.secondarySort="snombre",this.tabla1.sum=[],this.loader.open(),this.servicioClientes.obtenerEmpresas().subscribe(function(e){t.empresas=e,t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"getTipoCliente",value:function(t){var e=this.tipoCliente.find(function(e){return e.id==t});return e?e.stipocliente:""}},{key:"convertirComoSi",value:function(t){return"T"==t?"Si":"No"}},{key:"esElMismoCliente",value:function(t,e){return!("string"==typeof e["*Codigo"]&&!Object.is(e["*Codigo"],t.scodcliente)||"string"==typeof e["*Raz\xf3n Social"]&&!Object.is(e["*Raz\xf3n Social"],t.srazonsocial)||"string"==typeof e["*Domicilio"]&&!Object.is(e["*Domicilio"],t.sdomicilio)||"string"==typeof e.Localidad&&!Object.is(e.Localidad,t.slocalidad?t.slocalidad:"")||"string"==typeof e["*Condicion IVA"]&&!Object.is(e["*Condicion IVA"],t.scondicioniva)||"string"==typeof e.CUIT&&!Object.is(e.CUIT,t.scuit?t.scuit:"")||"string"==typeof e["*Documento"]&&!Object.is(e["*Documento"],t.sdocumento)||"number"==typeof e["Limite de Credito"]&&!Object.is(e["Limite de Credito"],t.rlimitecredito)||"number"==typeof e["Tope de Descuento"]&&!Object.is(e["Tope de Descuento"],t.rtopedescuento)||"string"==typeof e["Venta a Credito"]&&!Object.is("S"==e["Venta a Credito"]?"T":"F",t.bcredito)||"string"==typeof e.Activo&&!Object.is("S"==e.Activo?"T":"F",t.bactivo)||"string"==typeof e.Favorito&&!Object.is("S"==e.Favorito?"T":"F","F"!=t.bfavorito?"T":"F"))}},{key:"asignarValores",value:function(t,e){t.scodcliente=e["*Codigo"],e["*Raz\xf3n Social"]&&(t.srazonsocial=e["*Raz\xf3n Social"].toString()),e["*Domicilio"]&&(t.sdomicilio=e["*Domicilio"].toString()),e.Localidad&&(t.slocalidad=e.Localidad.toString()),e["*Condicion IVA"]&&(t.scondicioniva=e["*Condicion IVA"].toString()),e.CUIT&&(t.scuit=e.CUIT.toString()),e["*Documento"]&&(t.sdocumento=e["*Documento"].toString()),"number"==typeof e["Limite de Credito"]&&(t.rlimitecredito=e["Limite de Credito"]),t.hasOwnProperty("bactivo")||(t.bactivo="T"),"string"==typeof e.Activo&&("S"===e.Activo?t.bactivo="T":"N"===e.Activo&&(t.bactivo="F")),t.hasOwnProperty("bfavorito")||(t.bfavorito="F"),t.hasOwnProperty("rtopedescuento")||(t.rtopedescuento=100),"number"==typeof e["Tope de Descuento"]&&(t.rtopedescuento=e["Tope de Descuento"]),"string"==typeof e["Venta a Credito"]&&(t.bcredito="S"==e["Venta a Credito"]?"T":"F")}},{key:"onFileSelected",value:function(t){var e=this,i=t.target.files[0];if(i){this.fileName=i.name;var n=new FileReader;n.onload=function(t){var i=g.read(n.result,{type:"binary"}),o=g.utils.sheet_to_json(i.Sheets.Clientes);e.loader.open(),e.servicioClientes.traerClientes().subscribe(function(t){e.rows=[];try{o.forEach(function(i){if(null!=i["*Codigo"]&&null!=i["*Codigo"]&&""!=i["*Codigo"]){var n=t.find(function(t){return t.scodcliente==i["*Codigo"]});if(n){if(!e.esElMismoCliente(n,i)){var o={};Object.assign(o,n),e.asignarValores(o,i),e.rows.push(o)}}else e.asignarValores(o={},i),e.rows.push(o)}})}catch(a){console.error(a)}for(var i=[],n=0;n<o.length;n++)if(o[n]["*Codigo"]){var r=o.filter(function(t){if(t["*Codigo"])return o[n]["*Codigo"]==t["*Codigo"]});r.length>1&&i.push(o[n]["*Codigo"]+" ("+r.length+" veces)")}e.duplicados=i,e.duplicados=Array.from(new Set(i)),e.tabla1.setData(e.rows),e.loader.close()})},this.loader.close(),n.readAsBinaryString(i)}}},{key:"uploadFile",value:function(t){return t.id?this.servicioClientes.actualizarCliente(t):(t.id=this.servicioUUID.generateUUID(),this.servicioClientes.agregarCliente(t))}},{key:"upload",value:function(){var e=this;(new Date).getTime().toString(),this.count=0,this.percent=0,this.total=this.rows.length;var i=this.rows.map(function(t){return e.uploadFile(t)}),n=(Object(f.a).apply(void 0,t(i)),Object(p.a).apply(void 0,t(i)),Object(b.a)(i).pipe(Object(O.a)(function(t){return t},6)));this.sub=n.pipe(Object(w.a)(function(t){return e.updateProgressMeter(t)}),Object(E.a)()).subscribe(function(t){},function(t){e.loader.close(),e.snack.open("ERROR","OK",{duration:4e3})})}},{key:"updateProgressMeter",value:function(t){this.count++,this.percent=this.total>0?Math.round(this.count/this.total*100):0}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}},{key:"getRowHeight",value:function(t){return 50}},{key:"onSort",value:function(t){var e=t.sorts[0];this.tabla1.secondarySort=e.prop,this.tabla1.sortDir=e.dir,this.tabla1.sortData()}}]),e}(),G.\u0275fac=function(t){return new(t||G)(v.Rb(C),v.Rb(u.a),v.Rb(S.a),v.Rb(d.a))},G.\u0275cmp=v.Lb({type:G,selectors:[["app-clients-upload"]],decls:37,vars:55,consts:[["type","file","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",1,"file-input",3,"change"],["fileUpload",""],[4,"ngIf"],[3,"hidden"],[1,"p-0"],[1,"material","expandable","bg-white",2,"height","50vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],[3,"name","width"],["ngx-datatable-cell-template",""],["mat-raised-button","","color","primary",1,"m-8",3,"click"],[1,"m-8",3,"formControl"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],[2,"text-align","center"],[2,"font-size","150%"]],template:function(t,e){1&t&&(v.Xb(0,"mat-card"),v.Xb(1,"mat-card-content"),v.Xb(2,"input",0,1),v.fc("change",function(t){return e.onFileSelected(t)}),v.Wb(),v.Mc(4,F,6,1,"div",2),v.Mc(5,D,6,6,"div",2),v.Mc(6,W,7,1,"div",2),v.Mc(7,X,7,3,"div",2),v.Wb(),v.Wb(),v.Xb(8,"div",3),v.Xb(9,"mat-card",4),v.Xb(10,"mat-card-content",4),v.Xb(11,"ngx-datatable",5,6),v.fc("sort",function(t){return e.onSort(t)}),v.Xb(13,"ngx-datatable-column",7),v.kc(14,"translate"),v.Mc(15,L,1,1,"ng-template",8),v.Wb(),v.Xb(16,"ngx-datatable-column",7),v.kc(17,"translate"),v.Mc(18,P,1,1,"ng-template",8),v.Wb(),v.Xb(19,"ngx-datatable-column",7),v.kc(20,"translate"),v.Mc(21,A,1,1,"ng-template",8),v.Wb(),v.Xb(22,"ngx-datatable-column",7),v.kc(23,"translate"),v.Mc(24,U,1,1,"ng-template",8),v.Wb(),v.Xb(25,"ngx-datatable-column",7),v.kc(26,"translate"),v.Mc(27,x,1,1,"ng-template",8),v.Wb(),v.Xb(28,"ngx-datatable-column",7),v.kc(29,"translate"),v.Mc(30,z,2,2,"ng-template",8),v.Wb(),v.Xb(31,"ngx-datatable-column",7),v.kc(32,"translate"),v.Mc(33,q,1,1,"ng-template",8),v.Wb(),v.Xb(34,"ngx-datatable-column",7),v.kc(35,"translate"),v.Mc(36,Y,2,2,"ng-template",8),v.Wb(),v.Wb(),v.Wb(),v.Wb(),v.Wb()),2&t&&(v.pc("@animate",v.vc(50,Z,v.uc(49,B))),v.Eb(4),v.pc("ngIf",!e.fileName),v.Eb(1),v.pc("ngIf",e.fileName),v.Eb(1),v.pc("ngIf",e.duplicados.length>0),v.Eb(1),v.pc("ngIf",e.total>0),v.Eb(1),v.pc("hidden",!e.toggleValue),v.Eb(1),v.pc("@animate",v.vc(53,Z,v.uc(52,B))),v.Eb(2),v.pc("columnMode","standard")("headerHeight",50)("footerHeight",100)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!0)("rows",e.tabla1.rows)("summaryRow",!1)("externalSorting",!0)("selectionType","single"),v.Eb(2),v.qc("name",v.lc(14,33,"CLIENTSCOMPONENT.CODE")),v.pc("width",150),v.Eb(3),v.qc("name",v.lc(17,35,"CLIENTSCOMPONENT.BUSINESSNAME")),v.pc("width",325),v.Eb(3),v.qc("name",v.lc(20,37,"CLIENTSCOMPONENT.ADDRESS")),v.pc("width",325),v.Eb(3),v.qc("name",v.lc(23,39,"CLIENTSCOMPONENT.CUIT")),v.pc("width",150),v.Eb(3),v.qc("name",v.lc(26,41,"CLIENTSCOMPONENT.FISCALCONDITION")),v.pc("width",200),v.Eb(3),v.qc("name",v.lc(29,43,"CLIENTSCOMPONENT.CREDIT")),v.pc("width",150),v.Eb(3),v.qc("name",v.lc(32,45,"CLIENTSCOMPONENT.CREDITLIMIT")),v.pc("width",150),v.Eb(3),v.qc("name",v.lc(35,47,"CLIENTSCOMPONENT.ACTIVE")),v.pc("width",150))},directives:[k.a,k.b,c.o,T.d,T.b,T.a,I.b,M.a,R.a,s.n,s.f],pipes:[N.c],styles:[".file-input[_ngcontent-%COMP%]{display:none}.progress[_ngcontent-%COMP%]{display:block;width:16px;height:16px;border:1px solid #000;float:left;margin:0 4px 4px 0}.progress.uploading[_ngcontent-%COMP%]{background:gold}.progress.uploaded[_ngcontent-%COMP%], uploading[_ngcontent-%COMP%]{background:green}"],data:{animation:[l.a]}}),G),data:{title:"SUBIR CLIENTES"}}],$=o("iInd"),tt=o("u9T3"),et=o("f44v"),it=o("iELJ"),nt=o("e6WT"),ot=o("ZTz/"),rt=o("M9ds"),at=o("ZFy/"),ct=o("PCNd"),st=((J=function t(){n(this,t)}).\u0275mod=v.Pb({type:J}),J.\u0275inj=v.Ob({factory:function(t){return new(t||J)},imports:[[c.c,s.s,tt.a,T.f,nt.c,nt.c,k.c,nt.c,I.c,et.a,nt.c,at.b,it.e,S.b,R.b,rt.c,ot.b,M.b,N.b,ct.a,$.k.forChild(K)]]}),J)}}])}();