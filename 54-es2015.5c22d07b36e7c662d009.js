(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{"0edY":function(t,e,c){"use strict";c.r(e),c.d(e,"StockModule",function(){return St});var o=c("SVse"),a=c("iInd"),n=c("u9T3"),i=c("s7LF"),r=c("Dxy4"),l=c("PDjf"),s=c("f44v"),b=c("iELJ"),u=c("Tj54"),m=c("e6WT"),p=c("ZTz/"),f=c("jMqV"),d=c("zHaW"),g=c("M9ds"),h=c("ZFy/"),k=c("TSSN"),S=c("w9WL"),X=c("PCNd"),x=c("TN/R"),w=c("HeVh"),v=c("GmJt"),M=c("3sEA"),W=c("GyhO"),E=c("IAdc"),y=c("bPAe"),O=c("CHRX"),A=c("7M/S"),I=c("rGvg"),j=c("AytR"),P=c("8Y7J"),F=c("IheW");let L=(()=>{class t{constructor(t){this.http=t}obtenerDepositos(){return this.http.get(encodeURI(j.a.apiURL+'Depositos?filter={"where":{"deletedon":{"eq":null}}}'))}obtenerStock(t){return this.http.get(encodeURI(`${j.a.apiURL}Productos/GetStock?idDeposito=${t}`))}obtenerHistorialProducto(t,e){return this.http.get(encodeURI(`${j.a.apiURL}Productos/GetHistorialStock?idProducto=${e}&idDeposito=${t}`))}}return t.\u0275fac=function(e){return new(e||t)(P.bc(F.c))},t.\u0275prov=P.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=c("VDRc"),D=c("Q2Ze"),C=c("UhP/");function R(t,e){if(1&t&&(P.Xb(0,"mat-option",23),P.Oc(1),P.Wb()),2&t){const t=e.$implicit;P.pc("value",t),P.Eb(1),P.Pc(null==t?null:t.sdescripcion)}}function G(t,e){if(1&t&&(P.Xb(0,"div",1),P.Xb(1,"mat-slide-toggle",24),P.Oc(2),P.kc(3,"translate"),P.Wb(),P.Xb(4,"mat-slide-toggle",24),P.Oc(5),P.kc(6,"translate"),P.Wb(),P.Wb()),2&t){const t=P.jc();P.Eb(1),P.pc("formControl",t.toggle),P.Eb(1),P.Pc(P.lc(3,4,"Solo Activos")),P.Eb(2),P.pc("formControl",t.toggleStock),P.Eb(1),P.Pc(P.lc(6,6,"Solo Stock debajo del m\xednimo"))}}function N(t,e){if(1&t&&P.Oc(0),2&t){const t=e.row;P.Qc(" ",null==t?null:t.sCodProducto," ")}}function H(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",25),P.kc(1,"translate"),P.Mc(2,N,1,1,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(27);P.qc("name",P.lc(1,3,"C\xf3digo")),P.pc("summaryTemplate",t)("flexGrow",1)}}function V(t,e){if(1&t&&P.Oc(0),2&t){const t=e.row;P.Qc(" ",null==t?null:t.sProducto," ")}}function Y(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",27),P.kc(1,"translate"),P.Mc(2,V,1,1,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(29);P.qc("name",P.lc(1,3,"Nombre")),P.pc("summaryTemplate",t)("flexGrow",1)}}function q(t,e){if(1&t&&P.Oc(0),2&t){const t=e.row;P.Qc(" ",(null==t?null:t.sEAN)||(null==t?null:t.sEAN2)," ")}}function U(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",28),P.kc(1,"translate"),P.Mc(2,q,1,1,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(31);P.qc("name",P.lc(1,3,"C\xf3digo de Barras")),P.pc("summaryTemplate",t)("flexGrow",1)}}function Q(t,e){if(1&t&&P.Oc(0),2&t){const t=e.row;P.Qc(" ",null==t?null:t.sFamilia," ")}}function $(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",29),P.kc(1,"translate"),P.Mc(2,Q,1,1,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(33);P.qc("name",P.lc(1,3,"Familia")),P.pc("summaryTemplate",t)("flexGrow",1)}}function J(t,e){if(1&t&&(P.Oc(0),P.kc(1,"number")),2&t){const t=e.row;P.Qc(" ",P.lc(1,1,null==t?null:t.rStock)," ")}}function K(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",30),P.kc(1,"translate"),P.Mc(2,J,2,3,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(35);P.qc("name",P.lc(1,3,"Stock")),P.pc("summaryTemplate",t)("flexGrow",1)}}function B(t,e){if(1&t&&(P.Oc(0),P.kc(1,"number")),2&t){const t=e.row;P.Qc(" ",P.lc(1,1,null==t?null:t.rStockMinimo)," ")}}function Z(t,e){if(1&t&&(P.Xb(0,"ngx-datatable-column",31),P.kc(1,"translate"),P.Mc(2,B,2,3,"ng-template",26),P.Wb()),2&t){P.jc();const t=P.Ac(37);P.qc("name",P.lc(1,3,"Stock M\xednimo")),P.pc("summaryTemplate",t)("flexGrow",1)}}function z(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",34),P.fc("click",function(){P.Dc(t);const e=P.jc().row;return P.jc(2).openPopUp(e)}),P.Xb(1,"mat-icon"),P.Oc(2,"info"),P.Wb(),P.Wb()}}function _(t,e){if(1&t&&P.Mc(0,z,3,0,"button",33),2&t){const t=e.row,c=P.jc(2);P.pc("ngIf",!t.isGroup&&c.puedeVerHistorial)}}function tt(t,e){1&t&&(P.Xb(0,"ngx-datatable-column",32),P.kc(1,"translate"),P.Mc(2,_,1,1,"ng-template",26),P.Wb()),2&t&&(P.qc("name",P.lc(1,3,"SALES.ACTIONS")),P.pc("flexGrow",1)("sortable",!1))}function et(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",5),P.fc("click",function(){return P.Dc(t),P.jc(3).export()}),P.Xb(1,"mat-icon"),P.Oc(2,"save_alt"),P.Wb(),P.Oc(3),P.kc(4,"translate"),P.Wb()}2&t&&(P.Eb(3),P.Pc(P.lc(4,1,"SALES.EXCEL")))}function ct(t,e){if(1&t&&(P.Xb(0,"div",36),P.Mc(1,et,5,3,"button",37),P.Wb()),2&t){const t=P.jc(2);P.Eb(1),P.pc("ngIf",t.tabla1.data.length>0)}}function ot(t,e){1&t&&(P.Xb(0,"ngx-datatable-footer"),P.Mc(1,ct,2,1,"ng-template",35),P.Wb())}function at(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"sCodProducto")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function nt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",39,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"sCodProducto")}),P.Wb(),P.Mc(3,at,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}function it(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"sProducto")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function rt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",39,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"sProducto")}),P.Wb(),P.Mc(3,it,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}function lt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"sEAN")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function st(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",39,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"sEAN")}),P.Wb(),P.Mc(3,lt,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}function bt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"sFamilia")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function ut(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",39,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"sFamilia")}),P.Wb(),P.Mc(3,bt,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}function mt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"rStock")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function pt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",43,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"rStock")}),P.Wb(),P.Mc(3,mt,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}function ft(t,e){if(1&t){const t=P.Yb();P.Xb(0,"button",42),P.fc("click",function(e){P.Dc(t),P.jc();const c=P.Ac(2);return P.jc().tabla1.updateFilter(e,"rStockMinimo")&&(c.value="")}),P.Xb(1,"mat-icon"),P.Oc(2,"close"),P.Wb(),P.Wb()}}function dt(t,e){if(1&t){const t=P.Yb();P.Xb(0,"mat-form-field",38),P.Xb(1,"input",43,40),P.fc("keyup",function(e){return P.Dc(t),P.jc().tabla1.updateFilter(e,"rStockMinimo")}),P.Wb(),P.Mc(3,ft,3,0,"button",41),P.Wb()}if(2&t){const t=P.Ac(2);P.Eb(3),P.pc("ngIf",t.value)}}const gt=function(){return{y:"50px",delay:"300ms"}},ht=function(t){return{value:"*",params:t}},kt=[{path:"",component:(()=>{class t{constructor(t,e,c,o,a,n,r){this.dialog=t,this.servicioStock=e,this.servicioExportarExcel=c,this.loader=o,this.snack=a,this.servicioPermisos=n,this.breakpointObserver=r,this.toggle=new i.e(!0,[]),this.toggleValue=!0,this.toggleStock=new i.e(!1,[]),this.toggleStockValue=!1,this.puedeVerHistorial=!1,this.toggle.valueChanges.subscribe(t=>{this.toggleValue=t,this.tabla1.updateFilterBoolean(this.toggleValue?"T":"","bActivo")}),this.toggleStock.valueChanges.subscribe(t=>{this.toggleStockValue=t,this.tabla1.filterRows()})}ngOnInit(){this.tabla1=new O.a,this.tabla1.groupField="",this.tabla1.secondarySort="sProducto",this.tabla1.sum=[],this.tabla1.updateFilterBoolean("T","bActivo"),this.tabla1.customFilter=t=>this.toggleStockValue?t.filter(t=>t.rStock<t.rStockMinimo):t,this.breakpointObserver.observe([w.b.XSmall,w.b.Small,w.b.Medium,w.b.Large,w.b.XLarge]).subscribe(t=>{this.isXSmall=this.breakpointObserver.isMatched(w.b.XSmall),this.isSmall=this.breakpointObserver.isMatched(w.b.Small),this.isMedium=this.breakpointObserver.isMatched(w.b.Medium),this.isLarge=this.breakpointObserver.isMatched(w.b.Large),this.isXLarge=this.breakpointObserver.isMatched(w.b.XLarge)}),this.loader.open(),Object(W.a)(this.servicioPermisos.puedeVer("actHistorialProducto")).pipe(Object(E.a)()).subscribe(t=>{this.puedeVerHistorial=t[0]}),this.servicioStock.obtenerDepositos().subscribe(t=>{this.depositos=t,this.depositos.sort((t,e)=>t.sdescripcion>e.sdescripcion?1:t.sdescripcion<e.sdescripcion?-1:0),this.depositoActual=this.depositos[0],this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}mostrarOcultar(t){switch(t){case"XS":return!0;case"S":return this.isSmall||this.isMedium||this.isLarge||this.isXLarge;case"M":return this.isMedium||this.isLarge||this.isXLarge;case"L":return this.isLarge||this.isXLarge;case"XL":return this.isXLarge}}refresh(){this.loader.open(),this.servicioStock.obtenerStock(this.depositoActual.id).subscribe(t=>{t.forEach(t=>{t.sEAN||(t.sEAN=""),t.sEAN2||(t.sEAN2=""),t.rStock=parseFloat(t.rStock),t.rStockMinimo=parseFloat(t.rStockMinimo)}),this.tabla1.setData(t.filter(()=>!0)),this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}seleccionarDeposito(t){this.depositoActual=t}getRowHeight(t){return 50}export(){var t=this.tabla1.data.map(t=>({Dep\u00f3sito:t.sDeposito,C\u00f3digo:t.sCodProducto,Nombre:t.sProducto,Familia:t.sFamilia,Stock:t.rStock}));this.servicioExportarExcel.exportExcel(t,"stock","stock")}onSort(t){const e=t.sorts[0];this.tabla1.secondarySort=e.prop,this.tabla1.sortDir=e.dir,this.tabla1.sortData()}openPopUp(t={}){this.loader.open(),this.servicioStock.obtenerHistorialProducto(this.depositoActual.id,t.idProducto).subscribe(e=>{this.loader.close(),this.dialog.open(I.a,{width:"720px",disableClose:!0,data:{title:"HISTORIAL DE STOCK",payload:t,historialstock:e}}).afterClosed().subscribe(t=>{})})}}return t.\u0275fac=function(e){return new(e||t)(P.Rb(b.b),P.Rb(L),P.Rb(y.a),P.Rb(M.a),P.Rb(d.a),P.Rb(A.a),P.Rb(w.a))},t.\u0275cmp=P.Lb({type:t,selectors:[["app-stock"]],decls:38,vars:31,consts:[[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","end center",1,"p-8"],["appearance","fill","fxFlex","100","fxFlex.gt-xs","25","fxFlex.gt-sm","16",1,"m-8"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"m-8",3,"click"],["class","p-8","fxLayout","row wrap","fxLayoutAlign","end center",4,"ngIf"],[1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],["prop","sCodProducto",3,"summaryTemplate","name","flexGrow",4,"ngIf"],["prop","sProducto",3,"summaryTemplate","name","flexGrow",4,"ngIf"],["prop","sEAN",3,"summaryTemplate","name","flexGrow",4,"ngIf"],["prop","sFamilia",3,"summaryTemplate","name","flexGrow",4,"ngIf"],["prop","rStock",3,"summaryTemplate","name","flexGrow",4,"ngIf"],["prop","rStockMinimo",3,"summaryTemplate","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","sortable",4,"ngIf"],[4,"ngIf"],["tabla1sCodProducto",""],["tabla1sProducto",""],["tabla1sEAN",""],["tabla1sFamilia",""],["tabla1rStock",""],["tabla1rStockMinimo",""],[3,"value"],[1,"m-8",3,"formControl"],["prop","sCodProducto",3,"summaryTemplate","name","flexGrow"],["ngx-datatable-cell-template",""],["prop","sProducto",3,"summaryTemplate","name","flexGrow"],["prop","sEAN",3,"summaryTemplate","name","flexGrow"],["prop","sFamilia",3,"summaryTemplate","name","flexGrow"],["prop","rStock",3,"summaryTemplate","name","flexGrow"],["prop","rStockMinimo",3,"summaryTemplate","name","flexGrow"],[3,"name","flexGrow","sortable"],["mat-icon-button","","mat-sm-button","","color","foreground","class","mr-16",3,"click",4,"ngIf"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["ngx-datatable-footer-template",""],[1,"p-8",2,"margin-left","auto"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],[1,"margin-333",2,"width","100%"],["matInput","","placeholder","","value","",3,"keyup"],["searchinput",""],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],["type","number","matInput","","placeholder","","value","",3,"keyup"]],template:function(t,e){1&t&&(P.Xb(0,"mat-card",0),P.Xb(1,"div",1),P.Xb(2,"mat-form-field",2),P.Xb(3,"mat-label"),P.Oc(4),P.kc(5,"translate"),P.Wb(),P.Xb(6,"mat-select",3),P.fc("selectionChange",function(t){return e.seleccionarDeposito(t.value)})("valueChange",function(t){return e.depositoActual=t}),P.Mc(7,R,2,2,"mat-option",4),P.Wb(),P.Wb(),P.Xb(8,"button",5),P.fc("click",function(){return e.refresh()}),P.Xb(9,"mat-icon"),P.Oc(10,"search"),P.Wb(),P.Oc(11),P.kc(12,"translate"),P.Wb(),P.Wb(),P.Mc(13,G,7,8,"div",6),P.Wb(),P.Xb(14,"mat-card",0),P.Xb(15,"mat-card-content",0),P.Xb(16,"ngx-datatable",7,8),P.fc("sort",function(t){return e.onSort(t)}),P.Mc(18,H,3,5,"ngx-datatable-column",9),P.Mc(19,Y,3,5,"ngx-datatable-column",10),P.Mc(20,U,3,5,"ngx-datatable-column",11),P.Mc(21,$,3,5,"ngx-datatable-column",12),P.Mc(22,K,3,5,"ngx-datatable-column",13),P.Mc(23,Z,3,5,"ngx-datatable-column",14),P.Mc(24,tt,3,5,"ngx-datatable-column",15),P.Mc(25,ot,2,0,"ngx-datatable-footer",16),P.Wb(),P.Wb(),P.Wb(),P.Mc(26,nt,4,1,"ng-template",null,17,P.Nc),P.Mc(28,rt,4,1,"ng-template",null,18,P.Nc),P.Mc(30,st,4,1,"ng-template",null,19,P.Nc),P.Mc(32,ut,4,1,"ng-template",null,20,P.Nc),P.Mc(34,pt,4,1,"ng-template",null,21,P.Nc),P.Mc(36,dt,4,1,"ng-template",null,22,P.Nc)),2&t&&(P.Eb(4),P.Pc(P.lc(5,24,"Dep\xf3sitos")),P.Eb(2),P.pc("value",e.depositoActual),P.Eb(1),P.pc("ngForOf",e.depositos),P.Eb(4),P.Pc(P.lc(12,26,"SALES.SHOW")),P.Eb(2),P.pc("ngIf",e.tabla1.data.length>0),P.Eb(1),P.pc("@animate",P.vc(29,ht,P.uc(28,gt))),P.Eb(2),P.pc("columnMode","flex")("headerHeight",50)("footerHeight",100)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",e.tabla1.rows)("summaryRow",!0)("externalSorting",!0)("selectionType","single"),P.Eb(2),P.pc("ngIf",e.mostrarOcultar("L")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("XS")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("L")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("L")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("XS")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("XS")),P.Eb(1),P.pc("ngIf",e.mostrarOcultar("XS")),P.Eb(1),P.pc("ngIf",e.tabla1.data.length>0))},directives:[l.a,T.c,T.b,D.c,T.a,D.f,p.a,o.n,r.b,u.a,o.o,l.b,S.d,C.n,f.a,i.o,i.f,S.b,S.a,S.e,S.c,m.b,D.h],pipes:[k.c,o.g],styles:[""],data:{animation:[v.a]}}),t})(),data:{title:"STOCK"}}];let St=(()=>{class t{}return t.\u0275mod=P.Pb({type:t}),t.\u0275inj=P.Ob({factory:function(e){return new(e||t)},imports:[[o.c,i.t,n.a,S.f,m.c,m.c,l.c,m.c,r.c,s.a,m.c,h.b,b.f,d.b,f.b,g.c,p.b,u.b,k.b,X.a,x.g,a.k.forChild(kt)]]}),t})()}}]);