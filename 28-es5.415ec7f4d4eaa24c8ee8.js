!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{vpPe:function(t,e,i){"use strict";i.d(e,"a",function(){return c});var a=i("8Y7J"),c=function(){var t=function(){function t(){n(this,t)}return o(t,[{key:"generateUUID",value:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var n=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?n:3&n|8).toString(16)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=a.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},yElb:function(e,i,a){"use strict";a.r(i),a.d(i,"ClientsUploadModule",function(){return lt});var c,r=a("SVse"),l=a("s7LF"),s=a("GmJt"),u=a("3sEA"),d=a("vpPe"),b=a("GyhO"),p=a("VRyK"),f=a("Cfvw"),g=a("CHRX"),h=a("EUZL"),v=a("AytR"),m=a("8Y7J"),C=a("IheW"),y=((c=function(){function t(e){n(this,t),this.http=e,this.listaClientes=[]}return o(t,[{key:"obtenerDatos",value:function(t,e,n){return this.http.get(encodeURI("".concat(v.a.apiURL,'Clientes?filter={"where":').concat(t,',"limit":').concat(e,',"skip":').concat(n,',"order":"srazonsocial ASC"}')))}},{key:"traerClientes",value:function(){return this.http.get(encodeURI(v.a.apiURL+"Clientes"))}},{key:"actualizarCliente",value:function(t){return this.http.put("".concat(v.a.apiURL,"Clientes/").concat(t.id),t)}},{key:"obtenerTiposClientes",value:function(){return this.http.get(encodeURI(v.a.apiURL+'Tiposcliente?filter={"where":{"deletedon":{"eq":null}}}'))}},{key:"obtenerEmpresas",value:function(){return this.http.get(v.a.apiURL+"Empresas")}},{key:"agregarCliente",value:function(t){return this.http.post(v.a.apiURL+"Clientes",t)}},{key:"traerClientesPagina",value:function(t,e,n,i){var o=this;this.http.get(encodeURI("".concat(v.a.apiURL,'Clientes?filter={"limit":').concat(t,',"skip":').concat(e,',"order":"').concat(n,'"}'))).subscribe(function(a){a.length>0?(o.listaClientes=o.listaClientes.concat(a),o.traerClientesPagina(t,e+t,n,i)):i()})}},{key:"traerProductos",value:function(t,e){this.listaClientes.length=0,this.traerClientesPagina(2e4,0,t,e)}}]),t}()).\u0275fac=function(t){return new(t||c)(m.bc(C.c))},c.\u0275prov=m.Nb({token:c,factory:c.\u0275fac,providedIn:"root"}),c),O=a("5+tZ"),E=a("vkgz"),w=a("IAdc"),S=a("zHaW"),T=a("PDjf"),x=a("w9WL"),I=a("Dxy4"),k=a("Tj54"),M=a("jMqV"),N=a("TSSN");function W(t,e){if(1&t){var n=m.Yb();m.Xb(0,"div"),m.Oc(1),m.Xb(2,"button",9),m.fc("click",function(){return m.Dc(n),m.jc(),m.Ac(3).click()}),m.Xb(3,"mat-icon"),m.Oc(4,"attach_file"),m.Wb(),m.Oc(5,"Cargar archivo "),m.Wb(),m.Wb()}if(2&t){var i=m.jc();m.Eb(1),m.Qc(" ",i.fileName||"Ning\xfan archivo cargado todav\xeda."," ")}}function R(t,e){if(1&t){var n=m.Yb();m.Xb(0,"button",9),m.fc("click",function(){return m.Dc(n),m.jc(2).upload()}),m.Xb(1,"mat-icon"),m.Oc(2,"cloud_upload"),m.Wb(),m.Oc(3,"Subir "),m.Wb()}}function j(t,e){if(1&t&&(m.Xb(0,"div"),m.Oc(1),m.Xb(2,"mat-slide-toggle",10),m.Oc(3),m.kc(4,"translate"),m.Wb(),m.Mc(5,R,4,0,"button",11),m.Wb()),2&t){var n=m.jc();m.Eb(1),m.Qc(" ",n.fileName||"Ning\xfan archivo cargado todav\xeda."," "),m.Eb(1),m.pc("formControl",n.toggle),m.Eb(1),m.Pc(m.lc(4,4,"Mostrar clientes")),m.Eb(2),m.pc("ngIf",0==n.total)}}function X(t,e){if(1&t&&(m.Xb(0,"div"),m.Xb(1,"p"),m.Xb(2,"strong"),m.Oc(3,"Hay c\xf3digos duplicados:"),m.Wb(),m.Oc(4," por favor vuelva a editar el archivo de Excel y aseg\xfarese que los clientes tengan un c\xf3digo distinto cada uno que no se repita. Tambi\xe9n puede tener clientes con c\xf3digos duplicados ya cargados, en ese caso aseg\xfarese de editar los clientes con el editor."),m.Wb(),m.Xb(5,"p"),m.Oc(6),m.Wb(),m.Wb()),2&t){var n=m.jc();m.Eb(6),m.Pc(n.duplicados.join(", "))}}function D(t,e){if(1&t&&(m.Xb(0,"div"),m.Xb(1,"div",12),m.Xb(2,"p"),m.Oc(3),m.Wb(),m.Xb(4,"p"),m.Xb(5,"b",13),m.Oc(6),m.Wb(),m.Wb(),m.Wb(),m.Wb()),2&t){var n=m.jc();m.Eb(3),m.Rc("Subida: ",n.count," / ",n.total,""),m.Eb(3),m.Qc("",n.percent," %")}}function L(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.scodcliente," ")}}function P(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.srazonsocial," ")}}function U(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.sdomicilio," ")}}function A(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.scuit," ")}}function F(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.scondicioniva," ")}}function V(t,e){1&t&&(m.Xb(0,"span"),m.Oc(1,"Si"),m.Wb())}function z(t,e){1&t&&(m.Xb(0,"span"),m.Oc(1,"No"),m.Wb())}function H(t,e){if(1&t&&(m.Mc(0,V,2,0,"span",2),m.Mc(1,z,2,0,"span",2)),2&t){var n=e.row;m.pc("ngIf","T"==(null==n?null:n.bcredito)),m.Eb(1),m.pc("ngIf","F"==(null==n?null:n.bcredito))}}function q(t,e){if(1&t&&m.Oc(0),2&t){var n=e.row;m.Qc(" ",null==n?null:n.rlimitecredito," ")}}function Q(t,e){1&t&&(m.Xb(0,"span"),m.Oc(1,"Si"),m.Wb())}function _(t,e){1&t&&(m.Xb(0,"span"),m.Oc(1,"No"),m.Wb())}function J(t,e){if(1&t&&(m.Mc(0,Q,2,0,"span",2),m.Mc(1,_,2,0,"span",2)),2&t){var n=e.row;m.pc("ngIf","T"==(null==n?null:n.bactivo)),m.Eb(1),m.pc("ngIf","F"==(null==n?null:n.bactivo))}}var Y,Z,B=function(){return{y:"50px",delay:"300ms"}},K=function(t){return{value:"*",params:t}},G=[{path:"",component:(Y=function(){function e(t,i,o,a){var c=this;n(this,e),this.servicioClientes=t,this.loader=i,this.snack=o,this.servicioUUID=a,this.fileName="",this.toggle=new l.e(!1,[]),this.toggleValue=!1,this.count=0,this.percent=0,this.total=0,this.toggle.valueChanges.subscribe(function(t){c.toggleValue=t}),this.empresas=[],this.duplicados=[],this.tipoCliente=[]}return o(e,[{key:"ngOnInit",value:function(){var t=this;this.tabla1=new g.a,this.tabla1.groupField="",this.tabla1.secondarySort="snombre",this.tabla1.sum=[],this.loader.open(),this.servicioClientes.obtenerEmpresas().subscribe(function(e){t.empresas=e,t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"getTipoCliente",value:function(t){var e=this.tipoCliente.find(function(e){return e.id==t});return e?e.stipocliente:""}},{key:"convertirComoSi",value:function(t){return"T"==t?"Si":"No"}},{key:"esElMismoCliente",value:function(t,e){return!("string"==typeof e["*Codigo"]&&!Object.is(e["*Codigo"],t.scodcliente)||"string"==typeof e["*Raz\xf3n Social"]&&!Object.is(e["*Raz\xf3n Social"],t.srazonsocial)||"string"==typeof e["*Domicilio"]&&!Object.is(e["*Domicilio"],t.sdomicilio)||"string"==typeof e.Localidad&&!Object.is(e.Localidad,t.slocalidad?t.slocalidad:"")||"string"==typeof e["*Condicion IVA"]&&!Object.is(e["*Condicion IVA"],t.scondicioniva)||"string"==typeof e.CUIT&&!Object.is(e.CUIT,t.scuit?t.scuit:"")||"string"==typeof e["*Documento"]&&!Object.is(e["*Documento"],t.sdocumento)||"number"==typeof e["Limite de Credito"]&&!Object.is(e["Limite de Credito"],t.rlimitecredito)||"number"==typeof e["Tope de Descuento"]&&!Object.is(e["Tope de Descuento"],t.rtopedescuento)||"string"==typeof e["Venta a Credito"]&&!Object.is("S"==e["Venta a Credito"]?"T":"F",t.bcredito)||"string"==typeof e.Activo&&!Object.is("S"==e.Activo?"T":"F",t.bactivo)||"string"==typeof e.Favorito&&!Object.is("S"==e.Favorito?"T":"F","F"!=t.bfavorito?"T":"F"))}},{key:"asignarValores",value:function(t,e){t.scodcliente=e["*Codigo"],e["*Raz\xf3n Social"]&&(t.srazonsocial=e["*Raz\xf3n Social"].toString()),e["*Domicilio"]&&(t.sdomicilio=e["*Domicilio"].toString()),e.Localidad&&(t.slocalidad=e.Localidad.toString()),e["*Condicion IVA"]&&(t.scondicioniva=e["*Condicion IVA"].toString()),e.CUIT&&(t.scuit=e.CUIT.toString()),e["*Documento"]&&(t.sdocumento=e["*Documento"].toString()),"number"==typeof e["Limite de Credito"]&&(t.rlimitecredito=e["Limite de Credito"]),t.hasOwnProperty("bactivo")||(t.bactivo="T"),"string"==typeof e.Activo&&("S"===e.Activo?t.bactivo="T":"N"===e.Activo&&(t.bactivo="F")),t.hasOwnProperty("bfavorito")||(t.bfavorito="F"),t.hasOwnProperty("rtopedescuento")||(t.rtopedescuento=100),"number"==typeof e["Tope de Descuento"]&&(t.rtopedescuento=e["Tope de Descuento"]),"string"==typeof e["Venta a Credito"]&&(t.bcredito="S"==e["Venta a Credito"]?"T":"F")}},{key:"onFileSelected",value:function(t){var e=this,n=t.target.files[0];if(n){this.fileName=n.name;var i=new FileReader;i.onload=function(t){var n=h.read(i.result,{type:"binary"}),o=h.utils.sheet_to_json(n.Sheets.Clientes);e.loader.open(),e.servicioClientes.traerClientes().subscribe(function(t){e.rows=[];try{o.forEach(function(n){if(null!=n["*Codigo"]&&null!=n["*Codigo"]&&""!=n["*Codigo"]){var i=t.find(function(t){return t.scodcliente==n["*Codigo"]});if(i){if(!e.esElMismoCliente(i,n)){var o={};Object.assign(o,i),e.asignarValores(o,n),e.rows.push(o)}}else e.asignarValores(o={},n),e.rows.push(o)}})}catch(c){console.error(c)}for(var n=[],i=0;i<o.length;i++)if(o[i]["*Codigo"]){var a=o.filter(function(t){if(t["*Codigo"])return o[i]["*Codigo"]==t["*Codigo"]});a.length>1&&n.push(o[i]["*Codigo"]+" ("+a.length+" veces)")}e.duplicados=n,e.duplicados=Array.from(new Set(n)),e.tabla1.setData(e.rows),e.loader.close()})},this.loader.close(),i.readAsBinaryString(n)}}},{key:"uploadFile",value:function(t){return t.id?this.servicioClientes.actualizarCliente(t):(t.id=this.servicioUUID.generateUUID(),this.servicioClientes.agregarCliente(t))}},{key:"upload",value:function(){var e=this;(new Date).getTime().toString(),this.count=0,this.percent=0,this.total=this.rows.length;var n=this.rows.map(function(t){return e.uploadFile(t)}),i=(Object(b.a).apply(void 0,t(n)),Object(p.a).apply(void 0,t(n)),Object(f.a)(n).pipe(Object(O.a)(function(t){return t},6)));this.sub=i.pipe(Object(E.a)(function(t){return e.updateProgressMeter(t)}),Object(w.a)()).subscribe(function(t){},function(t){e.loader.close(),e.snack.open("ERROR","OK",{duration:4e3})})}},{key:"updateProgressMeter",value:function(t){this.count++,this.percent=this.total>0?Math.round(this.count/this.total*100):0}},{key:"ngOnDestroy",value:function(){this.sub&&this.sub.unsubscribe()}},{key:"getRowHeight",value:function(t){return 50}},{key:"onSort",value:function(t){var e=t.sorts[0];this.tabla1.secondarySort=e.prop,this.tabla1.sortDir=e.dir,this.tabla1.sortData()}}]),e}(),Y.\u0275fac=function(t){return new(t||Y)(m.Rb(y),m.Rb(u.a),m.Rb(S.a),m.Rb(d.a))},Y.\u0275cmp=m.Lb({type:Y,selectors:[["app-clients-upload"]],decls:37,vars:55,consts:[["type","file","accept","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",1,"file-input",3,"change"],["fileUpload",""],[4,"ngIf"],[3,"hidden"],[1,"p-0"],[1,"material","expandable","bg-white",2,"height","50vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],[3,"name","width"],["ngx-datatable-cell-template",""],["mat-raised-button","","color","primary",1,"m-8",3,"click"],[1,"m-8",3,"formControl"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],[2,"text-align","center"],[2,"font-size","150%"]],template:function(t,e){1&t&&(m.Xb(0,"mat-card"),m.Xb(1,"mat-card-content"),m.Xb(2,"input",0,1),m.fc("change",function(t){return e.onFileSelected(t)}),m.Wb(),m.Mc(4,W,6,1,"div",2),m.Mc(5,j,6,6,"div",2),m.Mc(6,X,7,1,"div",2),m.Mc(7,D,7,3,"div",2),m.Wb(),m.Wb(),m.Xb(8,"div",3),m.Xb(9,"mat-card",4),m.Xb(10,"mat-card-content",4),m.Xb(11,"ngx-datatable",5,6),m.fc("sort",function(t){return e.onSort(t)}),m.Xb(13,"ngx-datatable-column",7),m.kc(14,"translate"),m.Mc(15,L,1,1,"ng-template",8),m.Wb(),m.Xb(16,"ngx-datatable-column",7),m.kc(17,"translate"),m.Mc(18,P,1,1,"ng-template",8),m.Wb(),m.Xb(19,"ngx-datatable-column",7),m.kc(20,"translate"),m.Mc(21,U,1,1,"ng-template",8),m.Wb(),m.Xb(22,"ngx-datatable-column",7),m.kc(23,"translate"),m.Mc(24,A,1,1,"ng-template",8),m.Wb(),m.Xb(25,"ngx-datatable-column",7),m.kc(26,"translate"),m.Mc(27,F,1,1,"ng-template",8),m.Wb(),m.Xb(28,"ngx-datatable-column",7),m.kc(29,"translate"),m.Mc(30,H,2,2,"ng-template",8),m.Wb(),m.Xb(31,"ngx-datatable-column",7),m.kc(32,"translate"),m.Mc(33,q,1,1,"ng-template",8),m.Wb(),m.Xb(34,"ngx-datatable-column",7),m.kc(35,"translate"),m.Mc(36,J,2,2,"ng-template",8),m.Wb(),m.Wb(),m.Wb(),m.Wb(),m.Wb()),2&t&&(m.pc("@animate",m.vc(50,K,m.uc(49,B))),m.Eb(4),m.pc("ngIf",!e.fileName),m.Eb(1),m.pc("ngIf",e.fileName),m.Eb(1),m.pc("ngIf",e.duplicados.length>0),m.Eb(1),m.pc("ngIf",e.total>0),m.Eb(1),m.pc("hidden",!e.toggleValue),m.Eb(1),m.pc("@animate",m.vc(53,K,m.uc(52,B))),m.Eb(2),m.pc("columnMode","standard")("headerHeight",50)("footerHeight",100)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!0)("rows",e.tabla1.rows)("summaryRow",!1)("externalSorting",!0)("selectionType","single"),m.Eb(2),m.qc("name",m.lc(14,33,"CLIENTSCOMPONENT.CODE")),m.pc("width",150),m.Eb(3),m.qc("name",m.lc(17,35,"CLIENTSCOMPONENT.BUSINESSNAME")),m.pc("width",325),m.Eb(3),m.qc("name",m.lc(20,37,"CLIENTSCOMPONENT.ADDRESS")),m.pc("width",325),m.Eb(3),m.qc("name",m.lc(23,39,"CLIENTSCOMPONENT.CUIT")),m.pc("width",150),m.Eb(3),m.qc("name",m.lc(26,41,"CLIENTSCOMPONENT.FISCALCONDITION")),m.pc("width",200),m.Eb(3),m.qc("name",m.lc(29,43,"CLIENTSCOMPONENT.CREDIT")),m.pc("width",150),m.Eb(3),m.qc("name",m.lc(32,45,"CLIENTSCOMPONENT.CREDITLIMIT")),m.pc("width",150),m.Eb(3),m.qc("name",m.lc(35,47,"CLIENTSCOMPONENT.ACTIVE")),m.pc("width",150))},directives:[T.a,T.b,r.o,x.d,x.b,x.a,I.b,k.a,M.a,l.n,l.f],pipes:[N.c],styles:[".file-input[_ngcontent-%COMP%]{display:none}.progress[_ngcontent-%COMP%]{display:block;width:16px;height:16px;border:1px solid #000;float:left;margin:0 4px 4px 0}.progress.uploading[_ngcontent-%COMP%]{background:gold}.progress.uploaded[_ngcontent-%COMP%], uploading[_ngcontent-%COMP%]{background:green}"],data:{animation:[s.a]}}),Y),data:{title:"SUBIR CLIENTES"}}],$=a("iInd"),tt=a("u9T3"),et=a("f44v"),nt=a("iELJ"),it=a("e6WT"),ot=a("ZTz/"),at=a("M9ds"),ct=a("ZFy/"),rt=a("PCNd"),lt=((Z=function t(){n(this,t)}).\u0275mod=m.Pb({type:Z}),Z.\u0275inj=m.Ob({factory:function(t){return new(t||Z)},imports:[[r.c,l.s,tt.a,x.f,it.c,it.c,T.c,it.c,I.c,et.a,it.c,ct.b,nt.f,S.b,M.b,at.c,ot.b,k.b,N.b,rt.a,$.k.forChild(G)]]}),Z)}}])}();