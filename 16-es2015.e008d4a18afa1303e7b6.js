(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"2Doj":function(t,o,a){"use strict";a.r(o),a.d(o,"NewPurchaseModule",function(){return Ft});var e=a("SVse"),r=a("s7LF"),i=a("GmJt"),s=a("3kSh"),c=a("3sEA"),n=a("vpPe"),l=a("wd/R"),u=a("cp0P"),m=a("JX91"),p=a("lJxs"),d=a("Sp5M"),h=a("CHRX"),f=a("qA6C"),b=a("UVsP"),C=a("AytR"),g=a("8Y7J"),v=a("IheW");let _=(()=>{class t{constructor(t){this.http=t}obtenerImpuestos(){return this.http.get(C.a.apiURL+'Impuestos?filter={"where":{"deletedon":{"eq":null}}}')}obtenerSucursales(){return this.http.get(C.a.apiURL+'Sucursales?filter={"where":{"deletedon":{"eq":null}},"order":"sdescripcion ASC"}')}obtenerDepositoXSucursal(t){return this.http.get(`${C.a.apiURL}Sucursales/DepositoXSucursal?idsucursal=${t}`)}guardarCompra(t){return this.http.post(C.a.apiURL+"Compras",t)}guardarCompraItem(t){return this.http.post(C.a.apiURL+"ComprasItems",t)}guardarImpuestos(t){return this.http.post(C.a.apiURL+"ImpuestosXCompra",t)}}return t.\u0275fac=function(o){return new(o||t)(g.bc(v.c))},t.\u0275prov=g.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var E=a("zHaW"),S=a("iInd"),F=a("VDRc"),D=a("Q2Ze"),P=a("e6WT"),W=a("vrAh"),A=a("ZTz/"),O=a("pMoy"),w=a("n1FK"),R=a("TN/R"),I=a("Dxy4"),k=a("Tj54"),N=a("PDjf"),x=a("w9WL"),X=a("UhP/"),y=a("TSSN");function M(t,o){if(1&t&&(g.Xb(0,"mat-option",53),g.Oc(1),g.Wb()),2&t){const t=o.$implicit;g.pc("value",t),g.Eb(1),g.Qc(" ",null==t?null:t.srazonsocial," ")}}function U(t,o){if(1&t&&(g.Xb(0,"mat-option",53),g.Oc(1),g.Wb()),2&t){const t=o.$implicit;g.pc("value",t),g.Eb(1),g.Qc(" ",t," ")}}function T(t,o){if(1&t&&(g.Xb(0,"mat-option",53),g.Oc(1),g.Wb()),2&t){const t=o.$implicit;g.pc("value",t),g.Eb(1),g.Qc(" ",t," ")}}function H(t,o){if(1&t&&(g.Xb(0,"mat-option",53),g.Oc(1),g.Wb()),2&t){const t=o.$implicit;g.pc("value",t),g.Eb(1),g.Qc(" ",t.sdescripcion," ")}}function V(t,o){if(1&t){const t=g.Yb();g.Xb(0,"mat-form-field",23),g.Xb(1,"mat-label"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Xb(4,"mat-select",8),g.fc("ngModelChange",function(o){return g.Dc(t),g.jc().form_sucursal=o}),g.Mc(5,H,2,2,"mat-option",5),g.Wb(),g.Wb()}if(2&t){const t=g.jc();g.Eb(2),g.Pc(g.lc(3,3,"NEWPURCHASES.BRANCHDEPOSIT")),g.Eb(2),g.pc("ngModel",t.form_sucursal),g.Eb(1),g.pc("ngForOf",t.sucursales_data)}}function j(t,o){if(1&t&&(g.Xb(0,"mat-option",53),g.Oc(1),g.Wb()),2&t){const t=o.$implicit;g.pc("value",t),g.Eb(1),g.Rc(" ",null==t?null:t.scodproducto," - ",null==t?null:t.snombre," ")}}function L(t,o){if(1&t){const t=g.Yb();g.Xb(0,"mat-form-field",54),g.Xb(1,"mat-label"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Sb(4,"input",55),g.Xb(5,"mat-autocomplete",3,56),g.fc("optionSelected",function(o){return g.Dc(t),g.jc().selectedItemChangeProducto(o.option.value)}),g.Mc(7,j,2,3,"mat-option",5),g.kc(8,"async"),g.Wb(),g.Wb()}if(2&t){const t=g.Ac(6),o=g.jc();g.Eb(2),g.Pc(g.lc(3,5,"NEWPURCHASES.PRODUCT")),g.Eb(2),g.pc("formControl",o.editorProducto)("matAutocomplete",t),g.Eb(1),g.pc("displayWith",o.displayFnProductos),g.Eb(2),g.pc("ngForOf",g.lc(8,7,o.filteredProductos))}}function G(t,o){if(1&t&&(g.Xb(0,"mat-form-field",57),g.Xb(1,"mat-label"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Sb(4,"input",58),g.Wb()),2&t){const t=g.jc();g.Eb(2),g.Pc(g.lc(3,2,"NEWPURCHASES.DETAIL")),g.Eb(2),g.pc("formControl",t.form_servicio)}}function B(t,o){1&t&&(g.Xb(0,"mat-label"),g.Oc(1),g.kc(2,"translate"),g.Wb()),2&t&&(g.Eb(1),g.Pc(g.lc(2,1,"NEWPURCHASES.NETPRICE")))}function q(t,o){1&t&&(g.Xb(0,"mat-label"),g.Oc(1),g.kc(2,"translate"),g.Wb()),2&t&&(g.Eb(1),g.Pc(g.lc(2,1,"NEWPURCHASES.UNITPRICE")))}function Q(t,o){if(1&t&&(g.Xb(0,"mat-form-field",14),g.Xb(1,"mat-label"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Sb(4,"input",59),g.Wb()),2&t){const t=g.jc();g.Eb(2),g.Pc(g.lc(3,2,"NEWPURCHASES.FINALPRICE")),g.Eb(2),g.pc("formControl",t.form_precio_final)}}function $(t,o){if(1&t&&(g.Oc(0),g.kc(1,"number")),2&t){const t=o.row;g.Qc(" ",g.lc(1,1,null==t?null:t.rcantidad)," ")}}function Y(t,o){if(1&t&&g.Oc(0),2&t){const t=o.row;g.Qc(" ",null==t?null:t.sconcepto," ")}}function z(t,o){if(1&t&&(g.Oc(0),g.kc(1,"currency")),2&t){const t=o.row;g.Qc(" ",g.lc(1,1,null==t?null:t.rpreciou)," ")}}function K(t,o){if(1&t&&(g.Xb(0,"ngx-datatable-column",38),g.kc(1,"translate"),g.Mc(2,z,2,3,"ng-template",39),g.Wb()),2&t){const t=g.jc();g.qc("name",g.lc(1,3,"NEWPURCHASES.PRICE")),g.pc("cellClass",t.getCellClass)("flexGrow",1)}}function J(t,o){if(1&t&&(g.Oc(0),g.kc(1,"currency")),2&t){const t=o.row;g.Qc(" ",g.lc(1,1,null==t?null:t.rtotal)," ")}}function Z(t,o){if(1&t&&(g.Xb(0,"ngx-datatable-column",38),g.kc(1,"translate"),g.Mc(2,J,2,3,"ng-template",39),g.Wb()),2&t){const t=g.jc();g.qc("name",g.lc(1,3,"NEWPURCHASES.TOTAL")),g.pc("cellClass",t.getCellClass)("flexGrow",1)}}function tt(t,o){if(1&t&&(g.Oc(0),g.kc(1,"currency")),2&t){const t=o.row;g.Qc(" ",g.lc(1,1,null==t?null:t.rprecioneto)," ")}}function ot(t,o){if(1&t&&(g.Xb(0,"ngx-datatable-column",38),g.kc(1,"translate"),g.Mc(2,tt,2,3,"ng-template",39),g.Wb()),2&t){const t=g.jc();g.qc("name",g.lc(1,3,"NEWPURCHASES.NETPRICE")),g.pc("cellClass",t.getCellClass)("flexGrow",1)}}function at(t,o){if(1&t&&(g.Oc(0),g.kc(1,"currency")),2&t){const t=o.row;g.Qc(" ",g.lc(1,1,null==t?null:t.rtotalneto)," ")}}function et(t,o){if(1&t&&(g.Xb(0,"ngx-datatable-column",38),g.kc(1,"translate"),g.Mc(2,at,2,3,"ng-template",39),g.Wb()),2&t){const t=g.jc();g.qc("name",g.lc(1,3,"NEWPURCHASES.NETTOTAL")),g.pc("cellClass",t.getCellClass)("flexGrow",1)}}function rt(t,o){if(1&t){const t=g.Yb();g.Xb(0,"button",60),g.fc("click",function(){g.Dc(t);const a=o.row;return g.jc().editarItem(a)}),g.Xb(1,"mat-icon"),g.Oc(2,"edit"),g.Wb(),g.Wb(),g.Xb(3,"button",61),g.fc("click",function(){g.Dc(t);const a=o.row;return g.jc().eliminarItem(a)}),g.Xb(4,"mat-icon"),g.Oc(5,"delete"),g.Wb(),g.Wb()}}function it(t,o){1&t&&(g.Xb(0,"h4",44),g.Oc(1),g.kc(2,"translate"),g.Wb()),2&t&&(g.Eb(1),g.Qc(" ",g.lc(2,1,"NEWPURCHASES.TAXES"),""))}function st(t,o){if(1&t){const t=g.Yb();g.Xb(0,"mat-form-field",44),g.Xb(1,"mat-label"),g.Oc(2),g.Wb(),g.Xb(3,"input",64),g.fc("ngModelChange",function(t){return o.$implicit.total=t})("change",function(){return g.Dc(t),g.jc(2).calcular_total(!1)})("keyup",function(){return g.Dc(t),g.jc(2).calcular_total(!1)}),g.Wb(),g.Wb()}if(2&t){const t=o.$implicit;g.Eb(2),g.Pc(t.simpuesto),g.Eb(1),g.pc("ngModel",t.total)}}function ct(t,o){if(1&t&&(g.Xb(0,"div",62),g.Mc(1,st,4,2,"mat-form-field",63),g.Wb()),2&t){const t=g.jc();g.Eb(1),g.pc("ngForOf",t.lista_impuestos)}}function nt(t,o){if(1&t){const t=g.Yb();g.Xb(0,"mat-form-field",44),g.Xb(1,"mat-label"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Xb(4,"input",65),g.fc("change",function(){return g.Dc(t),g.jc().verificar_iva()})("keyup",function(){return g.Dc(t),g.jc().verificar_iva()}),g.Wb(),g.Wb()}if(2&t){const t=g.jc();g.Eb(2),g.Pc(g.lc(3,2,"NEWPURCHASES.TAXES")),g.Eb(2),g.pc("formControl",t.iva)}}function lt(t,o){1&t&&(g.Xb(0,"div",66),g.Xb(1,"b"),g.Oc(2),g.kc(3,"translate"),g.Wb(),g.Oc(4),g.kc(5,"translate"),g.Wb()),2&t&&(g.Eb(2),g.Pc(g.lc(3,2,"NEWPURCHASES.ATTENTION")),g.Eb(2),g.Qc(": ",g.lc(5,4,"NEWPURCHASES.ITISCONFIGUREDSOTHATTHISPURCHASEDOESNOTAFFECTTHESTOCK"),".\n"))}const ut=function(){return{y:"50px",delay:"300ms"}},mt=function(t){return{value:"*",params:t}},pt=function(){return["/purchases/purchases-by-document/"]},dt=[{path:"",component:(()=>{class t{constructor(t,o,a,e,i,s,c,n,u){this.servicioUUID=t,this.loader=o,this.snack=a,this.router=e,this.servicioNuevaCompra=i,this.servicioProductos=s,this.servicioEmpresas=c,this.servicioSucursales=n,this.confirmService=u,this.guardando=!1,this.editorProveedor=new r.e(""),this.editorProducto=new r.e(""),this.sucursal="",this.startDate=new r.e,this.endDate=new r.e,this.tiposFactura=["PRODUCTOS","SERVICIOS"],this.form_precio=new r.e(""),this.form_cantidad=new r.e(""),this.form_servicio=new r.e(""),this.form_tipoFactura="",this.form_tipoDocumento="",this.form_precio_final=new r.e(""),this.fecha=new r.e,this.fechacontable=new r.e,this.fechacaicae=new r.e,this.form_numero=new r.e(""),this.form_caicae=new r.e(""),this.form_afectarStock=new r.e(""),this.form_descuento=new r.e(""),this.subtotal=new r.e(""),this.iva=new r.e(""),this.total=new r.e(""),this.form_numero_sucursal=new r.e(""),this.form_acredito=new r.e(""),this.error_iva=!1,this.tipoFacturaBloqueado=!1,this.formModal=function(){this.confirmService.confirm({message:"\xbfDesea guardar la compra?"}).subscribe(t=>{if(t){var o,a=1;this.form_sucursal||(this.form_sucursal=this.sucursales_data[0]),o=this.form_sucursal.idsucursal,this.loader.open(),this.servicioNuevaCompra.obtenerDepositoXSucursal(o).subscribe(t=>{a=t[0].DepositoXSucursal,this.loader.close(),null==a?this.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3}):(this.guardando=!0,this.generarCompra(o,a))},t=>{this.loader.close(),this.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3})})}})},this.sucursal="",this.tiposDocumento=[],this.detalle=[],this.detalleimpuestos=[],this.fechaFiltroInicio=new Date,this.fechaFiltroFin=l().add(1,"days").toDate()}_filterProveedores(t){if("string"==typeof t){const o=t.toLowerCase();return this.proveedores.filter(t=>t.srazonsocial.toLowerCase().includes(o))}return[]}displayFnProveedores(t){return t&&t.srazonsocial?t.srazonsocial:""}_filterProductos(t){if("string"==typeof t){const o=t.toLowerCase();return this.productos.filter(t=>t.snombre.toLowerCase().includes(o))}return[]}displayFnProductos(t){return t&&t.snombre?t.snombre:""}getRowHeight(t){return 50}getCellClass({row:t,column:o}){return{ngxgroup:t.isGroup,"ngx-alert-success ngx-alert-padding":"status"==o.prop&&t.idTipoDoc&&("F"==t.idTipoDoc[0]||"P"==t.idTipoDoc[0])&&"F"==t.bAnulado,"ngx-alert-danger ngx-alert-padding":"status"==o.prop&&t.idTipoDoc&&"N"==t.idTipoDoc[0]&&"F"==t.bAnulado,"ngx-alert-warning ngx-alert-padding":"status"==o.prop&&t.bAnulado&&"T"==t.bAnulado}}tabla1OnActivate(t){"click"==t.type&&t.row.isGroup&&this.tabla1.setGroup(t.row)}ngOnInit(){this.tabla1=new h.a,this.tabla1.groupField="",this.tabla1.secondarySort="",this.tabla1.sum=[],this.tabla1.summaryRow=!1,this.tabla1.emptyRow=!1;var t=new Date;t.setHours(0,0,0,0);var o=new Date;o.setHours(23,59,59,999),this.startDate.setValue(t),this.endDate.setValue(o),this.loader.open(),this.servicioProductos.traerProductos("snombre ASC",()=>{this.productos=this.servicioProductos.listaProductos,Object(u.a)([this.servicioEmpresas.obtenerEmpresas(),this.servicioProductos.obtenerProveedores(),this.servicioNuevaCompra.obtenerImpuestos(),this.servicioNuevaCompra.obtenerSucursales()]).subscribe(t=>{this.empresas=t[0],this.cantidaddecimales=this.empresas[0].icantidaddecimales,this.proveedores=t[1],this.impuestos=t[2],this.sucursales_data=t[3],this.filteredProveedores=this.editorProveedor.valueChanges.pipe(Object(m.a)(""),Object(p.a)(t=>this._filterProveedores(t))),this.filteredProductos=this.editorProducto.valueChanges.pipe(Object(m.a)(""),Object(p.a)(t=>this._filterProductos(t))),this.nuevaCompra(),this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}renameKeys(t,o){const a=Object.keys(t).map(a=>({[o[a]||a]:t[a]}));return Object.assign({},...a)}obtenerNombreProveedor(t){if(this.proveedores)for(var o=0;o<this.proveedores.length;o++)if(this.proveedores[o].id==t)return this.proveedores[o].srazonsocial;return""}obtenerNombreProducto(t,o){for(var a=0;a<this.productos.length;a++)if(this.productos[a].id==t)return this.productos[a].snombre;return o}obtenerCodigoProducto(t){for(var o=0;o<this.productos.length;o++)if(this.productos[o].id==t)return this.productos[o].scodproducto;return""}cambiarTiposFactura(){this.form_servicio.setValue("")}cambiarProveedor(t){var o="T"==t.bdeproductos,a="T"==t.bdeservicios;this.tipoFacturaBloqueado=!1,this.form_tipoFactura=this.tiposFactura[0],o&&!a&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[0]),a&&!o&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[1]),this.cargarTiposDocumento(t.scondicioniva,o)}cargarTiposDocumento(t,o){this.tiposDocumento=["Presupuesto de Compra","Nota de Cr\xe9dito Presupuesto de Compra"],this.form_tipoDocumento="Presupuesto de Compra",o&&this.tiposDocumento.push("Remito de Compra"),"Monotributista"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Responsable Inscripto"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra A"),this.tiposDocumento.push("Nota de Cr\xe9dito A"),this.form_tipoDocumento="Factura de Compra A"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Consumidor Final"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C"))}buscarProducto(t){for(var o=0;o<this.productos.length;o++)if(this.productos[o].id==t)return this.productos[o];return{}}editarItem(t){this.temp_item=t,this.form_tipoFactura==this.tiposFactura[0]?(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_producto=this.buscarProducto(t.idproducto)):(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_servicio.setValue(t.sconcepto))}eliminarItem(t){var o=this.tabla1.data.indexOf(t);this.tabla1.data.splice(o,1),this.calcular_total(!0),this.tabla1.sortData(),0==this.tabla1.data.length&&this.editorProveedor.enable()}guardarItem(){try{this.form_cantidad.setValue(this.form_cantidad.value?this.form_cantidad.value:1);var t=this.tabla1.data.indexOf(this.temp_item),o=this.form_precio.value,a=this.form_precio_final.value;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento&&(o=parseFloat((a/1.21).toFixed(this.cantidaddecimales))),-1!=t?(this.form_tipoFactura==this.tiposFactura[0]?(this.tabla1.data[t].idproducto=this.form_producto.id,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=o,this.tabla1.data[t].rporciva=this.form_producto.rporciva,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=o*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-o),this.tabla1.data[t].sconcepto=this.form_producto.snombre):(this.tabla1.data[t].idproducto=null,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=o,this.tabla1.data[t].rporciva=21,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=o*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-o),this.tabla1.data[t].sconcepto=this.form_servicio.value),this.tabla1.data[t].impuesto_iva=this.tabla1.data[t].rporciva/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_dgr=this.tabla1.data[t].rporcdgr/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_interno=this.tabla1.data[t].rvalorimpinterno*this.tabla1.data[t].rcantidad):(this.tabla1.data.push(this.form_tipoFactura==this.tiposFactura[0]?{id:this.servicioUUID.generateUUID(),idproducto:this.form_producto.id,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:o,rporciva:this.form_producto.rporciva,rtotal:this.form_cantidad.value*a,rtotalneto:o*this.form_cantidad.value,rimpuestos:Math.abs(a-o),sconcepto:this.form_producto.snombre}:{id:this.servicioUUID.generateUUID(),idproducto:null,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:o,rporciva:21,rtotal:this.form_cantidad.value*a,rtotalneto:o*this.form_cantidad.value,rimpuestos:Math.abs(a-o),sconcepto:this.form_servicio.value}),this.tabla1.data[this.tabla1.data.length-1].impuesto_iva=this.tabla1.data[this.tabla1.data.length-1].rporciva/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_dgr=this.tabla1.data[this.tabla1.data.length-1].rporcdgr/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_interno=this.tabla1.data[this.tabla1.data.length-1].rvalorimpinterno*this.tabla1.data[this.tabla1.data.length-1].rcantidad),this.form_precio.setValue(0),this.form_precio_final.setValue(0),this.form_cantidad.setValue(1),this.form_servicio.setValue(""),this.temp_item=null,this.calcular_total(!0),this.tabla1.sortData(),this.editorProveedor.disable()}catch(e){console.error(e)}}tipoComprobanteDeCompra(t){return"Presupuesto de Compra"==t?"PDC":"Remito de Compra"==t?"RMC":"Factura de Compra A"==t?"CCA":"Factura de Compra B"==t?"CCB":"Factura de Compra C"==t?"CCC":"Nota de Cr\xe9dito A"==t?"CNA":"Nota de Cr\xe9dito B"==t?"CNB":"Nota de Cr\xe9dito C"==t?"CNC":"Nota de Cr\xe9dito Presupuesto de Compra"==t?"PSC":void 0}querySearch(t){if(""==t)return this.proveedores;var o=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.proveedores.length;a++){for(var e=this.proveedores[a].srazonsocial.toLowerCase(),r=!0,i=0;i<t.length;i++)if(-1==e.indexOf(t[i])){r=!1;break}r&&o.push(this.proveedores[a])}return o}querySearchProducto(t){if(""==t)return this.productos;var o=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.productos.length;a++)for(var e=this.productos[a],r=0;r<t.length;r++){var i=t[r];if(-1==e.snombre.toLowerCase().indexOf(i)&&e.scodproducto.toLowerCase()!=i&&e.sean!=i&&e.sean2!=i)break;o.push(this.productos[a])}return o}selectedItemChangeProducto(t){this.form_producto=t,t&&null!=t.rcostou&&this.form_precio.setValue(t.rcostou),this.calcular_precio_neto(),this.calcular_precio_final()}calcular_precio_neto(){var t=this.form_producto;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||(this.form_precio.setValue(parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales))),this.form_precio.setValue(t&&t.rcostou&&t.rporciva&&t.rporcdgr&&null!=t.rvalorimpinterno?parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales)):0))}calcular_precio_final(){var t=this.form_producto;this.form_precio_final.setValue(!t||"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento?this.form_precio.value:parseFloat((this.form_precio.value*(t.rporciva/100+t.rporcdgr/100+1)+t.rvalorimpinterno).toFixed(this.cantidaddecimales)))}nuevaCompra(){var t=new Date;t.setHours(0,0,0,0),this.fecha.setValue(t);var o=new Date;o.setHours(0,0,0,0),this.fechacontable.setValue(o);var a=new Date;a.setHours(0,0,0,0),this.fechacaicae.setValue(l(a).add(10,"days").toDate()),this.tabla1.data=[],this.form_precio.setValue(0),this.form_cantidad.setValue(1),this.form_producto="",this.form_servicio.setValue(""),this.form_tipoFactura=this.tiposFactura[0],this.form_tipoDocumento=this.tiposDocumento[0],this.form_numero.setValue(""),this.form_caicae.setValue(""),this.form_afectarStock.setValue(!1),this.form_descuento.setValue(0),this.form_sucursal=this.sucursales_data[0],this.editorProveedor.setValue(this.proveedores[0]),this.cambiarProveedor(this.proveedores[0]),this.subtotal.setValue(0),this.iva.setValue(0),this.total.setValue(0),this.lista_impuestos=[],this.lista_impuestos=[];for(var e=0;e<this.impuestos.length;e++)this.lista_impuestos.push({id:this.impuestos[e].id,simpuesto:this.impuestos[e].simpuesto,total:0,idempresa:this.impuestos[e].idempresa,rporc:this.impuestos[e].rporc})}cancelarCompra(){}fechaAfip(){var t=this.fechacaicae.value,o=t.getUTCMonth()+1,a=t.getUTCDate(),e=t.getUTCFullYear();return e=o<10?e+"0"+o:e+""+o,a<10?e+"0"+a:e+""+a}EsNotaDeCredito(t){return"CNA"==t||"CNB"==t||"CNC"==t||"CND"==t||"PSC"==t}generarCompra(t,o){var a={id:this.servicioUUID.generateUUID(),idproveedor:this.editorProveedor.value.id,idtipodoc:this.tipoComprobanteDeCompra(this.form_tipoDocumento),idpv:this.form_numero_sucursal.value?this.form_numero_sucursal.value:1,idnumdoc:this.form_numero.value?this.form_numero.value:0,idsucursal:t,fdocumento:this.fecha.value.toISOString(),fcarga:(new Date).toISOString(),fvencimiento:this.fecha.value.toISOString(),fcontable:this.fechacontable.value.toISOString(),rtotneto:this.subtotal.value,rtotdescuento:this.form_descuento.value,rtotimpuestos:"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?this.iva.value:0,rtotbruto:this.total.value,rtotsaldo:this.form_acredito.value?this.total:0,scondpago:"EFE",banulado:"F",cae:this.form_caicae.value,caefchvto:this.fechaAfip(),bafectarstock:this.form_afectarStock.value?"T":"F",scondventa:this.form_acredito.value?"CRE":"CDO",cncdisponible:0,iaplicstock:this.EsNotaDeCredito(this.tipoComprobanteDeCompra(this.form_tipoDocumento))?-1:1,soperadoranulacion:"",idnctipodoc:"",idncpv:null,idnunumdoc:null,fanulacion:null,facancelacion:null};this.loader.open(),this.servicioNuevaCompra.guardarCompra(a).subscribe(a=>{var e=[],r=a;this.tabla1.data.slice(0).forEach((a,i)=>{a.idcompra=r.id,a.idnumlinea=i+1,a.idsucursal=t,a.rimpuestos=a.rimpuestos?a.rimpuestos:0,a.rimpuestos=a.rimpuestos*a.rcantidad,this.form_afectarStock.value&&(a.iddeposito=o),delete a.rtotalneto,delete a.impuesto_iva,delete a.impuesto_dgr,delete a.impuesto_interno,e.push(this.servicioNuevaCompra.guardarCompraItem(a))}),"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||this.lista_impuestos.forEach(o=>{if(o.total){var a={id:this.servicioUUID.generateUUID(),idcompra:r.id,idimpuesto:o.id,rmonto:o.total,idempresa:o.idempresa,idsucursal:t};e.push(this.servicioNuevaCompra.guardarImpuestos(a))}}),Object(u.a)(e).subscribe(t=>{this.loader.close(),this.snack.open("\xa1Compra Guardada!","OK",{duration:4e3}),this.router.navigateByUrl("purchases/purchases-by-document")},t=>{console.error(t),this.loader.close(),this.snack.open("ERROR al guardar los items o el iva","OK",{duration:4e3})})},t=>{console.error(t),this.loader.close(),this.snack.open("ERROR al guardar la compra","OK",{duration:4e3})})}verificar_iva(){this.error_iva=this.total_impuestos!=this.iva.value}calcular_total_impuestos(){for(var t=0,o=0;o<this.lista_impuestos.length;o++)t+=this.lista_impuestos[o].total;this.total_impuestos=parseFloat(t.toFixed(this.cantidaddecimales)),this.iva.setValue(this.total_impuestos)}calcular_total(t){for(var o=0,a=0,e=0;e<this.tabla1.data.length;e++)o+=this.tabla1.data[e].rtotal,a+=this.tabla1.data[e].rtotalneto;if(t){for(var r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=0;for(e=0;e<this.tabla1.data.length;e++)for(r=0;r<this.lista_impuestos.length;r++){if(this.tabla1.data[e].rporciva==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_iva;break}if(this.tabla1.data[e].rporcdgr==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_dgr;break}if(this.tabla1.data[e].rvalorimpinterno==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[e].impuesto_interno;break}}for(r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=parseFloat(this.lista_impuestos[r].total.toFixed(this.cantidaddecimales))}"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?(this.calcular_total_impuestos(),this.subtotal.setValue(parseFloat(a.toFixed(this.cantidaddecimales)))):(this.subtotal.setValue(parseFloat(o.toFixed(this.cantidaddecimales))),this.iva.setValue(0)),this.total.setValue(parseFloat((this.subtotal.value-this.form_descuento.value+this.iva.value).toFixed(this.cantidaddecimales)))}}return t.\u0275fac=function(o){return new(o||t)(g.Rb(n.a),g.Rb(c.a),g.Rb(E.a),g.Rb(S.g),g.Rb(_),g.Rb(f.a),g.Rb(d.a),g.Rb(b.a),g.Rb(s.a))},t.\u0275cmp=g.Lb({type:t,selectors:[["app-new-purchase"]],decls:144,vars:163,consts:[["fxLayout","row wrap"],["appearance","fill","fxFlex","100",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Proveedor","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["appearance","fill","fxFlex","30",1,"m-8","graphic-select-form-field"],[3,"ngModel","ngModelChange"],["fxFlex","25","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_numero_sucursal","matInput","","type","number","max","9999","min","0",3,"formControl"],["name","form_numero","matInput","","type","number","max","99999999","min","0",3,"formControl"],["fxFlex","10",1,"m-8",2,"padding-top","15px"],["name","form_acredito",3,"formControl"],["fxFlex","10","appearance","fill",1,"m-8","graphic-select-form-field"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","color","enableMeridian","disableMinute","hideTime"],["picker",""],["picker2",""],["fxFlex","15","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_caicae","matInput","","type","number","min","0",3,"formControl"],["picker3",""],["appearance","fill","fxFlex","15",1,"m-8","graphic-select-form-field"],[3,"ngModel","disabled","ngModelChange","selectionChange"],["fxFlex","10",1,"m-8",2,"padding-top","15px",3,"hidden"],["name","form_afectarStock",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","15",4,"ngIf"],["name","form_cantidad","matInput","","type","number","min","0",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","50",4,"ngIf"],["class","m-8 graphic-select-form-field","fxFlex","50","appearance","fill",4,"ngIf"],[4,"ngIf"],["name","form_precio","matInput","","type","number","min","0",3,"formControl","change","keyup"],["class","m-8 graphic-select-form-field","fxFlex","10","appearance","fill",4,"ngIf"],["mat-button","","color","primary",1,"m-8",3,"click"],[1,"p-0"],["summaryRow","false",1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","selectionType","activate"],["myTable",""],[3,"cellClass","name","flexGrow"],["ngx-datatable-cell-template",""],[3,"cellClass","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","minWidth"],["class","m-8",4,"ngIf"],["layout-gt-xs","row",4,"ngIf"],[1,"m-8"],["matInput","","type","number","min","0","name","subtotal","aria-label","Subtotal",3,"formControl"],["matInput","","type","number","min","0","name","form_descuento","aria-label","Descuentos",3,"formControl","change","keyup"],["matInput","","type","number","min","0","name","total","aria-label","Total",3,"formControl"],["class","red-400 red-400-fg p-16",4,"ngIf"],["fxFlex","100",1,"mt-16"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"disabled","routerLink"],[3,"value"],["appearance","fill","fxFlex","50",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Producto","matInput","",3,"formControl","matAutocomplete"],["auto2","matAutocomplete"],["fxFlex","50","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_servicio","matInput","","type","text","min","0",3,"formControl"],["readonly","","name","form_precio_final","matInput","","type","number","min","0",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",1,"mr-16",3,"click"],["layout-gt-xs","row"],["class","m-8",4,"ngFor","ngForOf"],["matInput","","type","number","min","0","aria-label","Impuesto",3,"ngModel","ngModelChange","change","keyup"],["matInput","","type","number","min","0","name","iva","aria-label","Impuestos",3,"formControl","change","keyup"],[1,"red-400","red-400-fg","p-16"]],template:function(t,o){if(1&t&&(g.Xb(0,"div"),g.Xb(1,"div",0),g.Xb(2,"mat-form-field",1),g.Xb(3,"mat-label"),g.Oc(4),g.kc(5,"translate"),g.Wb(),g.Sb(6,"input",2),g.Xb(7,"mat-autocomplete",3,4),g.fc("optionSelected",function(t){return o.cambiarProveedor(t.option.value)}),g.Mc(9,M,2,2,"mat-option",5),g.kc(10,"async"),g.Wb(),g.Wb(),g.Wb(),g.Xb(11,"div",6),g.Xb(12,"mat-form-field",7),g.Xb(13,"mat-label"),g.Oc(14),g.kc(15,"translate"),g.Wb(),g.Xb(16,"mat-select",8),g.fc("ngModelChange",function(t){return o.form_tipoDocumento=t}),g.Mc(17,U,2,2,"mat-option",5),g.Wb(),g.Wb(),g.Xb(18,"mat-form-field",9),g.Xb(19,"mat-label"),g.Oc(20),g.kc(21,"translate"),g.Wb(),g.Sb(22,"input",10),g.Wb(),g.Xb(23,"mat-form-field",9),g.Xb(24,"mat-label"),g.Oc(25),g.kc(26,"translate"),g.Wb(),g.Sb(27,"input",11),g.Wb(),g.Xb(28,"div",12),g.Xb(29,"mat-checkbox",13),g.Oc(30),g.kc(31,"translate"),g.Wb(),g.Wb(),g.Wb(),g.Xb(32,"div",6),g.Xb(33,"mat-form-field",14),g.Xb(34,"mat-label"),g.Oc(35),g.kc(36,"translate"),g.Wb(),g.Sb(37,"input",15),g.Sb(38,"mat-datepicker-toggle",16),g.Sb(39,"ngx-mat-datetime-picker",17,18),g.Wb(),g.Xb(41,"mat-form-field",14),g.Xb(42,"mat-label"),g.Oc(43),g.kc(44,"translate"),g.Wb(),g.Sb(45,"input",15),g.Sb(46,"mat-datepicker-toggle",16),g.Sb(47,"ngx-mat-datetime-picker",17,19),g.Wb(),g.Xb(49,"mat-form-field",20),g.Xb(50,"mat-label"),g.Oc(51),g.kc(52,"translate"),g.Wb(),g.Sb(53,"input",21),g.Wb(),g.Xb(54,"mat-form-field",14),g.Xb(55,"mat-label"),g.Oc(56),g.kc(57,"translate"),g.Wb(),g.Sb(58,"input",15),g.Sb(59,"mat-datepicker-toggle",16),g.Sb(60,"ngx-mat-datetime-picker",17,22),g.Wb(),g.Xb(62,"mat-form-field",23),g.Xb(63,"mat-label"),g.Oc(64),g.kc(65,"translate"),g.Wb(),g.Xb(66,"mat-select",24),g.fc("ngModelChange",function(t){return o.form_tipoFactura=t})("selectionChange",function(){return o.cambiarTiposFactura()}),g.Mc(67,T,2,2,"mat-option",5),g.Wb(),g.Wb(),g.Xb(68,"div",25),g.Xb(69,"mat-checkbox",26),g.Oc(70),g.kc(71,"translate"),g.Wb(),g.Wb(),g.Mc(72,V,6,5,"mat-form-field",27),g.Wb(),g.Wb(),g.Xb(73,"div",6),g.Xb(74,"mat-form-field",14),g.Xb(75,"mat-label"),g.Oc(76),g.kc(77,"translate"),g.Wb(),g.Sb(78,"input",28),g.Wb(),g.Mc(79,L,9,9,"mat-form-field",29),g.Mc(80,G,5,4,"mat-form-field",30),g.Xb(81,"mat-form-field",14),g.Mc(82,B,3,3,"mat-label",31),g.Mc(83,q,3,3,"mat-label",31),g.Xb(84,"input",32),g.fc("change",function(){return o.calcular_precio_final()})("keyup",function(){return o.calcular_precio_final()}),g.Wb(),g.Wb(),g.Mc(85,Q,5,4,"mat-form-field",33),g.Xb(86,"button",34),g.fc("click",function(){return o.guardarItem()}),g.Xb(87,"mat-icon"),g.Oc(88,"save"),g.Wb(),g.Oc(89),g.kc(90,"translate"),g.Wb(),g.Wb(),g.Xb(91,"mat-card",35),g.Xb(92,"mat-card-content",35),g.Xb(93,"ngx-datatable",36,37),g.fc("activate",function(t){return o.tabla1OnActivate(t)}),g.Xb(95,"ngx-datatable-column",38),g.kc(96,"translate"),g.Mc(97,$,2,3,"ng-template",39),g.Wb(),g.Xb(98,"ngx-datatable-column",38),g.kc(99,"translate"),g.Mc(100,Y,1,1,"ng-template",39),g.Wb(),g.Mc(101,K,3,5,"ngx-datatable-column",40),g.Mc(102,Z,3,5,"ngx-datatable-column",40),g.Mc(103,ot,3,5,"ngx-datatable-column",40),g.Mc(104,et,3,5,"ngx-datatable-column",40),g.Xb(105,"ngx-datatable-column",41),g.kc(106,"translate"),g.Mc(107,rt,6,0,"ng-template",39),g.Wb(),g.Wb(),g.Wb(),g.Wb(),g.Mc(108,it,3,3,"h4",42),g.Mc(109,ct,2,1,"div",43),g.Xb(110,"h4",44),g.Oc(111),g.kc(112,"translate"),g.Wb(),g.Xb(113,"div",6),g.Xb(114,"mat-form-field",44),g.Xb(115,"mat-label"),g.Oc(116),g.kc(117,"translate"),g.Wb(),g.Sb(118,"input",45),g.Wb(),g.Xb(119,"mat-form-field",44),g.Xb(120,"mat-label"),g.Oc(121),g.kc(122,"translate"),g.Wb(),g.Xb(123,"input",46),g.fc("change",function(){return o.calcular_total(!0)})("keyup",function(){return o.calcular_total(!0)}),g.Wb(),g.Wb(),g.Mc(124,nt,5,4,"mat-form-field",42),g.Xb(125,"mat-form-field",44),g.Xb(126,"mat-label"),g.Oc(127),g.kc(128,"translate"),g.Wb(),g.Sb(129,"input",47),g.Wb(),g.Wb(),g.Mc(130,lt,6,6,"div",48),g.Xb(131,"div",6),g.Xb(132,"div",49),g.Xb(133,"button",50),g.fc("click",function(){return o.formModal()}),g.Xb(134,"mat-icon"),g.Oc(135,"save"),g.Wb(),g.Oc(136),g.kc(137,"translate"),g.Wb(),g.Sb(138,"span",51),g.Xb(139,"button",52),g.Xb(140,"mat-icon"),g.Oc(141,"cancel"),g.Wb(),g.Oc(142),g.kc(143,"translate"),g.Wb(),g.Wb(),g.Wb()),2&t){const t=g.Ac(8),a=g.Ac(40),e=g.Ac(48),r=g.Ac(61);g.Eb(4),g.Pc(g.lc(5,113,"NEWPURCHASES.SUPPLIER")),g.Eb(2),g.pc("formControl",o.editorProveedor)("matAutocomplete",t),g.Eb(1),g.pc("displayWith",o.displayFnProveedores),g.Eb(2),g.pc("ngForOf",g.lc(10,115,o.filteredProveedores)),g.Eb(5),g.Pc(g.lc(15,117,"NEWPURCHASES.DOCUMENT")),g.Eb(2),g.pc("ngModel",o.form_tipoDocumento),g.Eb(1),g.pc("ngForOf",o.tiposDocumento),g.Eb(3),g.Pc(g.lc(21,119,"NEWPURCHASES.NUMBER(FIRST4DIGITS)")),g.Eb(2),g.pc("formControl",o.form_numero_sucursal),g.Eb(3),g.Pc(g.lc(26,121,"NEWPURCHASES.NUMBER(LAST8DIGITS)")),g.Eb(2),g.pc("formControl",o.form_numero),g.Eb(2),g.pc("formControl",o.form_acredito),g.Eb(1),g.Pc(g.lc(31,123,"NEWPURCHASES.ONCREDIT")),g.Eb(5),g.Pc(g.lc(36,125,"NEWPURCHASES.DATE")),g.Eb(2),g.pc("ngxMatDatetimePicker",a)("formControl",o.fecha),g.Eb(1),g.pc("for",a),g.Eb(1),g.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),g.Eb(4),g.Pc(g.lc(44,127,"NEWPURCHASES.ACCOUNTINGDATE")),g.Eb(2),g.pc("ngxMatDatetimePicker",e)("formControl",o.fechacontable),g.Eb(1),g.pc("for",e),g.Eb(1),g.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),g.Eb(4),g.Pc(g.lc(52,129,"NEWPURCHASES.CAI/CAE")),g.Eb(2),g.pc("formControl",o.form_caicae),g.Eb(3),g.Pc(g.lc(57,131,"NEWPURCHASES.CAI/CAEDATE")),g.Eb(2),g.pc("ngxMatDatetimePicker",r)("formControl",o.fechacaicae),g.Eb(1),g.pc("for",r),g.Eb(1),g.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),g.Eb(4),g.Pc(g.lc(65,133,"NEWPURCHASES.INVOICETYPE")),g.Eb(2),g.pc("ngModel",o.form_tipoFactura)("disabled",o.tabla1.data.length>0||o.tipoFacturaBloqueado),g.Eb(1),g.pc("ngForOf",o.tiposFactura),g.Eb(1),g.pc("hidden",o.form_tipoFactura!=o.tiposFactura[0]),g.Eb(1),g.pc("formControl",o.form_afectarStock),g.Eb(1),g.Pc(g.lc(71,135,"NEWPURCHASES.AFFECTSTOCK")),g.Eb(2),g.pc("ngIf",o.form_tipoFactura==o.tiposFactura[0]&&o.form_afectarStock.value),g.Eb(4),g.Pc(g.lc(77,137,"NEWPURCHASES.QUANTITY")),g.Eb(2),g.pc("formControl",o.form_cantidad),g.Eb(1),g.pc("ngIf",o.form_tipoFactura==o.tiposFactura[0]),g.Eb(1),g.pc("ngIf",o.form_tipoFactura==o.tiposFactura[1]),g.Eb(2),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),g.Eb(1),g.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),g.Eb(1),g.pc("formControl",o.form_precio),g.Eb(1),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),g.Eb(4),g.Qc("",g.lc(90,139,"NEWPURCHASES.SAVE")," "),g.Eb(2),g.pc("@animate",g.vc(160,mt,g.uc(159,ut))),g.Eb(2),g.pc("columnMode","flex")("headerHeight",50)("footerHeight",50)("rowHeight",o.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",o.tabla1.rows)("selectionType","single"),g.Eb(2),g.qc("name",g.lc(96,141,"NEWPURCHASES.QUANTITY")),g.pc("cellClass",o.getCellClass)("flexGrow",1),g.Eb(3),g.qc("name",g.lc(99,143,"NEWPURCHASES.CONCEPT")),g.pc("cellClass",o.getCellClass)("flexGrow",2),g.Eb(3),g.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),g.Eb(1),g.pc("ngIf","Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),g.Eb(1),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),g.Eb(1),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"!=o.form_tipoDocumento),g.Eb(1),g.qc("name",g.lc(106,145,"NEWPURCHASES.ACTIONS")),g.pc("flexGrow",1)("minWidth",100),g.Eb(3),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),g.Eb(1),g.pc("ngIf",("Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento)&&0!=o.lista_impuestos.length),g.Eb(2),g.Pc(g.lc(112,147,"NEWPURCHASES.RESUME")),g.Eb(5),g.Pc(g.lc(117,149,"NEWPURCHASES.SUBTOTAL")),g.Eb(2),g.pc("formControl",o.subtotal),g.Eb(3),g.Pc(g.lc(122,151,"NEWPURCHASES.DISCOUNTS")),g.Eb(2),g.pc("formControl",o.form_descuento),g.Eb(1),g.pc("ngIf","Factura de Compra A"==o.form_tipoDocumento||"Nota de Cr\xe9dito A"==o.form_tipoDocumento),g.Eb(3),g.Pc(g.lc(128,153,"NEWPURCHASES.TOTAL")),g.Eb(2),g.pc("formControl",o.total),g.Eb(1),g.pc("ngIf",!o.form_afectarStock.value),g.Eb(3),g.pc("disabled",o.guardando),g.Eb(3),g.Qc("",g.lc(137,155,"NEWPURCHASES.SAVE")," "),g.Eb(3),g.pc("disabled",o.guardando)("routerLink",g.uc(162,pt)),g.Eb(3),g.Qc("",g.lc(143,157,"NEWPURCHASES.CANCEL")," ")}},directives:[F.c,D.c,F.a,D.f,P.b,r.c,W.c,r.o,r.f,W.a,e.n,A.a,r.r,r.s,O.a,w.a,R.h,D.h,w.b,e.o,I.b,k.a,N.a,N.b,x.d,x.b,x.a,S.h,X.n],pipes:[y.c,e.b,e.g,e.d],styles:[""],data:{animation:[i.a]}}),t})(),data:{title:"NUEVA COMPRA"}}];var ht=a("u9T3"),ft=a("f44v"),bt=a("iELJ"),Ct=a("jMqV"),gt=a("M9ds"),vt=a("ZFy/"),_t=a("PCNd"),Et=a("BxcV"),St=a("OaSA");let Ft=(()=>{class t{}return t.\u0275mod=g.Pb({type:t}),t.\u0275inj=g.Ob({factory:function(o){return new(o||t)},imports:[[e.c,r.t,ht.a,x.f,P.c,P.c,N.c,P.c,I.c,ft.a,P.c,vt.b,bt.f,E.b,Ct.b,gt.c,A.b,k.b,y.b,_t.a,W.b,Et.a,r.j,R.g,w.c,w.e,w.d,O.b,St.a,S.k.forChild(dt)]]}),t})()},CHRX:function(t,o,a){"use strict";a.d(o,"a",function(){return r});var e=a("wd/R");class r{constructor(){this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.summaryRow=!0,this.emptyRow=!0,this.customFilter=function(t){return t}}static prepararFiltroAPI(t){var o="";for(var a in t)t[a].search&&(o+="number"==typeof t[a].search?`{"${a}":${t[a].search}},`:t[a].exact?`{"${a}":"${t[a].search}"},`:`{"${a}":{"ilike":"%${t[a].search}%"}},`);return o}setGroup(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}setData(t){this.data=t,this.sortData()}sortData(){this.data.sort((t,o)=>{if(t[this.groupField]==o[this.groupField]){if(this.secondarySort){if(null==t[this.secondarySort])return 1;if(null==o[this.secondarySort])return-1;if(t[this.secondarySort]>o[this.secondarySort])return 1*("desc"===this.sortDir?-1:1);if(t[this.secondarySort]<o[this.secondarySort])return-1*("desc"===this.sortDir?-1:1)}}else{if(null==t[this.groupField])return 1;if(null==o[this.groupField])return-1;if(t[this.groupField]>o[this.groupField])return 1;if(t[this.groupField]<o[this.groupField])return-1}return 0}),this.filterRows()}filterRows(){var t=[];t=this.data.filter(t=>{for(var o in this.filter){if(this.filter[o]&&null==t[o])return!1;switch(typeof t[o]){case"number":if(this.filter[o]&&Math.trunc(t[o]).toString()!==Math.trunc(this.filter[o]).toString())return!1;break;case"string":if("f"==o.charAt(0).toLowerCase()&&e(t[o]).isValid){if(-1==e(t[o]).format("DD/MM/YYYY HH:mm:ss").indexOf(this.filter[o]))return!1;break}if(-1==t[o].toLowerCase().indexOf(this.filter[o].toLowerCase()))return!1}}return!0}),t=this.customFilter(t);var o={};this.groupField?o[this.groupField]=t.length.toString():o.count=t.length.toString(),this.sum.forEach(t=>o[t]=0);for(var a=0;a<t.length;a++)this.sum.forEach(e=>o[e]+=t[a][e]);if(o.isGroup=!0,this.footer=o,this.groupField){var r=[];t.forEach(t=>{-1==r.indexOf(t[this.groupField])&&r.push(t[this.groupField])}),r=r.map(t=>({name:t,count:1}));var i=[],s=!0,c=0,n=null,l=()=>{n&&(n[this.groupField]+=" ("+r[c-1].count.toString()+")")};for(a=0;a<t.length;a++){if(s&&t[a][this.groupField]==r[c].name){l();var u="+";this.groups[r[c].name]&&(u="-"),n={[this.groupField]:u+" "+r[c].name,isGroup:!0,name:r[c].name},this.sum.forEach(t=>n[t]=0),i.push(n),s=++c<r.length}else r[c-1].count++;this.sum.forEach(o=>n[o]+=t[a][o]),i.push(t[a])}l(),t=null,i=i.filter(t=>!!t.isGroup||!!this.groups[t[this.groupField]]||void 0),this.rows=i}else this.rows=t;this.summaryRow&&this.rows.push(this.footer),0==this.rows.length&&this.emptyRow&&this.rows.push({})}updateFilter(t,o){if(t&&o){var a=t.target.value;t instanceof MouseEvent&&(a=""),this.filter[o]=a,this.filterRows()}return!0}updateFilterBoolean(t,o){return this.filter[o]=t,this.filterRows(),!0}}},GmJt:function(t,o,a){"use strict";a.d(o,"a",function(){return i});var e=a("GS7A");const r=Object(e.g)([Object(e.l)({opacity:"{{opacity}}",transform:"scale({{scale}}) translate3d({{x}}, {{y}}, {{z}})"}),Object(e.e)("{{duration}} {{delay}} cubic-bezier(0.0, 0.0, 0.2, 1)",Object(e.l)("*"))],{params:{duration:"200ms",delay:"0ms",opacity:"0",scale:"1",x:"0",y:"0",z:"0"}}),i=[Object(e.n)("animate",[Object(e.m)("void => *",[Object(e.o)(r)])]),Object(e.n)("fadeInOut",[Object(e.k)("0",Object(e.l)({opacity:0,display:"none"})),Object(e.k)("1",Object(e.l)({opacity:1,display:"block"})),Object(e.m)("0 => 1",Object(e.e)("300ms")),Object(e.m)("1 => 0",Object(e.e)("300ms"))])]}}]);