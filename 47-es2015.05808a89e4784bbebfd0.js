(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{CgJX:function(t,e,o){"use strict";o.r(e),o.d(e,"PurchasesPlanModule",function(){return K});var n=o("SVse"),a=o("s7LF"),c=o("GmJt"),r=o("3sEA"),i=o("bPAe"),l=o("CHRX"),s=o("7M/S"),u=o("AytR"),b=o("8Y7J"),p=o("IheW");let f=(()=>{class t{constructor(t){this.http=t}obtenerDepositos(){return this.http.get(encodeURI(u.a.apiURL+'Depositos?filter={"where":{"deletedon":{"eq":null}}}'))}obtenerStock(t){return this.http.get(encodeURI(`${u.a.apiURL}Compras/PlanDeCompras?iddeposito=${t}`))}obtenerHistorialProducto(t,e){return this.http.get(encodeURI(`${u.a.apiURL}Productos/GetHistorialStock?idProducto=${e}&idDeposito=${t}`))}}return t.\u0275fac=function(e){return new(e||t)(b.bc(p.c))},t.\u0275prov=b.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var d=o("iELJ"),g=o("zHaW"),m=o("PDjf"),h=o("VDRc"),w=o("Q2Ze"),v=o("ZTz/"),E=o("Dxy4"),S=o("Tj54"),x=o("w9WL"),k=o("UhP/"),P=o("jMqV"),R=o("TSSN");function A(t,e){if(1&t&&(b.Xb(0,"mat-option",17),b.Oc(1),b.Wb()),2&t){const t=e.$implicit;b.pc("value",t),b.Eb(1),b.Pc(null==t?null:t.sdescripcion)}}function y(t,e){if(1&t&&(b.Xb(0,"div",1),b.Xb(1,"mat-slide-toggle",18),b.Oc(2),b.kc(3,"translate"),b.Wb(),b.Xb(4,"mat-slide-toggle",18),b.Oc(5),b.kc(6,"translate"),b.Wb(),b.Wb()),2&t){const t=b.jc();b.Eb(1),b.pc("formControl",t.toggle),b.Eb(1),b.Pc(b.lc(3,4,"PURCHASESPLAN.ONLYACTIVES")),b.Eb(2),b.pc("formControl",t.toggleStock),b.Eb(1),b.Qc("",b.lc(6,6,"PURCHASESPLAN.STOCKONLYBELOWMINIMUM")," ")}}function L(t,e){if(1&t&&b.Oc(0),2&t){const t=e.row;b.Qc(" ",null==t?null:t.sCodProducto," ")}}function O(t,e){if(1&t&&b.Oc(0),2&t){const t=e.row;b.Qc(" ",null==t?null:t.sProducto," ")}}function C(t,e){if(1&t&&b.Oc(0),2&t){const t=e.row;b.Qc(" ",null==t?null:t.sFamilia," ")}}function M(t,e){if(1&t&&b.Oc(0),2&t){const t=e.row;b.Qc(" ",null==t?null:t.Proveedores," ")}}function U(t,e){if(1&t&&(b.Oc(0),b.kc(1,"number")),2&t){const t=e.row;b.Qc(" ",b.lc(1,1,null==t?null:t.rStock)," ")}}function H(t,e){if(1&t&&(b.Oc(0),b.kc(1,"number")),2&t){const t=e.row;b.Qc(" ",b.lc(1,1,null==t?null:t.rStockMinimo)," ")}}function W(t,e){if(1&t){const t=b.Yb();b.Xb(0,"button",5),b.fc("click",function(){return b.Dc(t),b.jc(3).export()}),b.Xb(1,"mat-icon"),b.Oc(2,"save_alt"),b.Wb(),b.Oc(3),b.kc(4,"translate"),b.Wb()}2&t&&(b.Eb(3),b.Qc("",b.lc(4,1,"PURCHASESPLAN.EXCEL")," "))}function X(t,e){if(1&t&&(b.Xb(0,"div",20),b.Mc(1,W,5,3,"button",21),b.Wb()),2&t){const t=b.jc(2);b.Eb(1),b.pc("ngIf",t.tabla1.data.length>0)}}function T(t,e){1&t&&(b.Xb(0,"ngx-datatable-footer"),b.Mc(1,X,2,1,"ng-template",19),b.Wb())}const I=function(){return{y:"50px",delay:"300ms"}},N=function(t){return{value:"*",params:t}},D=[{path:"",component:(()=>{class t{constructor(t,e,o,n,c,r){this.dialog=t,this.servicioStock=e,this.servicioExportarExcel=o,this.loader=n,this.snack=c,this.servicioPermisos=r,this.toggle=new a.e(!0,[]),this.toggleValue=!0,this.toggleStock=new a.e(!1,[]),this.toggleStockValue=!1,this.toggle.valueChanges.subscribe(t=>{this.toggleValue=t,this.tabla1.updateFilterBoolean(this.toggleValue?"T":"","bActivo")}),this.toggleStock.valueChanges.subscribe(t=>{this.toggleStockValue=t,this.tabla1.filterRows()})}ngOnInit(){this.tabla1=new l.a,this.tabla1.groupField="",this.tabla1.secondarySort="sProducto",this.tabla1.sum=[],this.loader.open(),this.servicioStock.obtenerDepositos().subscribe(t=>{this.depositos=t,this.depositos.sort((t,e)=>t.sdescripcion>e.sdescripcion?1:t.sdescripcion<e.sdescripcion?-1:0),this.depositoActual=this.depositos[0],this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}refresh(){this.loader.open(),this.servicioStock.obtenerStock(this.depositoActual.id).subscribe(t=>{this.tabla1.setData(t.filter(()=>!0)),console.log(this.tabla1),this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}seleccionarDeposito(t){this.depositoActual=t}getRowHeight(t){return 50}export(){var t=this.tabla1.data.map(t=>({Dep\u00f3sito:t.sDeposito,C\u00f3digo:t.sCodProducto,Nombre:t.sProducto,Familia:t.sFamilia,Stock:t.rStock}));this.servicioExportarExcel.exportExcel(t,"stock","stock")}onSort(t){const e=t.sorts[0];this.tabla1.secondarySort=e.prop,this.tabla1.sortDir=e.dir,this.tabla1.sortData()}openPopUp(t={}){}}return t.\u0275fac=function(e){return new(e||t)(b.Rb(d.b),b.Rb(f),b.Rb(i.a),b.Rb(r.a),b.Rb(g.a),b.Rb(s.a))},t.\u0275cmp=b.Lb({type:t,selectors:[["app-purchases-plan"]],decls:37,vars:48,consts:[[1,"p-0"],["fxLayout","row wrap","fxLayoutAlign","end center",1,"p-8"],["appearance","fill","fxFlex","100","fxFlex.gt-xs","25","fxFlex.gt-sm","16",1,"m-8"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"m-8",3,"click"],["class","p-8","fxLayout","row wrap","fxLayoutAlign","end center",4,"ngIf"],[1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],["prop","sCodProducto",3,"name","flexGrow"],["ngx-datatable-cell-template",""],["prop","sProducto",3,"name","flexGrow"],["prop","sFamilia",3,"name","flexGrow"],["prop","Proveedores",3,"name","flexGrow"],["prop","rStock",3,"name","flexGrow"],["prop","rStockMinimo",3,"name","flexGrow"],[4,"ngIf"],[3,"value"],[1,"m-8",3,"formControl"],["ngx-datatable-footer-template",""],[1,"p-8",2,"margin-left","auto"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"]],template:function(t,e){1&t&&(b.Xb(0,"mat-card",0),b.Xb(1,"div",1),b.Xb(2,"mat-form-field",2),b.Xb(3,"mat-label"),b.Oc(4),b.kc(5,"translate"),b.Wb(),b.Xb(6,"mat-select",3),b.fc("selectionChange",function(t){return e.seleccionarDeposito(t.value)})("valueChange",function(t){return e.depositoActual=t}),b.Mc(7,A,2,2,"mat-option",4),b.Wb(),b.Wb(),b.Xb(8,"button",5),b.fc("click",function(){return e.refresh()}),b.Xb(9,"mat-icon"),b.Oc(10,"search"),b.Wb(),b.Oc(11),b.kc(12,"translate"),b.Wb(),b.Wb(),b.Mc(13,y,7,8,"div",6),b.Wb(),b.Xb(14,"mat-card",0),b.Xb(15,"mat-card-content",0),b.Xb(16,"ngx-datatable",7,8),b.fc("sort",function(t){return e.onSort(t)}),b.Xb(18,"ngx-datatable-column",9),b.kc(19,"translate"),b.Mc(20,L,1,1,"ng-template",10),b.Wb(),b.Xb(21,"ngx-datatable-column",11),b.kc(22,"translate"),b.Mc(23,O,1,1,"ng-template",10),b.Wb(),b.Xb(24,"ngx-datatable-column",12),b.kc(25,"translate"),b.Mc(26,C,1,1,"ng-template",10),b.Wb(),b.Xb(27,"ngx-datatable-column",13),b.kc(28,"translate"),b.Mc(29,M,1,1,"ng-template",10),b.Wb(),b.Xb(30,"ngx-datatable-column",14),b.kc(31,"translate"),b.Mc(32,U,2,3,"ng-template",10),b.Wb(),b.Xb(33,"ngx-datatable-column",15),b.kc(34,"translate"),b.Mc(35,H,2,3,"ng-template",10),b.Wb(),b.Mc(36,T,2,0,"ngx-datatable-footer",16),b.Wb(),b.Wb(),b.Wb()),2&t&&(b.Eb(4),b.Pc(b.lc(5,29,"PURCHASESPLAN.DEPOSITS")),b.Eb(2),b.pc("value",e.depositoActual),b.Eb(1),b.pc("ngForOf",e.depositos),b.Eb(4),b.Qc("",b.lc(12,31,"PURCHASESPLAN.SHOW")," "),b.Eb(2),b.pc("ngIf",e.tabla1.data.length>0),b.Eb(1),b.pc("@animate",b.vc(46,N,b.uc(45,I))),b.Eb(2),b.pc("columnMode","flex")("headerHeight",50)("footerHeight",100)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!0)("rows",e.tabla1.rows)("summaryRow",!0)("externalSorting",!0)("selectionType","single"),b.Eb(2),b.qc("name",b.lc(19,33,"PURCHASESPLAN.CODE")),b.pc("flexGrow",1),b.Eb(3),b.qc("name",b.lc(22,35,"PURCHASESPLAN.NAME")),b.pc("flexGrow",2),b.Eb(3),b.qc("name",b.lc(25,37,"PURCHASESPLAN.FAMILY")),b.pc("flexGrow",1),b.Eb(3),b.qc("name",b.lc(28,39,"PURCHASESPLAN.SUPPLIER")),b.pc("flexGrow",1),b.Eb(3),b.qc("name",b.lc(31,41,"PURCHASESPLAN.STOCK")),b.pc("flexGrow",1),b.Eb(3),b.qc("name",b.lc(34,43,"PURCHASESPLAN.MINIMUMSTOCK")),b.pc("flexGrow",1),b.Eb(3),b.pc("ngIf",e.tabla1.data.length>0))},directives:[m.a,h.c,h.b,w.c,h.a,w.f,v.a,n.n,E.b,S.a,n.o,m.b,x.d,x.b,x.a,k.n,P.a,a.o,a.f,x.e,x.c],pipes:[R.c,n.g],styles:[""],data:{animation:[c.a]}}),t})(),data:{title:"PLAN DE COMPRAS"}}];var F=o("iInd"),j=o("u9T3"),G=o("f44v"),V=o("TN/R"),q=o("e6WT"),Q=o("M9ds"),B=o("ZFy/"),J=o("PCNd");let K=(()=>{class t{}return t.\u0275mod=b.Pb({type:t}),t.\u0275inj=b.Ob({factory:function(e){return new(e||t)},imports:[[n.c,a.t,j.a,x.f,q.c,q.c,m.c,q.c,E.c,G.a,q.c,B.b,d.f,g.b,P.b,Q.c,v.b,S.b,R.b,J.a,V.g,F.k.forChild(D)]]}),t})()},Iab2:function(t,e,o){var n,a;void 0===(a="function"==typeof(n=function(){"use strict";function e(t,e,o){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){r(n.response,e,o)},n.onerror=function(){console.error("could not download file")},n.send()}function o(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function n(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(e){var o=document.createEvent("MouseEvents");o.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(o)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,c=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),r=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(t,c,r){var i=a.URL||a.webkitURL,l=document.createElement("a");l.download=c=c||t.name||"download",l.rel="noopener","string"==typeof t?(l.href=t,l.origin===location.origin?n(l):o(l.href)?e(t,c,r):n(l,l.target="_blank")):(l.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(l.href)},4e4),setTimeout(function(){n(l)},0))}:"msSaveOrOpenBlob"in navigator?function(t,a,c){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,e){return void 0===e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,c),a);else if(o(t))e(t,a,c);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){n(r)})}}:function(t,o,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return e(t,o,n);var i="application/octet-stream"===t.type,l=/constructor/i.test(a.HTMLElement)||a.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&l||c)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},u.readAsDataURL(t)}else{var b=a.URL||a.webkitURL,p=b.createObjectURL(t);r?r.location=p:location.href=p,r=null,setTimeout(function(){b.revokeObjectURL(p)},4e4)}});a.saveAs=r.saveAs=r,t.exports=r})?n.apply(e,[]):n)||(t.exports=a)},bPAe:function(t,e,o){"use strict";o.d(e,"a",function(){return r});var n=o("Iab2"),a=o("EUZL"),c=o("8Y7J");let r=(()=>{class t{constructor(){this.fileType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",this.fileExtension=".xlsx"}exportExcel(t,e,o){const n=a.utils.json_to_sheet(t),c=a.write({Sheets:{[o]:n},SheetNames:[o]},{bookType:"xlsx",type:"array"});this.saveExcelFile(c,e)}saveExcelFile(t,e){const o=new Blob([t],{type:this.fileType});n.saveAs(o,e+this.fileExtension)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);