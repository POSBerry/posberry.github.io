!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,a){if(!t)return;if("string"==typeof t)return e(t,a);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e(t,a)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,o=new Array(e);a<e;a++)o[a]=t[a];return o}function a(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,a){return e&&r(t.prototype,e),a&&r(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"2Doj":function(e,r,c){"use strict";c.r(r),c.d(r,"NewPurchaseModule",function(){return Ot});var n,s=c("SVse"),l=c("s7LF"),u=c("GmJt"),p=c("3kSh"),m=c("3sEA"),d=c("vpPe"),f=c("wd/R"),b=c("cp0P"),h=c("JX91"),v=c("lJxs"),C=c("Sp5M"),g=c("CHRX"),_=c("qA6C"),E=c("UVsP"),S=c("AytR"),y=c("8Y7J"),k=c("IheW"),F=((n=function(){function t(e){o(this,t),this.http=e}return i(t,[{key:"obtenerImpuestos",value:function(){return this.http.get(S.a.apiURL+'Impuestos?filter={"where":{"deletedon":{"eq":null}}}')}},{key:"obtenerSucursales",value:function(){return this.http.get(S.a.apiURL+'Sucursales?filter={"where":{"deletedon":{"eq":null}},"order":"sdescripcion ASC"}')}},{key:"obtenerDepositoXSucursal",value:function(t){return this.http.get("".concat(S.a.apiURL,"Sucursales/DepositoXSucursal?idsucursal=").concat(t))}},{key:"guardarCompra",value:function(t){return this.http.post(S.a.apiURL+"Compras",t)}},{key:"guardarCompraItem",value:function(t){return this.http.post(S.a.apiURL+"ComprasItems",t)}},{key:"guardarImpuestos",value:function(t){return this.http.post(S.a.apiURL+"ImpuestosXCompra",t)}}]),t}()).\u0275fac=function(t){return new(t||n)(y.bc(k.c))},n.\u0275prov=y.Nb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),D=c("zHaW"),A=c("iInd"),P=c("VDRc"),x=c("Q2Ze"),O=c("e6WT"),W=c("vrAh"),w=c("ZTz/"),I=c("pMoy"),R=c("n1FK"),N=c("TN/R"),X=c("Dxy4"),M=c("Tj54"),U=c("PDjf"),T=c("w9WL"),H=c("UhP/"),j=c("TSSN");function V(t,e){if(1&t&&(y.Xb(0,"mat-option",53),y.Oc(1),y.Wb()),2&t){var a=e.$implicit;y.pc("value",a),y.Eb(1),y.Qc(" ",null==a?null:a.srazonsocial," ")}}function L(t,e){if(1&t&&(y.Xb(0,"mat-option",53),y.Oc(1),y.Wb()),2&t){var a=e.$implicit;y.pc("value",a),y.Eb(1),y.Qc(" ",a," ")}}function G(t,e){if(1&t&&(y.Xb(0,"mat-option",53),y.Oc(1),y.Wb()),2&t){var a=e.$implicit;y.pc("value",a),y.Eb(1),y.Qc(" ",a," ")}}function B(t,e){if(1&t&&(y.Xb(0,"mat-option",53),y.Oc(1),y.Wb()),2&t){var a=e.$implicit;y.pc("value",a),y.Eb(1),y.Qc(" ",a.sdescripcion," ")}}function q(t,e){if(1&t){var a=y.Yb();y.Xb(0,"mat-form-field",23),y.Xb(1,"mat-label"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Xb(4,"mat-select",8),y.fc("ngModelChange",function(t){return y.Dc(a),y.jc().form_sucursal=t}),y.Mc(5,B,2,2,"mat-option",5),y.Wb(),y.Wb()}if(2&t){var o=y.jc();y.Eb(2),y.Pc(y.lc(3,3,"NEWPURCHASES.BRANCHDEPOSIT")),y.Eb(2),y.pc("ngModel",o.form_sucursal),y.Eb(1),y.pc("ngForOf",o.sucursales_data)}}function Q(t,e){if(1&t&&(y.Xb(0,"mat-option",53),y.Oc(1),y.Wb()),2&t){var a=e.$implicit;y.pc("value",a),y.Eb(1),y.Rc(" ",null==a?null:a.scodproducto," - ",null==a?null:a.snombre," ")}}function Y(t,e){if(1&t){var a=y.Yb();y.Xb(0,"mat-form-field",54),y.Xb(1,"mat-label"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Sb(4,"input",55),y.Xb(5,"mat-autocomplete",3,56),y.fc("optionSelected",function(t){return y.Dc(a),y.jc().selectedItemChangeProducto(t.option.value)}),y.Mc(7,Q,2,3,"mat-option",5),y.kc(8,"async"),y.Wb(),y.Wb()}if(2&t){var o=y.Ac(6),r=y.jc();y.Eb(2),y.Pc(y.lc(3,5,"NEWPURCHASES.PRODUCT")),y.Eb(2),y.pc("formControl",r.editorProducto)("matAutocomplete",o),y.Eb(1),y.pc("displayWith",r.displayFnProductos),y.Eb(2),y.pc("ngForOf",y.lc(8,7,r.filteredProductos))}}function z(t,e){if(1&t&&(y.Xb(0,"mat-form-field",57),y.Xb(1,"mat-label"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Sb(4,"input",58),y.Wb()),2&t){var a=y.jc();y.Eb(2),y.Pc(y.lc(3,2,"NEWPURCHASES.DETAIL")),y.Eb(2),y.pc("formControl",a.form_servicio)}}function K(t,e){1&t&&(y.Xb(0,"mat-label"),y.Oc(1),y.kc(2,"translate"),y.Wb()),2&t&&(y.Eb(1),y.Pc(y.lc(2,1,"NEWPURCHASES.NETPRICE")))}function J(t,e){1&t&&(y.Xb(0,"mat-label"),y.Oc(1),y.kc(2,"translate"),y.Wb()),2&t&&(y.Eb(1),y.Pc(y.lc(2,1,"NEWPURCHASES.UNITPRICE")))}function $(t,e){if(1&t&&(y.Xb(0,"mat-form-field",14),y.Xb(1,"mat-label"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Sb(4,"input",59),y.Wb()),2&t){var a=y.jc();y.Eb(2),y.Pc(y.lc(3,2,"NEWPURCHASES.FINALPRICE")),y.Eb(2),y.pc("formControl",a.form_precio_final)}}function Z(t,e){if(1&t&&(y.Oc(0),y.kc(1,"number")),2&t){var a=e.row;y.Qc(" ",y.lc(1,1,null==a?null:a.rcantidad)," ")}}function tt(t,e){if(1&t&&y.Oc(0),2&t){var a=e.row;y.Qc(" ",null==a?null:a.sconcepto," ")}}function et(t,e){if(1&t&&(y.Oc(0),y.kc(1,"currency")),2&t){var a=e.row;y.Qc(" ",y.lc(1,1,null==a?null:a.rpreciou)," ")}}function at(t,e){if(1&t&&(y.Xb(0,"ngx-datatable-column",38),y.kc(1,"translate"),y.Mc(2,et,2,3,"ng-template",39),y.Wb()),2&t){var a=y.jc();y.qc("name",y.lc(1,3,"NEWPURCHASES.PRICE")),y.pc("cellClass",a.getCellClass)("flexGrow",1)}}function ot(t,e){if(1&t&&(y.Oc(0),y.kc(1,"currency")),2&t){var a=e.row;y.Qc(" ",y.lc(1,1,null==a?null:a.rtotal)," ")}}function rt(t,e){if(1&t&&(y.Xb(0,"ngx-datatable-column",38),y.kc(1,"translate"),y.Mc(2,ot,2,3,"ng-template",39),y.Wb()),2&t){var a=y.jc();y.qc("name",y.lc(1,3,"NEWPURCHASES.TOTAL")),y.pc("cellClass",a.getCellClass)("flexGrow",1)}}function it(t,e){if(1&t&&(y.Oc(0),y.kc(1,"currency")),2&t){var a=e.row;y.Qc(" ",y.lc(1,1,null==a?null:a.rprecioneto)," ")}}function ct(t,e){if(1&t&&(y.Xb(0,"ngx-datatable-column",38),y.kc(1,"translate"),y.Mc(2,it,2,3,"ng-template",39),y.Wb()),2&t){var a=y.jc();y.qc("name",y.lc(1,3,"NEWPURCHASES.NETPRICE")),y.pc("cellClass",a.getCellClass)("flexGrow",1)}}function nt(t,e){if(1&t&&(y.Oc(0),y.kc(1,"currency")),2&t){var a=e.row;y.Qc(" ",y.lc(1,1,null==a?null:a.rtotalneto)," ")}}function st(t,e){if(1&t&&(y.Xb(0,"ngx-datatable-column",38),y.kc(1,"translate"),y.Mc(2,nt,2,3,"ng-template",39),y.Wb()),2&t){var a=y.jc();y.qc("name",y.lc(1,3,"NEWPURCHASES.NETTOTAL")),y.pc("cellClass",a.getCellClass)("flexGrow",1)}}function lt(t,e){if(1&t){var a=y.Yb();y.Xb(0,"button",60),y.fc("click",function(){y.Dc(a);var t=e.row;return y.jc().editarItem(t)}),y.Xb(1,"mat-icon"),y.Oc(2,"edit"),y.Wb(),y.Wb(),y.Xb(3,"button",61),y.fc("click",function(){y.Dc(a);var t=e.row;return y.jc().eliminarItem(t)}),y.Xb(4,"mat-icon"),y.Oc(5,"delete"),y.Wb(),y.Wb()}}function ut(t,e){1&t&&(y.Xb(0,"h4",44),y.Oc(1),y.kc(2,"translate"),y.Wb()),2&t&&(y.Eb(1),y.Qc(" ",y.lc(2,1,"NEWPURCHASES.TAXES"),""))}function pt(t,e){if(1&t){var a=y.Yb();y.Xb(0,"mat-form-field",44),y.Xb(1,"mat-label"),y.Oc(2),y.Wb(),y.Xb(3,"input",64),y.fc("ngModelChange",function(t){return e.$implicit.total=t})("change",function(){return y.Dc(a),y.jc(2).calcular_total(!1)})("keyup",function(){return y.Dc(a),y.jc(2).calcular_total(!1)}),y.Wb(),y.Wb()}if(2&t){var o=e.$implicit;y.Eb(2),y.Pc(o.simpuesto),y.Eb(1),y.pc("ngModel",o.total)}}function mt(t,e){if(1&t&&(y.Xb(0,"div",62),y.Mc(1,pt,4,2,"mat-form-field",63),y.Wb()),2&t){var a=y.jc();y.Eb(1),y.pc("ngForOf",a.lista_impuestos)}}function dt(t,e){if(1&t){var a=y.Yb();y.Xb(0,"mat-form-field",44),y.Xb(1,"mat-label"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Xb(4,"input",65),y.fc("change",function(){return y.Dc(a),y.jc().verificar_iva()})("keyup",function(){return y.Dc(a),y.jc().verificar_iva()}),y.Wb(),y.Wb()}if(2&t){var o=y.jc();y.Eb(2),y.Pc(y.lc(3,2,"NEWPURCHASES.TAXES")),y.Eb(2),y.pc("formControl",o.iva)}}function ft(t,e){1&t&&(y.Xb(0,"div",66),y.Xb(1,"b"),y.Oc(2),y.kc(3,"translate"),y.Wb(),y.Oc(4),y.kc(5,"translate"),y.Wb()),2&t&&(y.Eb(2),y.Pc(y.lc(3,2,"NEWPURCHASES.ATTENTION")),y.Eb(2),y.Qc(": ",y.lc(5,4,"NEWPURCHASES.ITISCONFIGUREDSOTHATTHISPURCHASEDOESNOTAFFECTTHESTOCK"),".\n"))}var bt,ht,vt=function(){return{y:"50px",delay:"300ms"}},Ct=function(t){return{value:"*",params:t}},gt=function(){return["/purchases/purchases-by-document/"]},_t=[{path:"",component:(bt=function(){function e(t,a,r,i,c,n,s,u,p){o(this,e),this.servicioUUID=t,this.loader=a,this.snack=r,this.router=i,this.servicioNuevaCompra=c,this.servicioProductos=n,this.servicioEmpresas=s,this.servicioSucursales=u,this.confirmService=p,this.guardando=!1,this.editorProveedor=new l.e(""),this.editorProducto=new l.e(""),this.sucursal="",this.startDate=new l.e,this.endDate=new l.e,this.tiposFactura=["PRODUCTOS","SERVICIOS"],this.form_precio=new l.e(""),this.form_cantidad=new l.e(""),this.form_servicio=new l.e(""),this.form_tipoFactura="",this.form_tipoDocumento="",this.form_precio_final=new l.e(""),this.fecha=new l.e,this.fechacontable=new l.e,this.fechacaicae=new l.e,this.form_numero=new l.e(""),this.form_caicae=new l.e(""),this.form_afectarStock=new l.e(""),this.form_descuento=new l.e(""),this.subtotal=new l.e(""),this.iva=new l.e(""),this.total=new l.e(""),this.form_numero_sucursal=new l.e(""),this.form_acredito=new l.e(""),this.error_iva=!1,this.tipoFacturaBloqueado=!1,this.formModal=function(){var t=this;this.confirmService.confirm({message:"\xbfDesea guardar la compra?"}).subscribe(function(e){if(e){var a,o=1;t.form_sucursal||(t.form_sucursal=t.sucursales_data[0]),a=t.form_sucursal.idsucursal,t.loader.open(),t.servicioNuevaCompra.obtenerDepositoXSucursal(a).subscribe(function(e){o=e[0].DepositoXSucursal,t.loader.close(),null==o?t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3}):(t.guardando=!0,t.generarCompra(a,o))},function(e){t.loader.close(),t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3})})}})},this.sucursal="",this.tiposDocumento=[],this.detalle=[],this.detalleimpuestos=[],this.fechaFiltroInicio=new Date,this.fechaFiltroFin=f().add(1,"days").toDate()}return i(e,[{key:"_filterProveedores",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.proveedores.filter(function(t){return t.srazonsocial.toLowerCase().includes(e)})}return[]}},{key:"displayFnProveedores",value:function(t){return t&&t.srazonsocial?t.srazonsocial:""}},{key:"_filterProductos",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.productos.filter(function(t){return t.snombre.toLowerCase().includes(e)})}return[]}},{key:"displayFnProductos",value:function(t){return t&&t.snombre?t.snombre:""}},{key:"getRowHeight",value:function(t){return 50}},{key:"getCellClass",value:function(t){var e=t.row,a=t.column;return{ngxgroup:e.isGroup,"ngx-alert-success ngx-alert-padding":"status"==a.prop&&e.idTipoDoc&&("F"==e.idTipoDoc[0]||"P"==e.idTipoDoc[0])&&"F"==e.bAnulado,"ngx-alert-danger ngx-alert-padding":"status"==a.prop&&e.idTipoDoc&&"N"==e.idTipoDoc[0]&&"F"==e.bAnulado,"ngx-alert-warning ngx-alert-padding":"status"==a.prop&&e.bAnulado&&"T"==e.bAnulado}}},{key:"tabla1OnActivate",value:function(t){"click"==t.type&&t.row.isGroup&&this.tabla1.setGroup(t.row)}},{key:"ngOnInit",value:function(){var t=this;this.tabla1=new g.a,this.tabla1.groupField="",this.tabla1.secondarySort="",this.tabla1.sum=[],this.tabla1.summaryRow=!1,this.tabla1.emptyRow=!1;var e=new Date;e.setHours(0,0,0,0);var a=new Date;a.setHours(23,59,59,999),this.startDate.setValue(e),this.endDate.setValue(a),this.loader.open(),this.servicioProductos.traerProductos("snombre ASC",function(){t.productos=t.servicioProductos.listaProductos,Object(b.a)([t.servicioEmpresas.obtenerEmpresas(),t.servicioProductos.obtenerProveedores(),t.servicioNuevaCompra.obtenerImpuestos(),t.servicioNuevaCompra.obtenerSucursales()]).subscribe(function(e){t.empresas=e[0],t.cantidaddecimales=t.empresas[0].icantidaddecimales,t.proveedores=e[1],t.impuestos=e[2],t.sucursales_data=e[3],t.filteredProveedores=t.editorProveedor.valueChanges.pipe(Object(h.a)(""),Object(v.a)(function(e){return t._filterProveedores(e)})),t.filteredProductos=t.editorProducto.valueChanges.pipe(Object(h.a)(""),Object(v.a)(function(e){return t._filterProductos(e)})),t.nuevaCompra(),t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"renameKeys",value:function(e,o){var r=Object.keys(e).map(function(t){return a({},o[t]||t,e[t])});return Object.assign.apply(Object,[{}].concat(t(r)))}},{key:"obtenerNombreProveedor",value:function(t){if(this.proveedores)for(var e=0;e<this.proveedores.length;e++)if(this.proveedores[e].id==t)return this.proveedores[e].srazonsocial;return""}},{key:"obtenerNombreProducto",value:function(t,e){for(var a=0;a<this.productos.length;a++)if(this.productos[a].id==t)return this.productos[a].snombre;return e}},{key:"obtenerCodigoProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e].scodproducto;return""}},{key:"cambiarTiposFactura",value:function(){this.form_servicio.setValue("")}},{key:"cambiarProveedor",value:function(t){var e="T"==t.bdeproductos,a="T"==t.bdeservicios;this.tipoFacturaBloqueado=!1,this.form_tipoFactura=this.tiposFactura[0],e&&!a&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[0]),a&&!e&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[1]),this.cargarTiposDocumento(t.scondicioniva,e)}},{key:"cargarTiposDocumento",value:function(t,e){this.tiposDocumento=["Presupuesto de Compra","Nota de Cr\xe9dito Presupuesto de Compra"],this.form_tipoDocumento="Presupuesto de Compra",e&&this.tiposDocumento.push("Remito de Compra"),"Monotributista"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Responsable Inscripto"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra A"),this.tiposDocumento.push("Nota de Cr\xe9dito A"),this.form_tipoDocumento="Factura de Compra A"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Consumidor Final"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C"))}},{key:"buscarProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e];return{}}},{key:"editarItem",value:function(t){this.temp_item=t,this.form_tipoFactura==this.tiposFactura[0]?(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_producto=this.buscarProducto(t.idproducto)):(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_servicio.setValue(t.sconcepto))}},{key:"eliminarItem",value:function(t){var e=this.tabla1.data.indexOf(t);this.tabla1.data.splice(e,1),this.calcular_total(!0),this.tabla1.sortData(),0==this.tabla1.data.length&&this.editorProveedor.enable()}},{key:"guardarItem",value:function(){try{this.form_cantidad.setValue(this.form_cantidad.value?this.form_cantidad.value:1);var t=this.tabla1.data.indexOf(this.temp_item),e=this.form_precio.value,a=this.form_precio_final.value;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento&&(e=parseFloat((a/1.21).toFixed(this.cantidaddecimales))),-1!=t?(this.form_tipoFactura==this.tiposFactura[0]?(this.tabla1.data[t].idproducto=this.form_producto.id,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=this.form_producto.rporciva,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-e),this.tabla1.data[t].sconcepto=this.form_producto.snombre):(this.tabla1.data[t].idproducto=null,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=21,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-e),this.tabla1.data[t].sconcepto=this.form_servicio.value),this.tabla1.data[t].impuesto_iva=this.tabla1.data[t].rporciva/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_dgr=this.tabla1.data[t].rporcdgr/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_interno=this.tabla1.data[t].rvalorimpinterno*this.tabla1.data[t].rcantidad):(this.tabla1.data.push(this.form_tipoFactura==this.tiposFactura[0]?{id:this.servicioUUID.generateUUID(),idproducto:this.form_producto.id,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:e,rporciva:this.form_producto.rporciva,rtotal:this.form_cantidad.value*a,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(a-e),sconcepto:this.form_producto.snombre}:{id:this.servicioUUID.generateUUID(),idproducto:null,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:e,rporciva:21,rtotal:this.form_cantidad.value*a,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(a-e),sconcepto:this.form_servicio.value}),this.tabla1.data[this.tabla1.data.length-1].impuesto_iva=this.tabla1.data[this.tabla1.data.length-1].rporciva/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_dgr=this.tabla1.data[this.tabla1.data.length-1].rporcdgr/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_interno=this.tabla1.data[this.tabla1.data.length-1].rvalorimpinterno*this.tabla1.data[this.tabla1.data.length-1].rcantidad),this.form_precio.setValue(0),this.form_precio_final.setValue(0),this.form_cantidad.setValue(1),this.form_servicio.setValue(""),this.temp_item=null,this.calcular_total(!0),this.tabla1.sortData(),this.editorProveedor.disable()}catch(o){console.error(o)}}},{key:"tipoComprobanteDeCompra",value:function(t){return"Presupuesto de Compra"==t?"PDC":"Remito de Compra"==t?"RMC":"Factura de Compra A"==t?"CCA":"Factura de Compra B"==t?"CCB":"Factura de Compra C"==t?"CCC":"Nota de Cr\xe9dito A"==t?"CNA":"Nota de Cr\xe9dito B"==t?"CNB":"Nota de Cr\xe9dito C"==t?"CNC":"Nota de Cr\xe9dito Presupuesto de Compra"==t?"PSC":void 0}},{key:"querySearch",value:function(t){if(""==t)return this.proveedores;var e=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.proveedores.length;a++){for(var o=this.proveedores[a].srazonsocial.toLowerCase(),r=!0,i=0;i<t.length;i++)if(-1==o.indexOf(t[i])){r=!1;break}r&&e.push(this.proveedores[a])}return e}},{key:"querySearchProducto",value:function(t){if(""==t)return this.productos;var e=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.productos.length;a++)for(var o=this.productos[a],r=0;r<t.length;r++){var i=t[r];if(-1==o.snombre.toLowerCase().indexOf(i)&&o.scodproducto.toLowerCase()!=i&&o.sean!=i&&o.sean2!=i)break;e.push(this.productos[a])}return e}},{key:"selectedItemChangeProducto",value:function(t){this.form_producto=t,t&&null!=t.rcostou&&this.form_precio.setValue(t.rcostou),this.calcular_precio_neto(),this.calcular_precio_final()}},{key:"calcular_precio_neto",value:function(){var t=this.form_producto;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||(this.form_precio.setValue(parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales))),this.form_precio.setValue(t&&t.rcostou&&t.rporciva&&t.rporcdgr&&null!=t.rvalorimpinterno?parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales)):0))}},{key:"calcular_precio_final",value:function(){var t=this.form_producto;this.form_precio_final.setValue(!t||"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento?this.form_precio.value:parseFloat((this.form_precio.value*(t.rporciva/100+t.rporcdgr/100+1)+t.rvalorimpinterno).toFixed(this.cantidaddecimales)))}},{key:"nuevaCompra",value:function(){var t=new Date;t.setHours(0,0,0,0),this.fecha.setValue(t);var e=new Date;e.setHours(0,0,0,0),this.fechacontable.setValue(e);var a=new Date;a.setHours(0,0,0,0),this.fechacaicae.setValue(f(a).add(10,"days").toDate()),this.tabla1.data=[],this.form_precio.setValue(0),this.form_cantidad.setValue(1),this.form_producto="",this.form_servicio.setValue(""),this.form_tipoFactura=this.tiposFactura[0],this.form_tipoDocumento=this.tiposDocumento[0],this.form_numero.setValue(""),this.form_caicae.setValue(""),this.form_afectarStock.setValue(!1),this.form_descuento.setValue(0),this.form_sucursal=this.sucursales_data[0],this.editorProveedor.setValue(this.proveedores[0]),this.cambiarProveedor(this.proveedores[0]),this.subtotal.setValue(0),this.iva.setValue(0),this.total.setValue(0),this.lista_impuestos=[],this.lista_impuestos=[];for(var o=0;o<this.impuestos.length;o++)this.lista_impuestos.push({id:this.impuestos[o].id,simpuesto:this.impuestos[o].simpuesto,total:0,idempresa:this.impuestos[o].idempresa,rporc:this.impuestos[o].rporc})}},{key:"cancelarCompra",value:function(){}},{key:"fechaAfip",value:function(){var t=this.fechacaicae.value,e=t.getUTCMonth()+1,a=t.getUTCDate(),o=t.getUTCFullYear();return o=e<10?o+"0"+e:o+""+e,a<10?o+"0"+a:o+""+a}},{key:"EsNotaDeCredito",value:function(t){return"CNA"==t||"CNB"==t||"CNC"==t||"CND"==t||"PSC"==t}},{key:"generarCompra",value:function(t,e){var a=this,o={id:this.servicioUUID.generateUUID(),idproveedor:this.editorProveedor.value.id,idtipodoc:this.tipoComprobanteDeCompra(this.form_tipoDocumento),idpv:this.form_numero_sucursal.value?this.form_numero_sucursal.value:1,idnumdoc:this.form_numero.value?this.form_numero.value:0,idsucursal:t,fdocumento:this.fecha.value.toISOString(),fcarga:(new Date).toISOString(),fvencimiento:this.fecha.value.toISOString(),fcontable:this.fechacontable.value.toISOString(),rtotneto:this.subtotal.value,rtotdescuento:this.form_descuento.value,rtotimpuestos:"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?this.iva.value:0,rtotbruto:this.total.value,rtotsaldo:this.form_acredito.value?this.total:0,scondpago:"EFE",banulado:"F",cae:this.form_caicae.value,caefchvto:this.fechaAfip(),bafectarstock:this.form_afectarStock.value?"T":"F",scondventa:this.form_acredito.value?"CRE":"CDO",cncdisponible:0,iaplicstock:this.EsNotaDeCredito(this.tipoComprobanteDeCompra(this.form_tipoDocumento))?-1:1,soperadoranulacion:"",idnctipodoc:"",idncpv:null,idnunumdoc:null,fanulacion:null,facancelacion:null};this.loader.open(),this.servicioNuevaCompra.guardarCompra(o).subscribe(function(o){var r=[],i=o;a.tabla1.data.slice(0).forEach(function(o,c){o.idcompra=i.id,o.idnumlinea=c+1,o.idsucursal=t,o.rimpuestos=o.rimpuestos?o.rimpuestos:0,o.rimpuestos=o.rimpuestos*o.rcantidad,a.form_afectarStock.value&&(o.iddeposito=e),delete o.rtotalneto,delete o.impuesto_iva,delete o.impuesto_dgr,delete o.impuesto_interno,r.push(a.servicioNuevaCompra.guardarCompraItem(o))}),"Factura de Compra A"!=a.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=a.form_tipoDocumento||a.lista_impuestos.forEach(function(e){if(e.total){var o={id:a.servicioUUID.generateUUID(),idcompra:i.id,idimpuesto:e.id,rmonto:e.total,idempresa:e.idempresa,idsucursal:t};r.push(a.servicioNuevaCompra.guardarImpuestos(o))}}),Object(b.a)(r).subscribe(function(t){a.loader.close(),a.snack.open("\xa1Compra Guardada!","OK",{duration:4e3}),a.router.navigateByUrl("purchases/purchases-by-document")},function(t){console.error(t),a.loader.close(),a.snack.open("ERROR al guardar los items o el iva","OK",{duration:4e3})})},function(t){console.error(t),a.loader.close(),a.snack.open("ERROR al guardar la compra","OK",{duration:4e3})})}},{key:"verificar_iva",value:function(){this.error_iva=this.total_impuestos!=this.iva.value}},{key:"calcular_total_impuestos",value:function(){for(var t=0,e=0;e<this.lista_impuestos.length;e++)t+=this.lista_impuestos[e].total;this.total_impuestos=parseFloat(t.toFixed(this.cantidaddecimales)),this.iva.setValue(this.total_impuestos)}},{key:"calcular_total",value:function(t){for(var e=0,a=0,o=0;o<this.tabla1.data.length;o++)e+=this.tabla1.data[o].rtotal,a+=this.tabla1.data[o].rtotalneto;if(t){for(var r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=0;for(o=0;o<this.tabla1.data.length;o++)for(r=0;r<this.lista_impuestos.length;r++){if(this.tabla1.data[o].rporciva==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_iva;break}if(this.tabla1.data[o].rporcdgr==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_dgr;break}if(this.tabla1.data[o].rvalorimpinterno==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_interno;break}}for(r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=parseFloat(this.lista_impuestos[r].total.toFixed(this.cantidaddecimales))}"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?(this.calcular_total_impuestos(),this.subtotal.setValue(parseFloat(a.toFixed(this.cantidaddecimales)))):(this.subtotal.setValue(parseFloat(e.toFixed(this.cantidaddecimales))),this.iva.setValue(0)),this.total.setValue(parseFloat((this.subtotal.value-this.form_descuento.value+this.iva.value).toFixed(this.cantidaddecimales)))}}]),e}(),bt.\u0275fac=function(t){return new(t||bt)(y.Rb(d.a),y.Rb(m.a),y.Rb(D.a),y.Rb(A.g),y.Rb(F),y.Rb(_.a),y.Rb(C.a),y.Rb(E.a),y.Rb(p.a))},bt.\u0275cmp=y.Lb({type:bt,selectors:[["app-new-purchase"]],decls:144,vars:163,consts:[["fxLayout","row wrap"],["appearance","fill","fxFlex","100",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Proveedor","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["appearance","fill","fxFlex","30",1,"m-8","graphic-select-form-field"],[3,"ngModel","ngModelChange"],["fxFlex","25","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_numero_sucursal","matInput","","type","number","max","9999","min","0",3,"formControl"],["name","form_numero","matInput","","type","number","max","99999999","min","0",3,"formControl"],["fxFlex","10",1,"m-8",2,"padding-top","15px"],["name","form_acredito",3,"formControl"],["fxFlex","10","appearance","fill",1,"m-8","graphic-select-form-field"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","color","enableMeridian","disableMinute","hideTime"],["picker",""],["picker2",""],["fxFlex","15","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_caicae","matInput","","type","number","min","0",3,"formControl"],["picker3",""],["appearance","fill","fxFlex","15",1,"m-8","graphic-select-form-field"],[3,"ngModel","disabled","ngModelChange","selectionChange"],["fxFlex","10",1,"m-8",2,"padding-top","15px",3,"hidden"],["name","form_afectarStock",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","15",4,"ngIf"],["name","form_cantidad","matInput","","type","number","min","0",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","50",4,"ngIf"],["class","m-8 graphic-select-form-field","fxFlex","50","appearance","fill",4,"ngIf"],[4,"ngIf"],["name","form_precio","matInput","","type","number","min","0",3,"formControl","change","keyup"],["class","m-8 graphic-select-form-field","fxFlex","10","appearance","fill",4,"ngIf"],["mat-button","","color","primary",1,"m-8",3,"click"],[1,"p-0"],["summaryRow","false",1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","selectionType","activate"],["myTable",""],[3,"cellClass","name","flexGrow"],["ngx-datatable-cell-template",""],[3,"cellClass","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","minWidth"],["class","m-8",4,"ngIf"],["layout-gt-xs","row",4,"ngIf"],[1,"m-8"],["matInput","","type","number","min","0","name","subtotal","aria-label","Subtotal",3,"formControl"],["matInput","","type","number","min","0","name","form_descuento","aria-label","Descuentos",3,"formControl","change","keyup"],["matInput","","type","number","min","0","name","total","aria-label","Total",3,"formControl"],["class","red-400 red-400-fg p-16",4,"ngIf"],["fxFlex","100",1,"mt-16"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"disabled","routerLink"],[3,"value"],["appearance","fill","fxFlex","50",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Producto","matInput","",3,"formControl","matAutocomplete"],["auto2","matAutocomplete"],["fxFlex","50","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_servicio","matInput","","type","text","min","0",3,"formControl"],["readonly","","name","form_precio_final","matInput","","type","number","min","0",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",1,"mr-16",3,"click"],["layout-gt-xs","row"],["class","m-8",4,"ngFor","ngForOf"],["matInput","","type","number","min","0","aria-label","Impuesto",3,"ngModel","ngModelChange","change","keyup"],["matInput","","type","number","min","0","name","iva","aria-label","Impuestos",3,"formControl","change","keyup"],[1,"red-400","red-400-fg","p-16"]],template:function(t,e){if(1&t&&(y.Xb(0,"div"),y.Xb(1,"div",0),y.Xb(2,"mat-form-field",1),y.Xb(3,"mat-label"),y.Oc(4),y.kc(5,"translate"),y.Wb(),y.Sb(6,"input",2),y.Xb(7,"mat-autocomplete",3,4),y.fc("optionSelected",function(t){return e.cambiarProveedor(t.option.value)}),y.Mc(9,V,2,2,"mat-option",5),y.kc(10,"async"),y.Wb(),y.Wb(),y.Wb(),y.Xb(11,"div",6),y.Xb(12,"mat-form-field",7),y.Xb(13,"mat-label"),y.Oc(14),y.kc(15,"translate"),y.Wb(),y.Xb(16,"mat-select",8),y.fc("ngModelChange",function(t){return e.form_tipoDocumento=t}),y.Mc(17,L,2,2,"mat-option",5),y.Wb(),y.Wb(),y.Xb(18,"mat-form-field",9),y.Xb(19,"mat-label"),y.Oc(20),y.kc(21,"translate"),y.Wb(),y.Sb(22,"input",10),y.Wb(),y.Xb(23,"mat-form-field",9),y.Xb(24,"mat-label"),y.Oc(25),y.kc(26,"translate"),y.Wb(),y.Sb(27,"input",11),y.Wb(),y.Xb(28,"div",12),y.Xb(29,"mat-checkbox",13),y.Oc(30),y.kc(31,"translate"),y.Wb(),y.Wb(),y.Wb(),y.Xb(32,"div",6),y.Xb(33,"mat-form-field",14),y.Xb(34,"mat-label"),y.Oc(35),y.kc(36,"translate"),y.Wb(),y.Sb(37,"input",15),y.Sb(38,"mat-datepicker-toggle",16),y.Sb(39,"ngx-mat-datetime-picker",17,18),y.Wb(),y.Xb(41,"mat-form-field",14),y.Xb(42,"mat-label"),y.Oc(43),y.kc(44,"translate"),y.Wb(),y.Sb(45,"input",15),y.Sb(46,"mat-datepicker-toggle",16),y.Sb(47,"ngx-mat-datetime-picker",17,19),y.Wb(),y.Xb(49,"mat-form-field",20),y.Xb(50,"mat-label"),y.Oc(51),y.kc(52,"translate"),y.Wb(),y.Sb(53,"input",21),y.Wb(),y.Xb(54,"mat-form-field",14),y.Xb(55,"mat-label"),y.Oc(56),y.kc(57,"translate"),y.Wb(),y.Sb(58,"input",15),y.Sb(59,"mat-datepicker-toggle",16),y.Sb(60,"ngx-mat-datetime-picker",17,22),y.Wb(),y.Xb(62,"mat-form-field",23),y.Xb(63,"mat-label"),y.Oc(64),y.kc(65,"translate"),y.Wb(),y.Xb(66,"mat-select",24),y.fc("ngModelChange",function(t){return e.form_tipoFactura=t})("selectionChange",function(){return e.cambiarTiposFactura()}),y.Mc(67,G,2,2,"mat-option",5),y.Wb(),y.Wb(),y.Xb(68,"div",25),y.Xb(69,"mat-checkbox",26),y.Oc(70),y.kc(71,"translate"),y.Wb(),y.Wb(),y.Mc(72,q,6,5,"mat-form-field",27),y.Wb(),y.Wb(),y.Xb(73,"div",6),y.Xb(74,"mat-form-field",14),y.Xb(75,"mat-label"),y.Oc(76),y.kc(77,"translate"),y.Wb(),y.Sb(78,"input",28),y.Wb(),y.Mc(79,Y,9,9,"mat-form-field",29),y.Mc(80,z,5,4,"mat-form-field",30),y.Xb(81,"mat-form-field",14),y.Mc(82,K,3,3,"mat-label",31),y.Mc(83,J,3,3,"mat-label",31),y.Xb(84,"input",32),y.fc("change",function(){return e.calcular_precio_final()})("keyup",function(){return e.calcular_precio_final()}),y.Wb(),y.Wb(),y.Mc(85,$,5,4,"mat-form-field",33),y.Xb(86,"button",34),y.fc("click",function(){return e.guardarItem()}),y.Xb(87,"mat-icon"),y.Oc(88,"save"),y.Wb(),y.Oc(89),y.kc(90,"translate"),y.Wb(),y.Wb(),y.Xb(91,"mat-card",35),y.Xb(92,"mat-card-content",35),y.Xb(93,"ngx-datatable",36,37),y.fc("activate",function(t){return e.tabla1OnActivate(t)}),y.Xb(95,"ngx-datatable-column",38),y.kc(96,"translate"),y.Mc(97,Z,2,3,"ng-template",39),y.Wb(),y.Xb(98,"ngx-datatable-column",38),y.kc(99,"translate"),y.Mc(100,tt,1,1,"ng-template",39),y.Wb(),y.Mc(101,at,3,5,"ngx-datatable-column",40),y.Mc(102,rt,3,5,"ngx-datatable-column",40),y.Mc(103,ct,3,5,"ngx-datatable-column",40),y.Mc(104,st,3,5,"ngx-datatable-column",40),y.Xb(105,"ngx-datatable-column",41),y.kc(106,"translate"),y.Mc(107,lt,6,0,"ng-template",39),y.Wb(),y.Wb(),y.Wb(),y.Wb(),y.Mc(108,ut,3,3,"h4",42),y.Mc(109,mt,2,1,"div",43),y.Xb(110,"h4",44),y.Oc(111),y.kc(112,"translate"),y.Wb(),y.Xb(113,"div",6),y.Xb(114,"mat-form-field",44),y.Xb(115,"mat-label"),y.Oc(116),y.kc(117,"translate"),y.Wb(),y.Sb(118,"input",45),y.Wb(),y.Xb(119,"mat-form-field",44),y.Xb(120,"mat-label"),y.Oc(121),y.kc(122,"translate"),y.Wb(),y.Xb(123,"input",46),y.fc("change",function(){return e.calcular_total(!0)})("keyup",function(){return e.calcular_total(!0)}),y.Wb(),y.Wb(),y.Mc(124,dt,5,4,"mat-form-field",42),y.Xb(125,"mat-form-field",44),y.Xb(126,"mat-label"),y.Oc(127),y.kc(128,"translate"),y.Wb(),y.Sb(129,"input",47),y.Wb(),y.Wb(),y.Mc(130,ft,6,6,"div",48),y.Xb(131,"div",6),y.Xb(132,"div",49),y.Xb(133,"button",50),y.fc("click",function(){return e.formModal()}),y.Xb(134,"mat-icon"),y.Oc(135,"save"),y.Wb(),y.Oc(136),y.kc(137,"translate"),y.Wb(),y.Sb(138,"span",51),y.Xb(139,"button",52),y.Xb(140,"mat-icon"),y.Oc(141,"cancel"),y.Wb(),y.Oc(142),y.kc(143,"translate"),y.Wb(),y.Wb(),y.Wb()),2&t){var a=y.Ac(8),o=y.Ac(40),r=y.Ac(48),i=y.Ac(61);y.Eb(4),y.Pc(y.lc(5,113,"NEWPURCHASES.SUPPLIER")),y.Eb(2),y.pc("formControl",e.editorProveedor)("matAutocomplete",a),y.Eb(1),y.pc("displayWith",e.displayFnProveedores),y.Eb(2),y.pc("ngForOf",y.lc(10,115,e.filteredProveedores)),y.Eb(5),y.Pc(y.lc(15,117,"NEWPURCHASES.DOCUMENT")),y.Eb(2),y.pc("ngModel",e.form_tipoDocumento),y.Eb(1),y.pc("ngForOf",e.tiposDocumento),y.Eb(3),y.Pc(y.lc(21,119,"NEWPURCHASES.NUMBER(FIRST4DIGITS)")),y.Eb(2),y.pc("formControl",e.form_numero_sucursal),y.Eb(3),y.Pc(y.lc(26,121,"NEWPURCHASES.NUMBER(LAST8DIGITS)")),y.Eb(2),y.pc("formControl",e.form_numero),y.Eb(2),y.pc("formControl",e.form_acredito),y.Eb(1),y.Pc(y.lc(31,123,"NEWPURCHASES.ONCREDIT")),y.Eb(5),y.Pc(y.lc(36,125,"NEWPURCHASES.DATE")),y.Eb(2),y.pc("ngxMatDatetimePicker",o)("formControl",e.fecha),y.Eb(1),y.pc("for",o),y.Eb(1),y.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),y.Eb(4),y.Pc(y.lc(44,127,"NEWPURCHASES.ACCOUNTINGDATE")),y.Eb(2),y.pc("ngxMatDatetimePicker",r)("formControl",e.fechacontable),y.Eb(1),y.pc("for",r),y.Eb(1),y.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),y.Eb(4),y.Pc(y.lc(52,129,"NEWPURCHASES.CAI/CAE")),y.Eb(2),y.pc("formControl",e.form_caicae),y.Eb(3),y.Pc(y.lc(57,131,"NEWPURCHASES.CAI/CAEDATE")),y.Eb(2),y.pc("ngxMatDatetimePicker",i)("formControl",e.fechacaicae),y.Eb(1),y.pc("for",i),y.Eb(1),y.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),y.Eb(4),y.Pc(y.lc(65,133,"NEWPURCHASES.INVOICETYPE")),y.Eb(2),y.pc("ngModel",e.form_tipoFactura)("disabled",e.tabla1.data.length>0||e.tipoFacturaBloqueado),y.Eb(1),y.pc("ngForOf",e.tiposFactura),y.Eb(1),y.pc("hidden",e.form_tipoFactura!=e.tiposFactura[0]),y.Eb(1),y.pc("formControl",e.form_afectarStock),y.Eb(1),y.Pc(y.lc(71,135,"NEWPURCHASES.AFFECTSTOCK")),y.Eb(2),y.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]&&e.form_afectarStock.value),y.Eb(4),y.Pc(y.lc(77,137,"NEWPURCHASES.QUANTITY")),y.Eb(2),y.pc("formControl",e.form_cantidad),y.Eb(1),y.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]),y.Eb(1),y.pc("ngIf",e.form_tipoFactura==e.tiposFactura[1]),y.Eb(2),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),y.Eb(1),y.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),y.Eb(1),y.pc("formControl",e.form_precio),y.Eb(1),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),y.Eb(4),y.Qc("",y.lc(90,139,"NEWPURCHASES.SAVE")," "),y.Eb(2),y.pc("@animate",y.vc(160,Ct,y.uc(159,vt))),y.Eb(2),y.pc("columnMode","flex")("headerHeight",50)("footerHeight",50)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",e.tabla1.rows)("selectionType","single"),y.Eb(2),y.qc("name",y.lc(96,141,"NEWPURCHASES.QUANTITY")),y.pc("cellClass",e.getCellClass)("flexGrow",1),y.Eb(3),y.qc("name",y.lc(99,143,"NEWPURCHASES.CONCEPT")),y.pc("cellClass",e.getCellClass)("flexGrow",2),y.Eb(3),y.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),y.Eb(1),y.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),y.Eb(1),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),y.Eb(1),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),y.Eb(1),y.qc("name",y.lc(106,145,"NEWPURCHASES.ACTIONS")),y.pc("flexGrow",1)("minWidth",100),y.Eb(3),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),y.Eb(1),y.pc("ngIf",("Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento)&&0!=e.lista_impuestos.length),y.Eb(2),y.Pc(y.lc(112,147,"NEWPURCHASES.RESUME")),y.Eb(5),y.Pc(y.lc(117,149,"NEWPURCHASES.SUBTOTAL")),y.Eb(2),y.pc("formControl",e.subtotal),y.Eb(3),y.Pc(y.lc(122,151,"NEWPURCHASES.DISCOUNTS")),y.Eb(2),y.pc("formControl",e.form_descuento),y.Eb(1),y.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),y.Eb(3),y.Pc(y.lc(128,153,"NEWPURCHASES.TOTAL")),y.Eb(2),y.pc("formControl",e.total),y.Eb(1),y.pc("ngIf",!e.form_afectarStock.value),y.Eb(3),y.pc("disabled",e.guardando),y.Eb(3),y.Qc("",y.lc(137,155,"NEWPURCHASES.SAVE")," "),y.Eb(3),y.pc("disabled",e.guardando)("routerLink",y.uc(162,gt)),y.Eb(3),y.Qc("",y.lc(143,157,"NEWPURCHASES.CANCEL")," ")}},directives:[P.c,x.c,P.a,x.f,O.b,l.c,W.c,l.o,l.f,W.a,s.n,w.a,l.r,l.s,I.a,R.a,N.h,x.h,R.b,s.o,X.b,M.a,U.a,U.b,T.d,T.b,T.a,A.h,H.n],pipes:[j.c,s.b,s.g,s.d],styles:[""],data:{animation:[u.a]}}),bt),data:{title:"NUEVA COMPRA"}}],Et=c("u9T3"),St=c("f44v"),yt=c("iELJ"),kt=c("jMqV"),Ft=c("M9ds"),Dt=c("ZFy/"),At=c("PCNd"),Pt=c("BxcV"),xt=c("OaSA"),Ot=((ht=function t(){o(this,t)}).\u0275mod=y.Pb({type:ht}),ht.\u0275inj=y.Ob({factory:function(t){return new(t||ht)},imports:[[s.c,l.t,Et.a,T.f,O.c,O.c,U.c,O.c,X.c,St.a,O.c,Dt.b,yt.f,D.b,kt.b,Ft.c,w.b,M.b,j.b,At.a,W.b,Pt.a,l.j,N.g,R.c,R.e,R.d,I.b,xt.a,A.k.forChild(_t)]]}),ht)},CHRX:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var c=r("wd/R"),n=function(){function t(){o(this,t),this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.summaryRow=!0,this.emptyRow=!0,this.customFilter=function(t){return t}}return i(t,[{key:"setGroup",value:function(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}},{key:"setData",value:function(t){this.data=t,this.sortData()}},{key:"sortData",value:function(){var t=this;this.data.sort(function(e,a){if(e[t.groupField]==a[t.groupField]){if(t.secondarySort){if(null==e[t.secondarySort])return 1;if(null==a[t.secondarySort])return-1;if(e[t.secondarySort]>a[t.secondarySort])return 1*("desc"===t.sortDir?-1:1);if(e[t.secondarySort]<a[t.secondarySort])return-1*("desc"===t.sortDir?-1:1)}}else{if(null==e[t.groupField])return 1;if(null==a[t.groupField])return-1;if(e[t.groupField]>a[t.groupField])return 1;if(e[t.groupField]<a[t.groupField])return-1}return 0}),this.filterRows()}},{key:"filterRows",value:function(){var t=this,e=[];e=this.data.filter(function(e){for(var a in t.filter){if(t.filter[a]&&null==e[a])return!1;switch(typeof e[a]){case"number":if(t.filter[a]&&Math.trunc(e[a]).toString()!==Math.trunc(t.filter[a]).toString())return!1;break;case"string":if("f"==a.charAt(0).toLowerCase()&&c(e[a]).isValid){if(-1==c(e[a]).format("DD/MM/YYYY HH:mm:ss").indexOf(t.filter[a]))return!1;break}if(-1==e[a].toLowerCase().indexOf(t.filter[a].toLowerCase()))return!1}}return!0}),e=this.customFilter(e);var o={};this.groupField?o[this.groupField]=e.length.toString():o.count=e.length.toString(),this.sum.forEach(function(t){return o[t]=0});for(var r=0;r<e.length;r++)this.sum.forEach(function(t){return o[t]+=e[r][t]});if(o.isGroup=!0,this.footer=o,this.groupField){var i=[];e.forEach(function(e){-1==i.indexOf(e[t.groupField])&&i.push(e[t.groupField])}),i=i.map(function(t){return{name:t,count:1}});var n=[],s=!0,l=0,u=null,p=function(){u&&(u[t.groupField]+=" ("+i[l-1].count.toString()+")")};for(r=0;r<e.length;r++){if(s&&e[r][this.groupField]==i[l].name){var m;p();var d="+";this.groups[i[l].name]&&(d="-"),a(m={},this.groupField,d+" "+i[l].name),a(m,"isGroup",!0),a(m,"name",i[l].name),u=m,this.sum.forEach(function(t){return u[t]=0}),n.push(u),s=++l<i.length}else i[l-1].count++;this.sum.forEach(function(t){return u[t]+=e[r][t]}),n.push(e[r])}p(),e=null,n=n.filter(function(e){return!!e.isGroup||!!t.groups[e[t.groupField]]||void 0}),this.rows=n}else this.rows=e;this.summaryRow&&this.rows.push(this.footer),0==this.rows.length&&this.emptyRow&&this.rows.push({})}},{key:"updateFilter",value:function(t,e){if(t&&e){var a=t.target.value;t instanceof MouseEvent&&(a=""),this.filter[e]=a,this.filterRows()}return!0}},{key:"updateFilterBoolean",value:function(t,e){return this.filter[e]=t,this.filterRows(),!0}}],[{key:"prepararFiltroAPI",value:function(t){var e="";for(var a in t)t[a].search&&(e+="number"==typeof t[a].search?'{"'.concat(a,'":').concat(t[a].search,"},"):t[a].exact?'{"'.concat(a,'":"').concat(t[a].search,'"},'):'{"'.concat(a,'":{"ilike":"%').concat(t[a].search,'%"}},'));return e}}]),t}()},GmJt:function(t,e,a){"use strict";a.d(e,"a",function(){return i});var o=a("GS7A"),r=Object(o.g)([Object(o.l)({opacity:"{{opacity}}",transform:"scale({{scale}}) translate3d({{x}}, {{y}}, {{z}})"}),Object(o.e)("{{duration}} {{delay}} cubic-bezier(0.0, 0.0, 0.2, 1)",Object(o.l)("*"))],{params:{duration:"200ms",delay:"0ms",opacity:"0",scale:"1",x:"0",y:"0",z:"0"}}),i=[Object(o.n)("animate",[Object(o.m)("void => *",[Object(o.o)(r)])]),Object(o.n)("fadeInOut",[Object(o.k)("0",Object(o.l)({opacity:0,display:"none"})),Object(o.k)("1",Object(o.l)({opacity:1,display:"block"})),Object(o.m)("0 => 1",Object(o.e)("300ms")),Object(o.m)("1 => 0",Object(o.e)("300ms"))])]},vpPe:function(t,e,a){"use strict";a.d(e,"a",function(){return c});var r=a("8Y7J"),c=function(){var t=function(){function t(){o(this,t)}return i(t,[{key:"generateUUID",value:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?a:3&a|8).toString(16)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}])}();