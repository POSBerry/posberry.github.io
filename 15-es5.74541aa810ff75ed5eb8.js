!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,a){if(!t)return;if("string"==typeof t)return e(t,a);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);if("Map"===o||"Set"===o)return Array.from(t);if("Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o))return e(t,a)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,o=new Array(e);a<e;a++)o[a]=t[a];return o}function a(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var a=0;a<e.length;a++){var o=e[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,a){return e&&r(t.prototype,e),a&&r(t,a),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"2Doj":function(e,r,c){"use strict";c.r(r),c.d(r,"NewPurchaseModule",function(){return Pt});var n=c("SVse"),s=c("s7LF"),l=c("GmJt"),u=c("3kSh"),m=c("3sEA"),p=c("vpPe"),d=c("wd/R"),f=c("cp0P"),b=c("JX91"),h=c("lJxs"),v=c("Sp5M"),C=c("CHRX"),g=c("qA6C"),_=c("UVsP"),E=c("wyE3"),S=c("8Y7J"),y=c("zHaW"),F=c("iInd"),k=c("VDRc"),D=c("Q2Ze"),P=c("e6WT"),x=c("vrAh"),A=c("ZTz/"),O=c("pMoy"),W=c("n1FK"),w=c("TN/R"),N=c("Dxy4"),I=c("Tj54"),R=c("PDjf"),X=c("w9WL"),M=c("UhP/"),U=c("TSSN");function T(t,e){if(1&t&&(S.Xb(0,"mat-option",53),S.Oc(1),S.Wb()),2&t){var a=e.$implicit;S.pc("value",a),S.Eb(1),S.Qc(" ",null==a?null:a.srazonsocial," ")}}function H(t,e){if(1&t&&(S.Xb(0,"mat-option",53),S.Oc(1),S.Wb()),2&t){var a=e.$implicit;S.pc("value",a),S.Eb(1),S.Qc(" ",a," ")}}function j(t,e){if(1&t&&(S.Xb(0,"mat-option",53),S.Oc(1),S.Wb()),2&t){var a=e.$implicit;S.pc("value",a),S.Eb(1),S.Qc(" ",a," ")}}function V(t,e){if(1&t&&(S.Xb(0,"mat-option",53),S.Oc(1),S.Wb()),2&t){var a=e.$implicit;S.pc("value",a),S.Eb(1),S.Qc(" ",a.sdescripcion," ")}}function L(t,e){if(1&t){var a=S.Yb();S.Xb(0,"mat-form-field",23),S.Xb(1,"mat-label"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Xb(4,"mat-select",8),S.fc("ngModelChange",function(t){return S.Dc(a),S.jc().form_sucursal=t}),S.Mc(5,V,2,2,"mat-option",5),S.Wb(),S.Wb()}if(2&t){var o=S.jc();S.Eb(2),S.Pc(S.lc(3,3,"NEWPURCHASES.BRANCHDEPOSIT")),S.Eb(2),S.pc("ngModel",o.form_sucursal),S.Eb(1),S.pc("ngForOf",o.sucursales_data)}}function G(t,e){if(1&t&&(S.Xb(0,"mat-option",53),S.Oc(1),S.Wb()),2&t){var a=e.$implicit;S.pc("value",a),S.Eb(1),S.Rc(" ",null==a?null:a.scodproducto," - ",null==a?null:a.snombre," ")}}function B(t,e){if(1&t){var a=S.Yb();S.Xb(0,"mat-form-field",54),S.Xb(1,"mat-label"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Sb(4,"input",55),S.Xb(5,"mat-autocomplete",3,56),S.fc("optionSelected",function(t){return S.Dc(a),S.jc().selectedItemChangeProducto(t.option.value)}),S.Mc(7,G,2,3,"mat-option",5),S.kc(8,"async"),S.Wb(),S.Wb()}if(2&t){var o=S.Ac(6),r=S.jc();S.Eb(2),S.Pc(S.lc(3,5,"NEWPURCHASES.PRODUCT")),S.Eb(2),S.pc("formControl",r.editorProducto)("matAutocomplete",o),S.Eb(1),S.pc("displayWith",r.displayFnProductos),S.Eb(2),S.pc("ngForOf",S.lc(8,7,r.filteredProductos))}}function Q(t,e){if(1&t&&(S.Xb(0,"mat-form-field",57),S.Xb(1,"mat-label"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Sb(4,"input",58),S.Wb()),2&t){var a=S.jc();S.Eb(2),S.Pc(S.lc(3,2,"NEWPURCHASES.DETAIL")),S.Eb(2),S.pc("formControl",a.form_servicio)}}function q(t,e){1&t&&(S.Xb(0,"mat-label"),S.Oc(1),S.kc(2,"translate"),S.Wb()),2&t&&(S.Eb(1),S.Pc(S.lc(2,1,"NEWPURCHASES.NETPRICE")))}function Y(t,e){1&t&&(S.Xb(0,"mat-label"),S.Oc(1),S.kc(2,"translate"),S.Wb()),2&t&&(S.Eb(1),S.Pc(S.lc(2,1,"NEWPURCHASES.UNITPRICE")))}function z(t,e){if(1&t&&(S.Xb(0,"mat-form-field",14),S.Xb(1,"mat-label"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Sb(4,"input",59),S.Wb()),2&t){var a=S.jc();S.Eb(2),S.Pc(S.lc(3,2,"NEWPURCHASES.FINALPRICE")),S.Eb(2),S.pc("formControl",a.form_precio_final)}}function K(t,e){if(1&t&&(S.Oc(0),S.kc(1,"number")),2&t){var a=e.row;S.Qc(" ",S.lc(1,1,null==a?null:a.rcantidad)," ")}}function J(t,e){if(1&t&&S.Oc(0),2&t){var a=e.row;S.Qc(" ",null==a?null:a.sconcepto," ")}}function $(t,e){if(1&t&&(S.Oc(0),S.kc(1,"currency")),2&t){var a=e.row;S.Qc(" ",S.lc(1,1,null==a?null:a.rpreciou)," ")}}function Z(t,e){if(1&t&&(S.Xb(0,"ngx-datatable-column",38),S.kc(1,"translate"),S.Mc(2,$,2,3,"ng-template",39),S.Wb()),2&t){var a=S.jc();S.qc("name",S.lc(1,3,"NEWPURCHASES.PRICE")),S.pc("cellClass",a.getCellClass)("flexGrow",1)}}function tt(t,e){if(1&t&&(S.Oc(0),S.kc(1,"currency")),2&t){var a=e.row;S.Qc(" ",S.lc(1,1,null==a?null:a.rtotal)," ")}}function et(t,e){if(1&t&&(S.Xb(0,"ngx-datatable-column",38),S.kc(1,"translate"),S.Mc(2,tt,2,3,"ng-template",39),S.Wb()),2&t){var a=S.jc();S.qc("name",S.lc(1,3,"NEWPURCHASES.TOTAL")),S.pc("cellClass",a.getCellClass)("flexGrow",1)}}function at(t,e){if(1&t&&(S.Oc(0),S.kc(1,"currency")),2&t){var a=e.row;S.Qc(" ",S.lc(1,1,null==a?null:a.rprecioneto)," ")}}function ot(t,e){if(1&t&&(S.Xb(0,"ngx-datatable-column",38),S.kc(1,"translate"),S.Mc(2,at,2,3,"ng-template",39),S.Wb()),2&t){var a=S.jc();S.qc("name",S.lc(1,3,"NEWPURCHASES.NETPRICE")),S.pc("cellClass",a.getCellClass)("flexGrow",1)}}function rt(t,e){if(1&t&&(S.Oc(0),S.kc(1,"currency")),2&t){var a=e.row;S.Qc(" ",S.lc(1,1,null==a?null:a.rtotalneto)," ")}}function it(t,e){if(1&t&&(S.Xb(0,"ngx-datatable-column",38),S.kc(1,"translate"),S.Mc(2,rt,2,3,"ng-template",39),S.Wb()),2&t){var a=S.jc();S.qc("name",S.lc(1,3,"NEWPURCHASES.NETTOTAL")),S.pc("cellClass",a.getCellClass)("flexGrow",1)}}function ct(t,e){if(1&t){var a=S.Yb();S.Xb(0,"button",60),S.fc("click",function(){S.Dc(a);var t=e.row;return S.jc().editarItem(t)}),S.Xb(1,"mat-icon"),S.Oc(2,"edit"),S.Wb(),S.Wb(),S.Xb(3,"button",61),S.fc("click",function(){S.Dc(a);var t=e.row;return S.jc().eliminarItem(t)}),S.Xb(4,"mat-icon"),S.Oc(5,"delete"),S.Wb(),S.Wb()}}function nt(t,e){1&t&&(S.Xb(0,"h4",44),S.Oc(1),S.kc(2,"translate"),S.Wb()),2&t&&(S.Eb(1),S.Qc(" ",S.lc(2,1,"NEWPURCHASES.TAXES"),""))}function st(t,e){if(1&t){var a=S.Yb();S.Xb(0,"mat-form-field",44),S.Xb(1,"mat-label"),S.Oc(2),S.Wb(),S.Xb(3,"input",64),S.fc("ngModelChange",function(t){return e.$implicit.total=t})("change",function(){return S.Dc(a),S.jc(2).calcular_total(!1)})("keyup",function(){return S.Dc(a),S.jc(2).calcular_total(!1)}),S.Wb(),S.Wb()}if(2&t){var o=e.$implicit;S.Eb(2),S.Pc(o.simpuesto),S.Eb(1),S.pc("ngModel",o.total)}}function lt(t,e){if(1&t&&(S.Xb(0,"div",62),S.Mc(1,st,4,2,"mat-form-field",63),S.Wb()),2&t){var a=S.jc();S.Eb(1),S.pc("ngForOf",a.lista_impuestos)}}function ut(t,e){if(1&t){var a=S.Yb();S.Xb(0,"mat-form-field",44),S.Xb(1,"mat-label"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Xb(4,"input",65),S.fc("change",function(){return S.Dc(a),S.jc().verificar_iva()})("keyup",function(){return S.Dc(a),S.jc().verificar_iva()}),S.Wb(),S.Wb()}if(2&t){var o=S.jc();S.Eb(2),S.Pc(S.lc(3,2,"NEWPURCHASES.TAXES")),S.Eb(2),S.pc("formControl",o.iva)}}function mt(t,e){1&t&&(S.Xb(0,"div",66),S.Xb(1,"b"),S.Oc(2),S.kc(3,"translate"),S.Wb(),S.Oc(4),S.kc(5,"translate"),S.Wb()),2&t&&(S.Eb(2),S.Pc(S.lc(3,2,"NEWPURCHASES.ATTENTION")),S.Eb(2),S.Qc(": ",S.lc(5,4,"NEWPURCHASES.ITISCONFIGUREDSOTHATTHISPURCHASEDOESNOTAFFECTTHESTOCK"),".\n"))}var pt,dt,ft=function(){return{y:"50px",delay:"300ms"}},bt=function(t){return{value:"*",params:t}},ht=function(){return["/purchases/purchases-by-document/"]},vt=[{path:"",component:(pt=function(){function e(t,a,r,i,c,n,l,u,m){o(this,e),this.servicioUUID=t,this.loader=a,this.snack=r,this.router=i,this.servicioNuevaCompra=c,this.servicioProductos=n,this.servicioEmpresas=l,this.servicioSucursales=u,this.confirmService=m,this.guardando=!1,this.editorProveedor=new s.e(""),this.editorProducto=new s.e(""),this.sucursal="",this.startDate=new s.e,this.endDate=new s.e,this.tiposFactura=["PRODUCTOS","SERVICIOS"],this.form_precio=new s.e(""),this.form_cantidad=new s.e(""),this.form_servicio=new s.e(""),this.form_tipoFactura="",this.form_tipoDocumento="",this.form_precio_final=new s.e(""),this.fecha=new s.e,this.fechacontable=new s.e,this.fechacaicae=new s.e,this.form_numero=new s.e(""),this.form_caicae=new s.e(""),this.form_afectarStock=new s.e(""),this.form_descuento=new s.e(""),this.subtotal=new s.e(""),this.iva=new s.e(""),this.total=new s.e(""),this.form_numero_sucursal=new s.e(""),this.form_acredito=new s.e(""),this.error_iva=!1,this.tipoFacturaBloqueado=!1,this.formModal=function(){var t=this;this.confirmService.confirm({message:"\xbfDesea guardar la compra?"}).subscribe(function(e){if(e){var a,o=1;t.form_sucursal||(t.form_sucursal=t.sucursales_data[0]),a=t.form_sucursal.idsucursal,t.loader.open(),t.servicioNuevaCompra.obtenerDepositoXSucursal(a).subscribe(function(e){o=e[0].DepositoXSucursal,t.loader.close(),null==o?t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3}):(t.guardando=!0,t.generarCompra(a,o))},function(e){t.loader.close(),t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3})})}})},this.sucursal="",this.tiposDocumento=[],this.detalle=[],this.detalleimpuestos=[],this.fechaFiltroInicio=new Date,this.fechaFiltroFin=d().add(1,"days").toDate()}return i(e,[{key:"_filterProveedores",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.proveedores.filter(function(t){return t.srazonsocial.toLowerCase().includes(e)})}return[]}},{key:"displayFnProveedores",value:function(t){return t&&t.srazonsocial?t.srazonsocial:""}},{key:"_filterProductos",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.productos.filter(function(t){return t.snombre.toLowerCase().includes(e)})}return[]}},{key:"displayFnProductos",value:function(t){return t&&t.snombre?t.snombre:""}},{key:"getRowHeight",value:function(t){return 50}},{key:"getCellClass",value:function(t){var e=t.row,a=t.column;return{ngxgroup:e.isGroup,"ngx-alert-success ngx-alert-padding":"status"==a.prop&&e.idTipoDoc&&("F"==e.idTipoDoc[0]||"P"==e.idTipoDoc[0])&&"F"==e.bAnulado,"ngx-alert-danger ngx-alert-padding":"status"==a.prop&&e.idTipoDoc&&"N"==e.idTipoDoc[0]&&"F"==e.bAnulado,"ngx-alert-warning ngx-alert-padding":"status"==a.prop&&e.bAnulado&&"T"==e.bAnulado}}},{key:"tabla1OnActivate",value:function(t){"click"==t.type&&t.row.isGroup&&this.tabla1.setGroup(t.row)}},{key:"ngOnInit",value:function(){var t=this;this.tabla1=new C.a,this.tabla1.groupField="",this.tabla1.secondarySort="",this.tabla1.sum=[],this.tabla1.summaryRow=!1,this.tabla1.emptyRow=!1;var e=new Date;e.setHours(0,0,0,0);var a=new Date;a.setHours(23,59,59,999),this.startDate.setValue(e),this.endDate.setValue(a),this.loader.open(),this.servicioProductos.traerProductos("snombre ASC",function(){t.productos=t.servicioProductos.listaProductos,Object(f.a)([t.servicioEmpresas.obtenerEmpresas(),t.servicioProductos.obtenerProveedores(),t.servicioNuevaCompra.obtenerImpuestos(),t.servicioNuevaCompra.obtenerSucursales()]).subscribe(function(e){t.empresas=e[0],t.cantidaddecimales=t.empresas[0].icantidaddecimales,t.proveedores=e[1],t.impuestos=e[2],t.sucursales_data=e[3],t.filteredProveedores=t.editorProveedor.valueChanges.pipe(Object(b.a)(""),Object(h.a)(function(e){return t._filterProveedores(e)})),t.filteredProductos=t.editorProducto.valueChanges.pipe(Object(b.a)(""),Object(h.a)(function(e){return t._filterProductos(e)})),t.nuevaCompra(),t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"renameKeys",value:function(e,o){var r=Object.keys(e).map(function(t){return a({},o[t]||t,e[t])});return Object.assign.apply(Object,[{}].concat(t(r)))}},{key:"obtenerNombreProveedor",value:function(t){if(this.proveedores)for(var e=0;e<this.proveedores.length;e++)if(this.proveedores[e].id==t)return this.proveedores[e].srazonsocial;return""}},{key:"obtenerNombreProducto",value:function(t,e){for(var a=0;a<this.productos.length;a++)if(this.productos[a].id==t)return this.productos[a].snombre;return e}},{key:"obtenerCodigoProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e].scodproducto;return""}},{key:"cambiarTiposFactura",value:function(){this.form_servicio.setValue("")}},{key:"cambiarProveedor",value:function(t){var e="T"==t.bdeproductos,a="T"==t.bdeservicios;this.tipoFacturaBloqueado=!1,this.form_tipoFactura=this.tiposFactura[0],e&&!a&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[0]),a&&!e&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[1]),this.cargarTiposDocumento(t.scondicioniva,e)}},{key:"cargarTiposDocumento",value:function(t,e){this.tiposDocumento=["Presupuesto de Compra","Nota de Cr\xe9dito Presupuesto de Compra"],this.form_tipoDocumento="Presupuesto de Compra",e&&this.tiposDocumento.push("Remito de Compra"),"Monotributista"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Responsable Inscripto"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra A"),this.tiposDocumento.push("Nota de Cr\xe9dito A"),this.form_tipoDocumento="Factura de Compra A"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Consumidor Final"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C"))}},{key:"buscarProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e];return{}}},{key:"editarItem",value:function(t){this.temp_item=t,this.form_tipoFactura==this.tiposFactura[0]?(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_producto=this.buscarProducto(t.idproducto)):(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_servicio.setValue(t.sconcepto))}},{key:"eliminarItem",value:function(t){var e=this.tabla1.data.indexOf(t);this.tabla1.data.splice(e,1),this.calcular_total(!0),this.tabla1.sortData(),0==this.tabla1.data.length&&this.editorProveedor.enable()}},{key:"guardarItem",value:function(){try{this.form_cantidad.setValue(this.form_cantidad.value?this.form_cantidad.value:1);var t=this.tabla1.data.indexOf(this.temp_item),e=this.form_precio.value,a=this.form_precio_final.value;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento&&(e=parseFloat((a/1.21).toFixed(this.cantidaddecimales))),-1!=t?(this.form_tipoFactura==this.tiposFactura[0]?(this.tabla1.data[t].idproducto=this.form_producto.id,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=this.form_producto.rporciva,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-e),this.tabla1.data[t].sconcepto=this.form_producto.snombre):(this.tabla1.data[t].idproducto=null,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=a,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=21,this.tabla1.data[t].rtotal=a*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(a-e),this.tabla1.data[t].sconcepto=this.form_servicio.value),this.tabla1.data[t].impuesto_iva=this.tabla1.data[t].rporciva/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_dgr=this.tabla1.data[t].rporcdgr/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_interno=this.tabla1.data[t].rvalorimpinterno*this.tabla1.data[t].rcantidad):(this.tabla1.data.push(this.form_tipoFactura==this.tiposFactura[0]?{id:this.servicioUUID.generateUUID(),idproducto:this.form_producto.id,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:e,rporciva:this.form_producto.rporciva,rtotal:this.form_cantidad.value*a,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(a-e),sconcepto:this.form_producto.snombre}:{id:this.servicioUUID.generateUUID(),idproducto:null,rcantidad:this.form_cantidad.value,rpreciou:a,rprecioneto:e,rporciva:21,rtotal:this.form_cantidad.value*a,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(a-e),sconcepto:this.form_servicio.value}),this.tabla1.data[this.tabla1.data.length-1].impuesto_iva=this.tabla1.data[this.tabla1.data.length-1].rporciva/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_dgr=this.tabla1.data[this.tabla1.data.length-1].rporcdgr/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_interno=this.tabla1.data[this.tabla1.data.length-1].rvalorimpinterno*this.tabla1.data[this.tabla1.data.length-1].rcantidad),this.form_precio.setValue(0),this.form_precio_final.setValue(0),this.form_cantidad.setValue(1),this.form_servicio.setValue(""),this.temp_item=null,this.calcular_total(!0),this.tabla1.sortData(),this.editorProveedor.disable()}catch(o){console.error(o)}}},{key:"tipoComprobanteDeCompra",value:function(t){return"Presupuesto de Compra"==t?"PDC":"Remito de Compra"==t?"RMC":"Factura de Compra A"==t?"CCA":"Factura de Compra B"==t?"CCB":"Factura de Compra C"==t?"CCC":"Nota de Cr\xe9dito A"==t?"CNA":"Nota de Cr\xe9dito B"==t?"CNB":"Nota de Cr\xe9dito C"==t?"CNC":"Nota de Cr\xe9dito Presupuesto de Compra"==t?"PSC":void 0}},{key:"querySearch",value:function(t){if(""==t)return this.proveedores;var e=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.proveedores.length;a++){for(var o=this.proveedores[a].srazonsocial.toLowerCase(),r=!0,i=0;i<t.length;i++)if(-1==o.indexOf(t[i])){r=!1;break}r&&e.push(this.proveedores[a])}return e}},{key:"querySearchProducto",value:function(t){if(""==t)return this.productos;var e=[];t=(t=t.toLowerCase()).split(" ");for(var a=0;a<this.productos.length;a++)for(var o=this.productos[a],r=0;r<t.length;r++){var i=t[r];if(-1==o.snombre.toLowerCase().indexOf(i)&&o.scodproducto.toLowerCase()!=i&&o.sean!=i&&o.sean2!=i)break;e.push(this.productos[a])}return e}},{key:"selectedItemChangeProducto",value:function(t){this.form_producto=t,t&&null!=t.rcostou&&this.form_precio.setValue(t.rcostou),this.calcular_precio_neto(),this.calcular_precio_final()}},{key:"calcular_precio_neto",value:function(){var t=this.form_producto;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||(this.form_precio.setValue(parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales))),this.form_precio.setValue(t&&t.rcostou&&t.rporciva&&t.rporcdgr&&null!=t.rvalorimpinterno?parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales)):0))}},{key:"calcular_precio_final",value:function(){var t=this.form_producto;this.form_precio_final.setValue(!t||"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento?this.form_precio.value:parseFloat((this.form_precio.value*(t.rporciva/100+t.rporcdgr/100+1)+t.rvalorimpinterno).toFixed(this.cantidaddecimales)))}},{key:"nuevaCompra",value:function(){var t=new Date;t.setHours(0,0,0,0),this.fecha.setValue(t);var e=new Date;e.setHours(0,0,0,0),this.fechacontable.setValue(e);var a=new Date;a.setHours(0,0,0,0),this.fechacaicae.setValue(d(a).add(10,"days").toDate()),this.tabla1.data=[],this.form_precio.setValue(0),this.form_cantidad.setValue(1),this.form_producto="",this.form_servicio.setValue(""),this.form_tipoFactura=this.tiposFactura[0],this.form_tipoDocumento=this.tiposDocumento[0],this.form_numero.setValue(""),this.form_caicae.setValue(""),this.form_afectarStock.setValue(!1),this.form_descuento.setValue(0),this.form_sucursal=this.sucursales_data[0],this.editorProveedor.setValue(this.proveedores[0]),this.cambiarProveedor(this.proveedores[0]),this.subtotal.setValue(0),this.iva.setValue(0),this.total.setValue(0),this.lista_impuestos=[],this.lista_impuestos=[];for(var o=0;o<this.impuestos.length;o++)this.lista_impuestos.push({id:this.impuestos[o].id,simpuesto:this.impuestos[o].simpuesto,total:0,idempresa:this.impuestos[o].idempresa,rporc:this.impuestos[o].rporc})}},{key:"cancelarCompra",value:function(){}},{key:"fechaAfip",value:function(){var t=this.fechacaicae.value,e=t.getUTCMonth()+1,a=t.getUTCDate(),o=t.getUTCFullYear();return o=e<10?o+"0"+e:o+""+e,a<10?o+"0"+a:o+""+a}},{key:"EsNotaDeCredito",value:function(t){return"CNA"==t||"CNB"==t||"CNC"==t||"CND"==t||"PSC"==t}},{key:"generarCompra",value:function(t,e){var a=this,o={id:this.servicioUUID.generateUUID(),idproveedor:this.editorProveedor.value.id,idtipodoc:this.tipoComprobanteDeCompra(this.form_tipoDocumento),idpv:this.form_numero_sucursal.value?this.form_numero_sucursal.value:1,idnumdoc:this.form_numero.value?this.form_numero.value:0,idsucursal:t,fdocumento:this.fecha.value.toISOString(),fcarga:(new Date).toISOString(),fvencimiento:this.fecha.value.toISOString(),fcontable:this.fechacontable.value.toISOString(),rtotneto:this.subtotal.value,rtotdescuento:this.form_descuento.value,rtotimpuestos:"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?this.iva.value:0,rtotbruto:this.total.value,rtotsaldo:this.form_acredito.value?this.total:0,scondpago:"EFE",banulado:"F",cae:this.form_caicae.value,caefchvto:this.fechaAfip(),bafectarstock:this.form_afectarStock.value?"T":"F",scondventa:this.form_acredito.value?"CRE":"CDO",cncdisponible:0,iaplicstock:this.EsNotaDeCredito(this.tipoComprobanteDeCompra(this.form_tipoDocumento))?-1:1,soperadoranulacion:"",idnctipodoc:"",idncpv:null,idnunumdoc:null,fanulacion:null,facancelacion:null};this.loader.open(),this.servicioNuevaCompra.guardarCompra(o).subscribe(function(o){var r=[],i=o;a.tabla1.data.slice(0).forEach(function(o,c){o.idcompra=i.id,o.idnumlinea=c+1,o.idsucursal=t,o.rimpuestos=o.rimpuestos?o.rimpuestos:0,o.rimpuestos=o.rimpuestos*o.rcantidad,a.form_afectarStock.value&&(o.iddeposito=e),delete o.rtotalneto,delete o.impuesto_iva,delete o.impuesto_dgr,delete o.impuesto_interno,r.push(a.servicioNuevaCompra.guardarCompraItem(o))}),"Factura de Compra A"!=a.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=a.form_tipoDocumento||a.lista_impuestos.forEach(function(e){if(e.total){var o={id:a.servicioUUID.generateUUID(),idcompra:i.id,idimpuesto:e.id,rmonto:e.total,idempresa:e.idempresa,idsucursal:t};r.push(a.servicioNuevaCompra.guardarImpuestos(o))}}),Object(f.a)(r).subscribe(function(t){a.loader.close(),a.snack.open("\xa1Compra Guardada!","OK",{duration:4e3}),a.router.navigateByUrl("purchases/purchases-by-document")},function(t){console.error(t),a.loader.close(),a.snack.open("ERROR al guardar los items o el iva","OK",{duration:4e3})})},function(t){console.error(t),a.loader.close(),a.snack.open("ERROR al guardar la compra","OK",{duration:4e3})})}},{key:"verificar_iva",value:function(){this.error_iva=this.total_impuestos!=this.iva.value}},{key:"calcular_total_impuestos",value:function(){for(var t=0,e=0;e<this.lista_impuestos.length;e++)t+=this.lista_impuestos[e].total;this.total_impuestos=parseFloat(t.toFixed(this.cantidaddecimales)),this.iva.setValue(this.total_impuestos)}},{key:"calcular_total",value:function(t){for(var e=0,a=0,o=0;o<this.tabla1.data.length;o++)e+=this.tabla1.data[o].rtotal,a+=this.tabla1.data[o].rtotalneto;if(t){for(var r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=0;for(o=0;o<this.tabla1.data.length;o++)for(r=0;r<this.lista_impuestos.length;r++){if(this.tabla1.data[o].rporciva==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_iva;break}if(this.tabla1.data[o].rporcdgr==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_dgr;break}if(this.tabla1.data[o].rvalorimpinterno==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[o].impuesto_interno;break}}for(r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=parseFloat(this.lista_impuestos[r].total.toFixed(this.cantidaddecimales))}"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?(this.calcular_total_impuestos(),this.subtotal.setValue(parseFloat(a.toFixed(this.cantidaddecimales)))):(this.subtotal.setValue(parseFloat(e.toFixed(this.cantidaddecimales))),this.iva.setValue(0)),this.total.setValue(parseFloat((this.subtotal.value-this.form_descuento.value+this.iva.value).toFixed(this.cantidaddecimales)))}}]),e}(),pt.\u0275fac=function(t){return new(t||pt)(S.Rb(p.a),S.Rb(m.a),S.Rb(y.a),S.Rb(F.g),S.Rb(E.a),S.Rb(g.a),S.Rb(v.a),S.Rb(_.a),S.Rb(u.a))},pt.\u0275cmp=S.Lb({type:pt,selectors:[["app-new-purchase"]],decls:144,vars:163,consts:[["fxLayout","row wrap"],["appearance","fill","fxFlex","100",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Proveedor","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["appearance","fill","fxFlex","30",1,"m-8","graphic-select-form-field"],[3,"ngModel","ngModelChange"],["fxFlex","25","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_numero_sucursal","matInput","","type","number","max","9999","min","0",3,"formControl"],["name","form_numero","matInput","","type","number","max","99999999","min","0",3,"formControl"],["fxFlex","10",1,"m-8",2,"padding-top","15px"],["name","form_acredito",3,"formControl"],["fxFlex","10","appearance","fill",1,"m-8","graphic-select-form-field"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","color","enableMeridian","disableMinute","hideTime"],["picker",""],["picker2",""],["fxFlex","15","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_caicae","matInput","","type","number","min","0",3,"formControl"],["picker3",""],["appearance","fill","fxFlex","15",1,"m-8","graphic-select-form-field"],[3,"ngModel","disabled","ngModelChange","selectionChange"],["fxFlex","10",1,"m-8",2,"padding-top","15px",3,"hidden"],["name","form_afectarStock",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","15",4,"ngIf"],["name","form_cantidad","matInput","","type","number","min","0",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","50",4,"ngIf"],["class","m-8 graphic-select-form-field","fxFlex","50","appearance","fill",4,"ngIf"],[4,"ngIf"],["name","form_precio","matInput","","type","number","min","0",3,"formControl","change","keyup"],["class","m-8 graphic-select-form-field","fxFlex","10","appearance","fill",4,"ngIf"],["mat-button","","color","primary",1,"m-8",3,"click"],[1,"p-0"],["summaryRow","false",1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","selectionType","activate"],["myTable",""],[3,"cellClass","name","flexGrow"],["ngx-datatable-cell-template",""],[3,"cellClass","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","minWidth"],["class","m-8",4,"ngIf"],["layout-gt-xs","row",4,"ngIf"],[1,"m-8"],["matInput","","type","number","min","0","name","subtotal","aria-label","Subtotal",3,"formControl"],["matInput","","type","number","min","0","name","form_descuento","aria-label","Descuentos",3,"formControl","change","keyup"],["matInput","","type","number","min","0","name","total","aria-label","Total",3,"formControl"],["class","red-400 red-400-fg p-16",4,"ngIf"],["fxFlex","100",1,"mt-16"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"disabled","routerLink"],[3,"value"],["appearance","fill","fxFlex","50",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Producto","matInput","",3,"formControl","matAutocomplete"],["auto2","matAutocomplete"],["fxFlex","50","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_servicio","matInput","","type","text","min","0",3,"formControl"],["readonly","","name","form_precio_final","matInput","","type","number","min","0",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",1,"mr-16",3,"click"],["layout-gt-xs","row"],["class","m-8",4,"ngFor","ngForOf"],["matInput","","type","number","min","0","aria-label","Impuesto",3,"ngModel","ngModelChange","change","keyup"],["matInput","","type","number","min","0","name","iva","aria-label","Impuestos",3,"formControl","change","keyup"],[1,"red-400","red-400-fg","p-16"]],template:function(t,e){if(1&t&&(S.Xb(0,"div"),S.Xb(1,"div",0),S.Xb(2,"mat-form-field",1),S.Xb(3,"mat-label"),S.Oc(4),S.kc(5,"translate"),S.Wb(),S.Sb(6,"input",2),S.Xb(7,"mat-autocomplete",3,4),S.fc("optionSelected",function(t){return e.cambiarProveedor(t.option.value)}),S.Mc(9,T,2,2,"mat-option",5),S.kc(10,"async"),S.Wb(),S.Wb(),S.Wb(),S.Xb(11,"div",6),S.Xb(12,"mat-form-field",7),S.Xb(13,"mat-label"),S.Oc(14),S.kc(15,"translate"),S.Wb(),S.Xb(16,"mat-select",8),S.fc("ngModelChange",function(t){return e.form_tipoDocumento=t}),S.Mc(17,H,2,2,"mat-option",5),S.Wb(),S.Wb(),S.Xb(18,"mat-form-field",9),S.Xb(19,"mat-label"),S.Oc(20),S.kc(21,"translate"),S.Wb(),S.Sb(22,"input",10),S.Wb(),S.Xb(23,"mat-form-field",9),S.Xb(24,"mat-label"),S.Oc(25),S.kc(26,"translate"),S.Wb(),S.Sb(27,"input",11),S.Wb(),S.Xb(28,"div",12),S.Xb(29,"mat-checkbox",13),S.Oc(30),S.kc(31,"translate"),S.Wb(),S.Wb(),S.Wb(),S.Xb(32,"div",6),S.Xb(33,"mat-form-field",14),S.Xb(34,"mat-label"),S.Oc(35),S.kc(36,"translate"),S.Wb(),S.Sb(37,"input",15),S.Sb(38,"mat-datepicker-toggle",16),S.Sb(39,"ngx-mat-datetime-picker",17,18),S.Wb(),S.Xb(41,"mat-form-field",14),S.Xb(42,"mat-label"),S.Oc(43),S.kc(44,"translate"),S.Wb(),S.Sb(45,"input",15),S.Sb(46,"mat-datepicker-toggle",16),S.Sb(47,"ngx-mat-datetime-picker",17,19),S.Wb(),S.Xb(49,"mat-form-field",20),S.Xb(50,"mat-label"),S.Oc(51),S.kc(52,"translate"),S.Wb(),S.Sb(53,"input",21),S.Wb(),S.Xb(54,"mat-form-field",14),S.Xb(55,"mat-label"),S.Oc(56),S.kc(57,"translate"),S.Wb(),S.Sb(58,"input",15),S.Sb(59,"mat-datepicker-toggle",16),S.Sb(60,"ngx-mat-datetime-picker",17,22),S.Wb(),S.Xb(62,"mat-form-field",23),S.Xb(63,"mat-label"),S.Oc(64),S.kc(65,"translate"),S.Wb(),S.Xb(66,"mat-select",24),S.fc("ngModelChange",function(t){return e.form_tipoFactura=t})("selectionChange",function(){return e.cambiarTiposFactura()}),S.Mc(67,j,2,2,"mat-option",5),S.Wb(),S.Wb(),S.Xb(68,"div",25),S.Xb(69,"mat-checkbox",26),S.Oc(70),S.kc(71,"translate"),S.Wb(),S.Wb(),S.Mc(72,L,6,5,"mat-form-field",27),S.Wb(),S.Wb(),S.Xb(73,"div",6),S.Xb(74,"mat-form-field",14),S.Xb(75,"mat-label"),S.Oc(76),S.kc(77,"translate"),S.Wb(),S.Sb(78,"input",28),S.Wb(),S.Mc(79,B,9,9,"mat-form-field",29),S.Mc(80,Q,5,4,"mat-form-field",30),S.Xb(81,"mat-form-field",14),S.Mc(82,q,3,3,"mat-label",31),S.Mc(83,Y,3,3,"mat-label",31),S.Xb(84,"input",32),S.fc("change",function(){return e.calcular_precio_final()})("keyup",function(){return e.calcular_precio_final()}),S.Wb(),S.Wb(),S.Mc(85,z,5,4,"mat-form-field",33),S.Xb(86,"button",34),S.fc("click",function(){return e.guardarItem()}),S.Xb(87,"mat-icon"),S.Oc(88,"save"),S.Wb(),S.Oc(89),S.kc(90,"translate"),S.Wb(),S.Wb(),S.Xb(91,"mat-card",35),S.Xb(92,"mat-card-content",35),S.Xb(93,"ngx-datatable",36,37),S.fc("activate",function(t){return e.tabla1OnActivate(t)}),S.Xb(95,"ngx-datatable-column",38),S.kc(96,"translate"),S.Mc(97,K,2,3,"ng-template",39),S.Wb(),S.Xb(98,"ngx-datatable-column",38),S.kc(99,"translate"),S.Mc(100,J,1,1,"ng-template",39),S.Wb(),S.Mc(101,Z,3,5,"ngx-datatable-column",40),S.Mc(102,et,3,5,"ngx-datatable-column",40),S.Mc(103,ot,3,5,"ngx-datatable-column",40),S.Mc(104,it,3,5,"ngx-datatable-column",40),S.Xb(105,"ngx-datatable-column",41),S.kc(106,"translate"),S.Mc(107,ct,6,0,"ng-template",39),S.Wb(),S.Wb(),S.Wb(),S.Wb(),S.Mc(108,nt,3,3,"h4",42),S.Mc(109,lt,2,1,"div",43),S.Xb(110,"h4",44),S.Oc(111),S.kc(112,"translate"),S.Wb(),S.Xb(113,"div",6),S.Xb(114,"mat-form-field",44),S.Xb(115,"mat-label"),S.Oc(116),S.kc(117,"translate"),S.Wb(),S.Sb(118,"input",45),S.Wb(),S.Xb(119,"mat-form-field",44),S.Xb(120,"mat-label"),S.Oc(121),S.kc(122,"translate"),S.Wb(),S.Xb(123,"input",46),S.fc("change",function(){return e.calcular_total(!0)})("keyup",function(){return e.calcular_total(!0)}),S.Wb(),S.Wb(),S.Mc(124,ut,5,4,"mat-form-field",42),S.Xb(125,"mat-form-field",44),S.Xb(126,"mat-label"),S.Oc(127),S.kc(128,"translate"),S.Wb(),S.Sb(129,"input",47),S.Wb(),S.Wb(),S.Mc(130,mt,6,6,"div",48),S.Xb(131,"div",6),S.Xb(132,"div",49),S.Xb(133,"button",50),S.fc("click",function(){return e.formModal()}),S.Xb(134,"mat-icon"),S.Oc(135,"save"),S.Wb(),S.Oc(136),S.kc(137,"translate"),S.Wb(),S.Sb(138,"span",51),S.Xb(139,"button",52),S.Xb(140,"mat-icon"),S.Oc(141,"cancel"),S.Wb(),S.Oc(142),S.kc(143,"translate"),S.Wb(),S.Wb(),S.Wb()),2&t){var a=S.Ac(8),o=S.Ac(40),r=S.Ac(48),i=S.Ac(61);S.Eb(4),S.Pc(S.lc(5,113,"NEWPURCHASES.SUPPLIER")),S.Eb(2),S.pc("formControl",e.editorProveedor)("matAutocomplete",a),S.Eb(1),S.pc("displayWith",e.displayFnProveedores),S.Eb(2),S.pc("ngForOf",S.lc(10,115,e.filteredProveedores)),S.Eb(5),S.Pc(S.lc(15,117,"NEWPURCHASES.DOCUMENT")),S.Eb(2),S.pc("ngModel",e.form_tipoDocumento),S.Eb(1),S.pc("ngForOf",e.tiposDocumento),S.Eb(3),S.Pc(S.lc(21,119,"NEWPURCHASES.NUMBER(FIRST4DIGITS)")),S.Eb(2),S.pc("formControl",e.form_numero_sucursal),S.Eb(3),S.Pc(S.lc(26,121,"NEWPURCHASES.NUMBER(LAST8DIGITS)")),S.Eb(2),S.pc("formControl",e.form_numero),S.Eb(2),S.pc("formControl",e.form_acredito),S.Eb(1),S.Pc(S.lc(31,123,"NEWPURCHASES.ONCREDIT")),S.Eb(5),S.Pc(S.lc(36,125,"NEWPURCHASES.DATE")),S.Eb(2),S.pc("ngxMatDatetimePicker",o)("formControl",e.fecha),S.Eb(1),S.pc("for",o),S.Eb(1),S.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),S.Eb(4),S.Pc(S.lc(44,127,"NEWPURCHASES.ACCOUNTINGDATE")),S.Eb(2),S.pc("ngxMatDatetimePicker",r)("formControl",e.fechacontable),S.Eb(1),S.pc("for",r),S.Eb(1),S.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),S.Eb(4),S.Pc(S.lc(52,129,"NEWPURCHASES.CAI/CAE")),S.Eb(2),S.pc("formControl",e.form_caicae),S.Eb(3),S.Pc(S.lc(57,131,"NEWPURCHASES.CAI/CAEDATE")),S.Eb(2),S.pc("ngxMatDatetimePicker",i)("formControl",e.fechacaicae),S.Eb(1),S.pc("for",i),S.Eb(1),S.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),S.Eb(4),S.Pc(S.lc(65,133,"NEWPURCHASES.INVOICETYPE")),S.Eb(2),S.pc("ngModel",e.form_tipoFactura)("disabled",e.tabla1.data.length>0||e.tipoFacturaBloqueado),S.Eb(1),S.pc("ngForOf",e.tiposFactura),S.Eb(1),S.pc("hidden",e.form_tipoFactura!=e.tiposFactura[0]),S.Eb(1),S.pc("formControl",e.form_afectarStock),S.Eb(1),S.Pc(S.lc(71,135,"NEWPURCHASES.AFFECTSTOCK")),S.Eb(2),S.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]&&e.form_afectarStock.value),S.Eb(4),S.Pc(S.lc(77,137,"NEWPURCHASES.QUANTITY")),S.Eb(2),S.pc("formControl",e.form_cantidad),S.Eb(1),S.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]),S.Eb(1),S.pc("ngIf",e.form_tipoFactura==e.tiposFactura[1]),S.Eb(2),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),S.Eb(1),S.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),S.Eb(1),S.pc("formControl",e.form_precio),S.Eb(1),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),S.Eb(4),S.Qc("",S.lc(90,139,"NEWPURCHASES.SAVE")," "),S.Eb(2),S.pc("@animate",S.vc(160,bt,S.uc(159,ft))),S.Eb(2),S.pc("columnMode","flex")("headerHeight",50)("footerHeight",50)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",e.tabla1.rows)("selectionType","single"),S.Eb(2),S.qc("name",S.lc(96,141,"NEWPURCHASES.QUANTITY")),S.pc("cellClass",e.getCellClass)("flexGrow",1),S.Eb(3),S.qc("name",S.lc(99,143,"NEWPURCHASES.CONCEPT")),S.pc("cellClass",e.getCellClass)("flexGrow",2),S.Eb(3),S.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),S.Eb(1),S.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),S.Eb(1),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),S.Eb(1),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),S.Eb(1),S.qc("name",S.lc(106,145,"NEWPURCHASES.ACTIONS")),S.pc("flexGrow",1)("minWidth",100),S.Eb(3),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),S.Eb(1),S.pc("ngIf",("Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento)&&0!=e.lista_impuestos.length),S.Eb(2),S.Pc(S.lc(112,147,"NEWPURCHASES.RESUME")),S.Eb(5),S.Pc(S.lc(117,149,"NEWPURCHASES.SUBTOTAL")),S.Eb(2),S.pc("formControl",e.subtotal),S.Eb(3),S.Pc(S.lc(122,151,"NEWPURCHASES.DISCOUNTS")),S.Eb(2),S.pc("formControl",e.form_descuento),S.Eb(1),S.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),S.Eb(3),S.Pc(S.lc(128,153,"NEWPURCHASES.TOTAL")),S.Eb(2),S.pc("formControl",e.total),S.Eb(1),S.pc("ngIf",!e.form_afectarStock.value),S.Eb(3),S.pc("disabled",e.guardando),S.Eb(3),S.Qc("",S.lc(137,155,"NEWPURCHASES.SAVE")," "),S.Eb(3),S.pc("disabled",e.guardando)("routerLink",S.uc(162,ht)),S.Eb(3),S.Qc("",S.lc(143,157,"NEWPURCHASES.CANCEL")," ")}},directives:[k.c,D.c,k.a,D.f,P.b,s.c,x.c,s.o,s.f,x.a,n.n,A.a,s.r,s.s,O.a,W.a,w.h,D.h,W.b,n.o,N.b,I.a,R.a,R.b,X.d,X.b,X.a,F.h,M.n],pipes:[U.c,n.b,n.g,n.d],styles:[""],data:{animation:[l.a]}}),pt),data:{title:"NUEVA COMPRA"}}],Ct=c("u9T3"),gt=c("f44v"),_t=c("iELJ"),Et=c("jMqV"),St=c("M9ds"),yt=c("ZFy/"),Ft=c("PCNd"),kt=c("BxcV"),Dt=c("OaSA"),Pt=((dt=function t(){o(this,t)}).\u0275mod=S.Pb({type:dt}),dt.\u0275inj=S.Ob({factory:function(t){return new(t||dt)},imports:[[n.c,s.t,Ct.a,X.f,P.c,P.c,R.c,P.c,N.c,gt.a,P.c,yt.b,_t.f,y.b,Et.b,St.c,A.b,I.b,U.b,Ft.a,x.b,kt.a,s.j,w.g,W.c,W.e,W.d,O.b,Dt.a,F.k.forChild(vt)]]}),dt)},CHRX:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var c=r("wd/R"),n=function(){function t(){o(this,t),this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.summaryRow=!0,this.emptyRow=!0,this.customFilter=function(t){return t}}return i(t,[{key:"setGroup",value:function(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}},{key:"setData",value:function(t){this.data=t,this.sortData()}},{key:"sortData",value:function(){var t=this;this.data.sort(function(e,a){if(e[t.groupField]==a[t.groupField]){if(t.secondarySort){if(null==e[t.secondarySort])return 1;if(null==a[t.secondarySort])return-1;if(e[t.secondarySort]>a[t.secondarySort])return 1*("desc"===t.sortDir?-1:1);if(e[t.secondarySort]<a[t.secondarySort])return-1*("desc"===t.sortDir?-1:1)}}else{if(null==e[t.groupField])return 1;if(null==a[t.groupField])return-1;if(e[t.groupField]>a[t.groupField])return 1;if(e[t.groupField]<a[t.groupField])return-1}return 0}),this.filterRows()}},{key:"filterRows",value:function(){var t=this,e=[];e=this.data.filter(function(e){for(var a in t.filter){if(t.filter[a]&&null==e[a])return!1;switch(typeof e[a]){case"number":if(t.filter[a]&&Math.trunc(e[a]).toString()!==Math.trunc(t.filter[a]).toString())return!1;break;case"string":if("f"==a.charAt(0).toLowerCase()&&c(e[a]).isValid){if(-1==c(e[a]).format("DD/MM/YYYY HH:mm:ss").indexOf(t.filter[a]))return!1;break}if(-1==e[a].toLowerCase().indexOf(t.filter[a].toLowerCase()))return!1}}return!0}),e=this.customFilter(e);var o={};this.groupField?o[this.groupField]=e.length.toString():o.count=e.length.toString(),this.sum.forEach(function(t){return o[t]=0});for(var r=0;r<e.length;r++)this.sum.forEach(function(t){return o[t]+=e[r][t]});if(o.isGroup=!0,this.footer=o,this.groupField){var i=[];e.forEach(function(e){-1==i.indexOf(e[t.groupField])&&i.push(e[t.groupField])}),i=i.map(function(t){return{name:t,count:1}});var n=[],s=!0,l=0,u=null,m=function(){u&&(u[t.groupField]+=" ("+i[l-1].count.toString()+")")};for(r=0;r<e.length;r++){if(s&&e[r][this.groupField]==i[l].name){var p;m();var d="+";this.groups[i[l].name]&&(d="-"),a(p={},this.groupField,d+" "+i[l].name),a(p,"isGroup",!0),a(p,"name",i[l].name),u=p,this.sum.forEach(function(t){return u[t]=0}),n.push(u),s=++l<i.length}else i[l-1].count++;this.sum.forEach(function(t){return u[t]+=e[r][t]}),n.push(e[r])}m(),e=null,n=n.filter(function(e){return!!e.isGroup||!!t.groups[e[t.groupField]]||void 0}),this.rows=n}else this.rows=e;this.summaryRow&&this.rows.push(this.footer),0==this.rows.length&&this.emptyRow&&this.rows.push({})}},{key:"updateFilter",value:function(t,e){if(t&&e){var a=t.target.value;t instanceof MouseEvent&&(a=""),this.filter[e]=a,this.filterRows()}return!0}},{key:"updateFilterBoolean",value:function(t,e){return this.filter[e]=t,this.filterRows(),!0}}],[{key:"prepararFiltroAPI",value:function(t){var e="";for(var a in t)t[a].search&&(e+="number"==typeof t[a].search?'{"'.concat(a,'":').concat(t[a].search,"},"):t[a].exact?'{"'.concat(a,'":"').concat(t[a].search,'"},'):'{"'.concat(a,'":{"ilike":"%').concat(t[a].search,'%"}},'));return e}}]),t}()},GmJt:function(t,e,a){"use strict";a.d(e,"a",function(){return i});var o=a("GS7A"),r=Object(o.g)([Object(o.l)({opacity:"{{opacity}}",transform:"scale({{scale}}) translate3d({{x}}, {{y}}, {{z}})"}),Object(o.e)("{{duration}} {{delay}} cubic-bezier(0.0, 0.0, 0.2, 1)",Object(o.l)("*"))],{params:{duration:"200ms",delay:"0ms",opacity:"0",scale:"1",x:"0",y:"0",z:"0"}}),i=[Object(o.n)("animate",[Object(o.m)("void => *",[Object(o.o)(r)])]),Object(o.n)("fadeInOut",[Object(o.k)("0",Object(o.l)({opacity:0,display:"none"})),Object(o.k)("1",Object(o.l)({opacity:1,display:"block"})),Object(o.m)("0 => 1",Object(o.e)("300ms")),Object(o.m)("1 => 0",Object(o.e)("300ms"))])]},vpPe:function(t,e,a){"use strict";a.d(e,"a",function(){return c});var r=a("8Y7J"),c=function(){var t=function(){function t(){o(this,t)}return i(t,[{key:"generateUUID",value:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var a=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==e?a:3&a|8).toString(16)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=r.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()}}])}();