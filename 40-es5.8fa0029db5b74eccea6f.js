!function(){function a(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function t(a,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(a,n.key,n)}}function e(a,e,n){return e&&t(a.prototype,e),n&&t(a,n),a}(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{JIvT:function(t,n,o){"use strict";o.r(n),o.d(n,"CheckingAccountStatementModule",function(){return ua});var c,r=o("SVse"),l=o("u9T3"),i=o("s7LF"),s=o("Dxy4"),u=o("PDjf"),b=o("f44v"),d=o("TN/R"),f=o("iELJ"),p=o("Tj54"),g=o("e6WT"),m=o("ZTz/"),h=o("jMqV"),v=o("zHaW"),y=o("M9ds"),C=o("ZFy/"),A=o("iInd"),x=o("TSSN"),k=o("w9WL"),w=o("PCNd"),P=o("GmJt"),E=o("3kSh"),W=o("3sEA"),X=o("wd/R"),M=o("HDdC"),R=o("cp0P"),O=o("bPAe"),I=o("CHRX"),D=o("i59u"),S=o("rbHy"),T=o("AytR"),j=o("8Y7J"),V=o("IheW"),L=((c=function(){function t(e){a(this,t),this.http=e}return e(t,[{key:"obtenerDatos",value:function(a){return Object(R.a)([this.http.get(encodeURI("".concat(T.a.apiURL,"Clientes/obtenerSaldoCliente?idcliente=").concat(a))),this.http.get(encodeURI("".concat(T.a.apiURL,"Clientes/ExtractoCliente?idcliente=").concat(a))),this.http.get(encodeURI("".concat(T.a.apiURL,"Clientes/").concat(a,"/")))])}},{key:"obtenerDatosVenta",value:function(a){return Object(R.a)([this.http.get(encodeURI("".concat(T.a.apiURL,"Ventasitems/DetalleDeVentaPorId?idVenta=").concat(a))),this.http.get(encodeURI("".concat(T.a.apiURL,"Ventas/DetalleDeMovCajaVenta?idVenta=").concat(a))),this.http.get(encodeURI("".concat(T.a.apiURL,"Ventas/").concat(a,"/")))])}},{key:"obtenerVenta",value:function(a){return this.http.get(encodeURI("".concat(T.a.apiURL,"Ventas/").concat(a,"/")))}},{key:"actualizarVenta",value:function(a){return this.http.put(encodeURI("".concat(T.a.apiURL,"Ventas/").concat(a.id,"/")),a)}}]),t}()).\u0275fac=function(a){return new(a||c)(j.bc(V.c))},c.\u0275prov=j.Nb({token:c,factory:c.\u0275fac,providedIn:"root"}),c),H=o("ura0"),U=o("Q2Ze"),F=function(a,t,e){return{"ngx-alert-success":a,"ngx-alert-danger":t,"ngx-alert-warning":e}};function G(a,t){if(1&a){var e=j.Yb();j.Xb(0,"mat-card-content"),j.Xb(1,"p"),j.Xb(2,"b"),j.Oc(3,"Cliente:"),j.Wb(),j.Oc(4),j.Wb(),j.Xb(5,"p"),j.Xb(6,"b"),j.Oc(7,"Saldo:"),j.Wb(),j.Oc(8),j.kc(9,"currency"),j.Wb(),j.Xb(10,"p"),j.Xb(11,"b"),j.Oc(12,"L\xedmite de Cr\xe9dito:"),j.Wb(),j.Oc(13),j.kc(14,"currency"),j.Wb(),j.Xb(15,"p"),j.Xb(16,"b"),j.Oc(17,"Saldo Disponible:"),j.Wb(),j.Oc(18," (Saldo + L\xedmite de Cr\xe9dito) "),j.Xb(19,"span",15),j.Oc(20),j.kc(21,"currency"),j.Wb(),j.Wb(),j.Xb(22,"div",16),j.Xb(23,"p"),j.Xb(24,"b"),j.Oc(25,"Cargar Pago"),j.Wb(),j.Wb(),j.Xb(26,"p"),j.Oc(27,"Ingrese el monto a pagar al lado de cada venta, o sino cargue el total usando el bot\xf3n "),j.Xb(28,"mat-icon"),j.Oc(29,"attach_money"),j.Wb(),j.Oc(30," en Acciones. Para finalizar haga clic en Pagar."),j.Wb(),j.Xb(31,"button",17),j.fc("click",function(){return j.Dc(e),j.jc().pagar()}),j.Xb(32,"mat-icon"),j.Oc(33,"attach_money"),j.Wb(),j.Oc(34),j.kc(35,"translate"),j.Wb(),j.Wb(),j.Wb()}if(2&a){var n=j.jc();j.Eb(4),j.Qc(" ",n.cliente.srazonsocial,""),j.Eb(4),j.Qc(" ",j.lc(9,6,n.saldoCliente.totventas+n.saldoCliente.totmovcaja),""),j.Eb(5),j.Qc(" ",j.lc(14,8,n.saldoCliente.limitecredito),""),j.Eb(6),j.pc("ngClass",j.xc(14,F,n.saldoCliente.saldo>0,n.saldoCliente.saldo<0,0==n.saldoCliente.saldo)),j.Eb(1),j.Pc(j.lc(21,10,n.saldoCliente.saldo)),j.Eb(14),j.Qc("",j.lc(35,12,"Pagar")," ")}}function Y(a,t){}function N(a,t){if(1&a&&(j.Oc(0),j.kc(1,"date")),2&a){var e=t.row;j.Qc(" ",j.mc(1,1,null==e?null:e.fecha,"dd/MM/yyyy HH:mm:ss")," ")}}function Q(a,t){if(1&a&&j.Oc(0),2&a){var e=t.row;j.Qc(" ",null==e?null:e.tipo," ")}}function z(a,t){if(1&a&&(j.Oc(0),j.kc(1,"currency")),2&a){var e=t.row;j.Qc(" ",j.lc(1,1,null==e?null:e.saldo)," ")}}function _(a,t){if(1&a){var e=j.Yb();j.Xb(0,"input",19),j.fc("input",function(a){j.Dc(e);var t=j.jc().row;return j.jc().rowChange(a,t)}),j.Wb()}if(2&a){var n=j.jc().row;j.pc("min",0)("max",null==n?null:n.saldoABS)("value",null==n?null:n.totalAPagar)}}function q(a,t){if(1&a&&j.Mc(0,_,1,3,"input",18),2&a){var e=t.row;j.pc("ngIf",(null==e?null:e.venta)&&(null==e?null:e.saldoABS)>.001)}}function J(a,t){if(1&a){var e=j.Yb();j.Xb(0,"button",21),j.fc("click",function(){j.Dc(e);var a=j.jc().row;return j.jc().cargadoAManoTotal(a)}),j.Xb(1,"mat-icon"),j.Oc(2,"attach_money"),j.Wb(),j.Wb()}}function B(a,t){if(1&a){var e=j.Yb();j.Xb(0,"button",21),j.fc("click",function(){j.Dc(e);var a=j.jc().row;return j.jc().openPopUp(a)}),j.Xb(1,"mat-icon"),j.Oc(2,"info"),j.Wb(),j.Wb()}}function K(a,t){if(1&a&&(j.Mc(0,J,3,0,"button",20),j.Mc(1,B,3,0,"button",20)),2&a){var e=t.row;j.pc("ngIf",(null==e?null:e.venta)&&(null==e?null:e.saldoABS)>.001),j.Eb(1),j.pc("ngIf",!e.isGroup&&e.venta)}}function Z(a,t){if(1&a){var e=j.Yb();j.Xb(0,"button",25),j.fc("click",function(){return j.Dc(e),j.jc(3).export()}),j.Xb(1,"mat-icon"),j.Oc(2,"save_alt"),j.Wb(),j.Oc(3),j.kc(4,"translate"),j.Wb()}2&a&&(j.Eb(3),j.Qc("",j.lc(4,1,"SALES.EXCEL")," "))}function $(a,t){if(1&a&&(j.Xb(0,"div",23),j.Mc(1,Z,5,3,"button",24),j.Wb()),2&a){var e=j.jc(2);j.Eb(1),j.pc("ngIf",e.tabla1.data.length>0)}}function aa(a,t){1&a&&(j.Xb(0,"ngx-datatable-footer"),j.Mc(1,$,2,1,"ng-template",22),j.Wb())}function ta(a,t){if(1&a){var e=j.Yb();j.Xb(0,"mat-form-field",26),j.Xb(1,"input",27),j.fc("keyup",function(a){return j.Dc(e),j.jc().tabla1.updateFilter(a,"fecha")}),j.Wb(),j.Wb()}}function ea(a,t){if(1&a){var e=j.Yb();j.Xb(0,"mat-form-field",26),j.Xb(1,"input",27),j.fc("keyup",function(a){return j.Dc(e),j.jc().tabla1.updateFilter(a,"tipo")}),j.Wb(),j.Wb()}}function na(a,t){if(1&a){var e=j.Yb();j.Xb(0,"mat-form-field",26),j.Xb(1,"input",28),j.fc("keyup",function(a){return j.Dc(e),j.jc().tabla1.updateFilter(a,"saldo")}),j.Wb(),j.Wb()}}function oa(a,t){if(1&a){var e=j.Yb();j.Xb(0,"mat-form-field",26),j.Xb(1,"input",28),j.fc("keyup",function(a){return j.Dc(e),j.jc().tabla1.updateFilter(a,"totalAPagar")}),j.Wb(),j.Wb()}}var ca,ra,la=function(){return{y:"50px",delay:"300ms"}},ia=function(a){return{value:"*",params:a}},sa=[{path:"",component:(ca=function(){function t(e,n,o,c,r,l,i,s){a(this,t),this.dialog=e,this.servicioVentas=n,this.confirmService=o,this.route=c,this.servicioExtractoCliente=r,this.loader=l,this.snack=i,this.servicioExportarExcel=s,this.totalAPagar=0}return e(t,[{key:"ngOnInit",value:function(){this.totalAPagarCargado=0,this.totalAPagarCargadoAMano=0,this.tabla1=new I.a,this.tabla1.groupField="",this.tabla1.secondarySort="fecha",this.tabla1.sum=[],this.tabla1.sortDir="desc",this.refresh()}},{key:"refresh",value:function(){var a=this,t=this.route.snapshot.paramMap.get("id");this.loader.open(),this.servicioExtractoCliente.obtenerDatos(t).subscribe(function(t){a.saldoCliente=t[0][0],a.saldoCliente.saldo=a.saldoCliente.totventas+a.saldoCliente.totmovcaja+a.saldoCliente.limitecredito,a.extractocliente=t[1],a.cliente=t[2],a.totalAPagar=0;var e=a.extractocliente.map(function(t){var e={};return e.id=t.id,e.fecha=t.fecha,e.saldo=t.saldo,e.saldoABS=Math.abs(t.saldo),e.tipo=t.tipo,e.saldo<0&&(a.totalAPagar+=Math.abs(e.saldo)),e.credito="CRE"==t.condventa||"---"==t.condventa,e.venta="---"!=t.condventa,e.element=t,e.totalAPagar=null,e});a.totalAPagar=parseFloat(a.totalAPagar.toFixed(2)),a.tabla1.setData(e),a.loader.close()},function(t){a.loader.close(),a.snack.open("ERROR","OK",{duration:4e3})})}},{key:"getRowHeight",value:function(a){return 50}},{key:"onSort",value:function(a){var t=a.sorts[0];this.tabla1.secondarySort=t.prop,this.tabla1.sortDir=t.dir,this.tabla1.sortData()}},{key:"rowChange",value:function(a,t){a.target.value&&null!=a.target.value?(t.cargadoAMano=a.target.value,t.totalAPagar=parseFloat(a.target.value)):t.totalAPagar=null,this.mostrarTotalAPagar()}},{key:"cargadoAManoTotal",value:function(a){a.cargadoAMano=!0,a.totalAPagar=parseFloat(a.saldoABS.toFixed(2)),this.mostrarTotalAPagar()}},{key:"mostrarTotalAPagar",value:function(){var a=this,t=this.tabla1.data.filter(function(a){return a.saldo<0});this.totalAPagarCargadoAMano=0,t.forEach(function(t){t.cargadoAMano?a.totalAPagarCargadoAMano+=t.totalAPagar:t.totalAPagar=null});var e=this.totalAPagarCargado;t=t.filter(function(a){return e>0&&(e+=a.saldo,a.totalAPagar=Math.abs(a.saldo),e<0&&(a.totalAPagar=Math.abs(a.saldo-e))),a.saldo>0})}},{key:"pagar",value:function(){var a=this;this.totalAPagarCargado||this.totalAPagarCargadoAMano?this.totalAPagarCargado>this.totalAPagar-this.totalAPagarCargadoAMano?alert("Ingrese un monto hasta $"+this.totalAPagar.toString()):this.confirmService.confirm({message:"\xbfConfirma cargar un pago de $".concat(this.totalAPagarCargado+this.totalAPagarCargadoAMano,"?")}).subscribe(function(t){t&&a.cargarPago()}):alert("Ingrese un monto mayor a cero.")}},{key:"cargarPago",value:function(){var a=this,t=this.tabla1.data.filter(function(a){return 0!=a.totalAPagar&&null!=a.totalAPagar});this.loader.open();var e=[];t.forEach(function(t){e.push(new M.a(function(e){a.servicioExtractoCliente.obtenerVenta(t.id).subscribe(function(n){var o=n;o.rtotsaldo=o.rtotsaldo-t.totalAPagar,o.rtotsaldo<.01&&(o.rtotsaldo=0),delete o.insertedon,delete o.updatedon,delete o.deletedon,delete o.fcreacion,delete o.fmodificacion,a.servicioExtractoCliente.actualizarVenta(o).subscribe(function(a){e.next(a),e.complete()},function(a){e.error(a)})},function(a){e.error(a)})}))}),Object(R.a)(e).subscribe(function(t){a.snack.open("\xa1Pagos Cargados!","OK",{duration:4e3}),a.loader.close(),a.refresh()},function(t){a.loader.close(),a.snack.open("ERROR","OK",{duration:4e3})})}},{key:"openPopUp",value:function(){var a=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loader.open(),this.servicioExtractoCliente.obtenerDatosVenta(t.id).subscribe(function(e){a.loader.close();var n="";0!=e[2].idpvcaea&&(n="CAEA no informado.",e[2].fcaeainformado&&(n="CAEA Informado el "+new Date(t.fcaeainformado).toLocaleDateString())),a.dialog.open(D.a,{width:"720px",disableClose:!0,data:{title:"DETALLE DE VENTA",payload:e[2],ventaitems:e[0],ventamovcaja:e[1],sleyendacaea:n}}).afterClosed().subscribe(function(a){})},function(t){a.loader.close(),a.snack.open("ERROR","OK",{duration:4e3})})}},{key:"export",value:function(){var a=this,t=this.tabla1.data.map(function(t){return{Cliente:a.cliente.srazonsocial,Fecha:X(t.fecha).format("DD/MM/YYYY HH:mm:ss"),Tipo:t.tipo,Saldo:t.saldo}});this.servicioExportarExcel.exportExcel(t,"cuenta_corriente_"+this.cliente.srazonsocial,"cuenta_corriente")}},{key:"getCellClass",value:function(a){var t=a.row,e=a.column;return{"ngx-alert-success":t.saldo>0,"ngx-alert-danger":t.saldo<0,"ngx-alert-warning":0==t.saldo,"ngx-alert-padding":"status"==e.prop}}}]),t}(),ca.\u0275fac=function(a){return new(a||ca)(j.Rb(f.b),j.Rb(S.a),j.Rb(E.a),j.Rb(A.a),j.Rb(L),j.Rb(W.a),j.Rb(v.a),j.Rb(O.a))},ca.\u0275cmp=j.Lb({type:ca,selectors:[["app-checking-account-statement"]],decls:32,vars:49,consts:[[4,"ngIf"],[1,"p-0"],[1,"material","expandable","bg-white","ngx-status",2,"height","70vh",3,"scrollbarH","rowHeight","columnMode","headerHeight","footerHeight","scrollbarV","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],["prop","status","name","",3,"cellClass","sortable","flexGrow"],["ngx-datatable-cell-template",""],["prop","fecha",3,"summaryTemplate","name","flexGrow"],["prop","tipo",3,"summaryTemplate","name","flexGrow"],["prop","saldo",3,"cellClass","summaryTemplate","name","flexGrow"],["prop","totalAPagar",3,"summaryTemplate","name","flexGrow"],[3,"name","flexGrow","sortable"],["tabla1fecha",""],["tabla1tipo",""],["tabla1saldo",""],["tabla1totalAPagar",""],[3,"ngClass"],["ng-show","totalAPagar"],["mat-raised-button","","color","primary",3,"click"],["matInput","","placeholder","","type","number","step","any",3,"min","max","value","input",4,"ngIf"],["matInput","","placeholder","","type","number","step","any",3,"min","max","value","input"],["mat-icon-button","","mat-sm-button","","color","foreground","class","mr-16",3,"click",4,"ngIf"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["ngx-datatable-footer-template",""],[1,"p-8",2,"margin-left","auto"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"m-8",3,"click"],[1,"margin-333",2,"width","100%"],["matInput","","placeholder","","value","",3,"keyup"],["type","number","matInput","","placeholder","","value","",3,"keyup"]],template:function(a,t){if(1&a&&(j.Xb(0,"mat-card"),j.Mc(1,G,36,18,"mat-card-content",0),j.Wb(),j.Xb(2,"mat-card",1),j.Xb(3,"mat-card-content",1),j.Xb(4,"ngx-datatable",2,3),j.fc("sort",function(a){return t.onSort(a)}),j.Xb(6,"ngx-datatable-column",4),j.Mc(7,Y,0,0,"ng-template",5),j.Wb(),j.Xb(8,"ngx-datatable-column",6),j.kc(9,"translate"),j.Mc(10,N,2,4,"ng-template",5),j.Wb(),j.Xb(11,"ngx-datatable-column",7),j.kc(12,"translate"),j.Mc(13,Q,1,1,"ng-template",5),j.Wb(),j.Xb(14,"ngx-datatable-column",8),j.kc(15,"translate"),j.Mc(16,z,2,3,"ng-template",5),j.Wb(),j.Xb(17,"ngx-datatable-column",9),j.kc(18,"translate"),j.Mc(19,q,1,1,"ng-template",5),j.Wb(),j.Xb(20,"ngx-datatable-column",10),j.kc(21,"translate"),j.Mc(22,K,2,2,"ng-template",5),j.Wb(),j.Mc(23,aa,2,0,"ngx-datatable-footer",0),j.Wb(),j.Wb(),j.Wb(),j.Mc(24,ta,2,0,"ng-template",null,11,j.Nc),j.Mc(26,ea,2,0,"ng-template",null,12,j.Nc),j.Mc(28,na,2,0,"ng-template",null,13,j.Nc),j.Mc(30,oa,2,0,"ng-template",null,14,j.Nc)),2&a){var e=j.Ac(25),n=j.Ac(27),o=j.Ac(29),c=j.Ac(31);j.pc("@animate",j.vc(44,ia,j.uc(43,la))),j.Eb(1),j.pc("ngIf",t.cliente&&t.saldoCliente),j.Eb(1),j.pc("@animate",j.vc(47,ia,j.uc(46,la))),j.Eb(2),j.pc("scrollbarH",!1)("rowHeight",t.getRowHeight)("columnMode","flex")("headerHeight",50)("footerHeight",100)("scrollbarV",!0)("rows",t.tabla1.rows)("summaryRow",!0)("externalSorting",!0)("selectionType","single"),j.Eb(2),j.pc("cellClass",t.getCellClass)("sortable",!1)("flexGrow",.1),j.Eb(2),j.qc("name",j.lc(9,33,"Fecha")),j.pc("summaryTemplate",e)("flexGrow",1),j.Eb(3),j.qc("name",j.lc(12,35,"Tipo")),j.pc("summaryTemplate",n)("flexGrow",2),j.Eb(3),j.qc("name",j.lc(15,37,"Saldo")),j.pc("cellClass",t.getCellClass)("summaryTemplate",o)("flexGrow",1),j.Eb(3),j.qc("name",j.lc(18,39,"Cargar Pago")),j.pc("summaryTemplate",c)("flexGrow",1),j.Eb(3),j.qc("name",j.lc(21,41,"SALES.ACTIONS")),j.pc("flexGrow",1)("sortable",!1),j.Eb(3),j.pc("ngIf",t.tabla1.data.length>0)}},directives:[u.a,r.o,u.b,k.d,k.b,k.a,r.m,H.a,p.a,s.b,g.b,k.e,k.c,U.c],pipes:[x.c,r.d,r.f],styles:[""],data:{animation:[P.a]}}),ca),data:{title:"Cuenta Corriente"}}],ua=((ra=function t(){a(this,t)}).\u0275mod=j.Pb({type:ra}),ra.\u0275inj=j.Ob({factory:function(a){return new(a||ra)},imports:[[r.c,i.t,l.a,k.f,g.c,g.c,u.c,g.c,s.c,b.a,g.c,C.b,f.f,v.b,h.b,y.c,m.b,p.b,x.b,w.a,d.g,A.k.forChild(sa)]]}),ra)}}])}();