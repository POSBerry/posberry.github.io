(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{Iab2:function(t,a,e){var o,n;void 0===(n="function"==typeof(o=function(){"use strict";function a(t,a,e){var o=new XMLHttpRequest;o.open("GET",t),o.responseType="blob",o.onload=function(){l(o.response,a,e)},o.onerror=function(){console.error("could not download file")},o.send()}function e(t){var a=new XMLHttpRequest;a.open("HEAD",t,!1);try{a.send()}catch(t){}return 200<=a.status&&299>=a.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,r=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,r,l){var c=n.URL||n.webkitURL,i=document.createElement("a");i.download=r=r||t.name||"download",i.rel="noopener","string"==typeof t?(i.href=t,i.origin===location.origin?o(i):e(i.href)?a(t,r,l):o(i,i.target="_blank")):(i.href=c.createObjectURL(t),setTimeout(function(){c.revokeObjectURL(i.href)},4e4),setTimeout(function(){o(i)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,r){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function(t,a){return void 0===a?a={autoBom:!1}:"object"!=typeof a&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,r),n);else if(e(t))a(t,n,r);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout(function(){o(l)})}}:function(t,e,o,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof t)return a(t,e,o);var c="application/octet-stream"===t.type,i=/constructor/i.test(n.HTMLElement)||n.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||c&&i||r)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=s?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=t:location=t,l=null},u.readAsDataURL(t)}else{var b=n.URL||n.webkitURL,d=b.createObjectURL(t);l?l.location=d:location.href=d,l=null,setTimeout(function(){b.revokeObjectURL(d)},4e4)}});n.saveAs=l.saveAs=l,t.exports=l})?o.apply(a,[]):o)||(t.exports=n)},JIvT:function(t,a,e){"use strict";e.r(a),e.d(a,"CheckingAccountStatementModule",function(){return rt});var o=e("SVse"),n=e("u9T3"),r=e("s7LF"),l=e("Dxy4"),c=e("PDjf"),i=e("f44v"),s=e("TN/R"),u=e("iELJ"),b=e("Tj54"),d=e("e6WT"),p=e("ZTz/"),f=e("jMqV"),m=e("zHaW"),g=e("M9ds"),h=e("ZFy/"),v=e("iInd"),w=e("TSSN"),A=e("w9WL"),y=e("PCNd"),x=e("GmJt"),C=e("3kSh"),E=e("3sEA"),P=e("wd/R"),R=e("HDdC"),M=e("cp0P"),k=e("bPAe"),W=e("CHRX"),X=e("i59u"),O=e("rbHy"),T=e("AytR"),S=e("8Y7J"),j=e("IheW");let I=(()=>{class t{constructor(t){this.http=t}obtenerDatos(t){return Object(M.a)([this.http.get(encodeURI(`${T.a.apiURL}Clientes/obtenerSaldoCliente?idcliente=${t}`)),this.http.get(encodeURI(`${T.a.apiURL}Clientes/ExtractoCliente?idcliente=${t}`)),this.http.get(encodeURI(`${T.a.apiURL}Clientes/${t}/`))])}obtenerDatosVenta(t){return Object(M.a)([this.http.get(encodeURI(`${T.a.apiURL}Ventasitems/DetalleDeVentaPorId?idVenta=${t}`)),this.http.get(encodeURI(`${T.a.apiURL}Ventas/DetalleDeMovCajaVenta?idVenta=${t}`)),this.http.get(encodeURI(`${T.a.apiURL}Ventas/${t}/`))])}obtenerVenta(t){return this.http.get(encodeURI(`${T.a.apiURL}Ventas/${t}/`))}actualizarVenta(t){return this.http.put(encodeURI(`${T.a.apiURL}Ventas/${t.id}/`),t)}}return t.\u0275fac=function(a){return new(a||t)(S.bc(j.c))},t.\u0275prov=S.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var D=e("ura0"),L=e("Q2Ze");const U=function(t,a,e){return{"ngx-alert-success":t,"ngx-alert-danger":a,"ngx-alert-warning":e}};function H(t,a){if(1&t){const t=S.Yb();S.Xb(0,"mat-card-content"),S.Xb(1,"p"),S.Xb(2,"b"),S.Oc(3,"Cliente:"),S.Wb(),S.Oc(4),S.Wb(),S.Xb(5,"p"),S.Xb(6,"b"),S.Oc(7,"Saldo:"),S.Wb(),S.Oc(8),S.kc(9,"currency"),S.Wb(),S.Xb(10,"p"),S.Xb(11,"b"),S.Oc(12,"L\xedmite de Cr\xe9dito:"),S.Wb(),S.Oc(13),S.kc(14,"currency"),S.Wb(),S.Xb(15,"p"),S.Xb(16,"b"),S.Oc(17,"Saldo Disponible:"),S.Wb(),S.Oc(18," (Saldo + L\xedmite de Cr\xe9dito) "),S.Xb(19,"span",15),S.Oc(20),S.kc(21,"currency"),S.Wb(),S.Wb(),S.Xb(22,"div",16),S.Xb(23,"p"),S.Xb(24,"b"),S.Oc(25,"Cargar Pago"),S.Wb(),S.Wb(),S.Xb(26,"p"),S.Oc(27,"Ingrese el monto a pagar al lado de cada venta, o sino cargue el total usando el bot\xf3n "),S.Xb(28,"mat-icon"),S.Oc(29,"attach_money"),S.Wb(),S.Oc(30," en Acciones. Para finalizar haga clic en Pagar."),S.Wb(),S.Xb(31,"button",17),S.fc("click",function(){return S.Dc(t),S.jc().pagar()}),S.Xb(32,"mat-icon"),S.Oc(33,"attach_money"),S.Wb(),S.Oc(34),S.kc(35,"translate"),S.Wb(),S.Wb(),S.Wb()}if(2&t){const t=S.jc();S.Eb(4),S.Qc(" ",t.cliente.srazonsocial,""),S.Eb(4),S.Qc(" ",S.lc(9,6,t.saldoCliente.totventas+t.saldoCliente.totmovcaja),""),S.Eb(5),S.Qc(" ",S.lc(14,8,t.saldoCliente.limitecredito),""),S.Eb(6),S.pc("ngClass",S.xc(14,U,t.saldoCliente.saldo>0,t.saldoCliente.saldo<0,0==t.saldoCliente.saldo)),S.Eb(1),S.Pc(S.lc(21,10,t.saldoCliente.saldo)),S.Eb(14),S.Qc("",S.lc(35,12,"Pagar")," ")}}function V(t,a){}function F(t,a){if(1&t&&(S.Oc(0),S.kc(1,"date")),2&t){const t=a.row;S.Qc(" ",S.mc(1,1,null==t?null:t.fecha,"dd/MM/yyyy HH:mm:ss")," ")}}function $(t,a){if(1&t&&S.Oc(0),2&t){const t=a.row;S.Qc(" ",null==t?null:t.tipo," ")}}function G(t,a){if(1&t&&(S.Oc(0),S.kc(1,"currency")),2&t){const t=a.row;S.Qc(" ",S.lc(1,1,null==t?null:t.saldo)," ")}}function Y(t,a){if(1&t){const t=S.Yb();S.Xb(0,"input",19),S.fc("input",function(a){S.Dc(t);const e=S.jc().row;return S.jc().rowChange(a,e)}),S.Wb()}if(2&t){const t=S.jc().row;S.pc("min",0)("max",null==t?null:t.saldoABS)("value",null==t?null:t.totalAPagar)}}function B(t,a){if(1&t&&S.Mc(0,Y,1,3,"input",18),2&t){const t=a.row;S.pc("ngIf",(null==t?null:t.venta)&&(null==t?null:t.saldoABS)>.001)}}function N(t,a){if(1&t){const t=S.Yb();S.Xb(0,"button",21),S.fc("click",function(){S.Dc(t);const a=S.jc().row;return S.jc().cargadoAManoTotal(a)}),S.Xb(1,"mat-icon"),S.Oc(2,"attach_money"),S.Wb(),S.Wb()}}function _(t,a){if(1&t){const t=S.Yb();S.Xb(0,"button",21),S.fc("click",function(){S.Dc(t);const a=S.jc().row;return S.jc().openPopUp(a)}),S.Xb(1,"mat-icon"),S.Oc(2,"info"),S.Wb(),S.Wb()}}function Q(t,a){if(1&t&&(S.Mc(0,N,3,0,"button",20),S.Mc(1,_,3,0,"button",20)),2&t){const t=a.row;S.pc("ngIf",(null==t?null:t.venta)&&(null==t?null:t.saldoABS)>.001),S.Eb(1),S.pc("ngIf",!t.isGroup&&t.venta)}}function q(t,a){if(1&t){const t=S.Yb();S.Xb(0,"button",25),S.fc("click",function(){return S.Dc(t),S.jc(3).export()}),S.Xb(1,"mat-icon"),S.Oc(2,"save_alt"),S.Wb(),S.Oc(3),S.kc(4,"translate"),S.Wb()}2&t&&(S.Eb(3),S.Qc("",S.lc(4,1,"SALES.EXCEL")," "))}function z(t,a){if(1&t&&(S.Xb(0,"div",23),S.Mc(1,q,5,3,"button",24),S.Wb()),2&t){const t=S.jc(2);S.Eb(1),S.pc("ngIf",t.tabla1.data.length>0)}}function J(t,a){1&t&&(S.Xb(0,"ngx-datatable-footer"),S.Mc(1,z,2,1,"ng-template",22),S.Wb())}function K(t,a){if(1&t){const t=S.Yb();S.Xb(0,"mat-form-field",26),S.Xb(1,"input",27),S.fc("keyup",function(a){return S.Dc(t),S.jc().tabla1.updateFilter(a,"fecha")}),S.Wb(),S.Wb()}}function Z(t,a){if(1&t){const t=S.Yb();S.Xb(0,"mat-form-field",26),S.Xb(1,"input",27),S.fc("keyup",function(a){return S.Dc(t),S.jc().tabla1.updateFilter(a,"tipo")}),S.Wb(),S.Wb()}}function tt(t,a){if(1&t){const t=S.Yb();S.Xb(0,"mat-form-field",26),S.Xb(1,"input",28),S.fc("keyup",function(a){return S.Dc(t),S.jc().tabla1.updateFilter(a,"saldo")}),S.Wb(),S.Wb()}}function at(t,a){if(1&t){const t=S.Yb();S.Xb(0,"mat-form-field",26),S.Xb(1,"input",28),S.fc("keyup",function(a){return S.Dc(t),S.jc().tabla1.updateFilter(a,"totalAPagar")}),S.Wb(),S.Wb()}}const et=function(){return{y:"50px",delay:"300ms"}},ot=function(t){return{value:"*",params:t}},nt=[{path:"",component:(()=>{class t{constructor(t,a,e,o,n,r,l,c){this.dialog=t,this.servicioVentas=a,this.confirmService=e,this.route=o,this.servicioExtractoCliente=n,this.loader=r,this.snack=l,this.servicioExportarExcel=c,this.totalAPagar=0}ngOnInit(){this.totalAPagarCargado=0,this.totalAPagarCargadoAMano=0,this.tabla1=new W.a,this.tabla1.groupField="",this.tabla1.secondarySort="fecha",this.tabla1.sum=[],this.tabla1.sortDir="desc",this.refresh()}refresh(){const t=this.route.snapshot.paramMap.get("id");this.loader.open(),this.servicioExtractoCliente.obtenerDatos(t).subscribe(t=>{this.saldoCliente=t[0][0],this.saldoCliente.saldo=this.saldoCliente.totventas+this.saldoCliente.totmovcaja+this.saldoCliente.limitecredito,this.extractocliente=t[1],this.cliente=t[2],this.totalAPagar=0;var a=this.extractocliente.map(t=>{var a={};return a.id=t.id,a.fecha=t.fecha,a.saldo=t.saldo,a.saldoABS=Math.abs(t.saldo),a.tipo=t.tipo,a.saldo<0&&(this.totalAPagar+=Math.abs(a.saldo)),a.credito="CRE"==t.condventa||"---"==t.condventa,a.venta="---"!=t.condventa,a.element=t,a.totalAPagar=null,a});this.totalAPagar=parseFloat(this.totalAPagar.toFixed(2)),this.tabla1.setData(a),this.loader.close()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}getRowHeight(t){return 50}onSort(t){const a=t.sorts[0];this.tabla1.secondarySort=a.prop,this.tabla1.sortDir=a.dir,this.tabla1.sortData()}rowChange(t,a){t.target.value&&null!=t.target.value?(a.cargadoAMano=t.target.value,a.totalAPagar=parseFloat(t.target.value)):a.totalAPagar=null,this.mostrarTotalAPagar()}cargadoAManoTotal(t){t.cargadoAMano=!0,t.totalAPagar=parseFloat(t.saldoABS.toFixed(2)),this.mostrarTotalAPagar()}mostrarTotalAPagar(){var t=this.tabla1.data.filter(t=>t.saldo<0);this.totalAPagarCargadoAMano=0,t.forEach(t=>{t.cargadoAMano?this.totalAPagarCargadoAMano+=t.totalAPagar:t.totalAPagar=null});var a=this.totalAPagarCargado;t=t.filter(t=>(a>0&&(a+=t.saldo,t.totalAPagar=Math.abs(t.saldo),a<0&&(t.totalAPagar=Math.abs(t.saldo-a))),t.saldo>0))}pagar(){this.totalAPagarCargado||this.totalAPagarCargadoAMano?this.totalAPagarCargado>this.totalAPagar-this.totalAPagarCargadoAMano?alert("Ingrese un monto hasta $"+this.totalAPagar.toString()):this.confirmService.confirm({message:`\xbfConfirma cargar un pago de $${this.totalAPagarCargado+this.totalAPagarCargadoAMano}?`}).subscribe(t=>{t&&this.cargarPago()}):alert("Ingrese un monto mayor a cero.")}cargarPago(){var t=this.tabla1.data.filter(t=>0!=t.totalAPagar&&null!=t.totalAPagar);this.loader.open();var a=[];t.forEach(t=>{a.push(new R.a(a=>{this.servicioExtractoCliente.obtenerVenta(t.id).subscribe(e=>{var o=e;o.rtotsaldo=o.rtotsaldo-t.totalAPagar,o.rtotsaldo<.01&&(o.rtotsaldo=0),delete o.insertedon,delete o.updatedon,delete o.deletedon,delete o.fcreacion,delete o.fmodificacion,this.servicioExtractoCliente.actualizarVenta(o).subscribe(t=>{a.next(t),a.complete()},t=>{a.error(t)})},t=>{a.error(t)})}))}),Object(M.a)(a).subscribe(t=>{this.snack.open("\xa1Pagos Cargados!","OK",{duration:4e3}),this.loader.close(),this.refresh()},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}openPopUp(t={}){this.loader.open(),this.servicioExtractoCliente.obtenerDatosVenta(t.id).subscribe(a=>{this.loader.close();var e="";0!=a[2].idpvcaea&&(e="CAEA no informado.",a[2].fcaeainformado&&(e="CAEA Informado el "+new Date(t.fcaeainformado).toLocaleDateString())),this.dialog.open(X.a,{width:"720px",disableClose:!0,data:{title:"DETALLE DE VENTA",payload:a[2],ventaitems:a[0],ventamovcaja:a[1],sleyendacaea:e}}).afterClosed().subscribe(t=>{})},t=>{this.loader.close(),this.snack.open("ERROR","OK",{duration:4e3})})}export(){var t=this.tabla1.data.map(t=>({Cliente:this.cliente.srazonsocial,Fecha:P(t.fecha).format("DD/MM/YYYY HH:mm:ss"),Tipo:t.tipo,Saldo:t.saldo}));this.servicioExportarExcel.exportExcel(t,"cuenta_corriente_"+this.cliente.srazonsocial,"cuenta_corriente")}getCellClass({row:t,column:a}){return{"ngx-alert-success":t.saldo>0,"ngx-alert-danger":t.saldo<0,"ngx-alert-warning":0==t.saldo,"ngx-alert-padding":"status"==a.prop}}}return t.\u0275fac=function(a){return new(a||t)(S.Rb(u.b),S.Rb(O.a),S.Rb(C.a),S.Rb(v.a),S.Rb(I),S.Rb(E.a),S.Rb(m.a),S.Rb(k.a))},t.\u0275cmp=S.Lb({type:t,selectors:[["app-checking-account-statement"]],decls:32,vars:49,consts:[[4,"ngIf"],[1,"p-0"],[1,"material","expandable","bg-white","ngx-status",2,"height","70vh",3,"scrollbarH","rowHeight","columnMode","headerHeight","footerHeight","scrollbarV","rows","summaryRow","externalSorting","selectionType","sort"],["myTable",""],["prop","status","name","",3,"cellClass","sortable","flexGrow"],["ngx-datatable-cell-template",""],["prop","fecha",3,"summaryTemplate","name","flexGrow"],["prop","tipo",3,"summaryTemplate","name","flexGrow"],["prop","saldo",3,"cellClass","summaryTemplate","name","flexGrow"],["prop","totalAPagar",3,"summaryTemplate","name","flexGrow"],[3,"name","flexGrow","sortable"],["tabla1fecha",""],["tabla1tipo",""],["tabla1saldo",""],["tabla1totalAPagar",""],[3,"ngClass"],["ng-show","totalAPagar"],["mat-raised-button","","color","primary",3,"click"],["matInput","","placeholder","","type","number","step","any",3,"min","max","value","input",4,"ngIf"],["matInput","","placeholder","","type","number","step","any",3,"min","max","value","input"],["mat-icon-button","","mat-sm-button","","color","foreground","class","mr-16",3,"click",4,"ngIf"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["ngx-datatable-footer-template",""],[1,"p-8",2,"margin-left","auto"],["mat-raised-button","","class","m-8","color","primary",3,"click",4,"ngIf"],["mat-raised-button","","color","primary",1,"m-8",3,"click"],[1,"margin-333",2,"width","100%"],["matInput","","placeholder","","value","",3,"keyup"],["type","number","matInput","","placeholder","","value","",3,"keyup"]],template:function(t,a){if(1&t&&(S.Xb(0,"mat-card"),S.Mc(1,H,36,18,"mat-card-content",0),S.Wb(),S.Xb(2,"mat-card",1),S.Xb(3,"mat-card-content",1),S.Xb(4,"ngx-datatable",2,3),S.fc("sort",function(t){return a.onSort(t)}),S.Xb(6,"ngx-datatable-column",4),S.Mc(7,V,0,0,"ng-template",5),S.Wb(),S.Xb(8,"ngx-datatable-column",6),S.kc(9,"translate"),S.Mc(10,F,2,4,"ng-template",5),S.Wb(),S.Xb(11,"ngx-datatable-column",7),S.kc(12,"translate"),S.Mc(13,$,1,1,"ng-template",5),S.Wb(),S.Xb(14,"ngx-datatable-column",8),S.kc(15,"translate"),S.Mc(16,G,2,3,"ng-template",5),S.Wb(),S.Xb(17,"ngx-datatable-column",9),S.kc(18,"translate"),S.Mc(19,B,1,1,"ng-template",5),S.Wb(),S.Xb(20,"ngx-datatable-column",10),S.kc(21,"translate"),S.Mc(22,Q,2,2,"ng-template",5),S.Wb(),S.Mc(23,J,2,0,"ngx-datatable-footer",0),S.Wb(),S.Wb(),S.Wb(),S.Mc(24,K,2,0,"ng-template",null,11,S.Nc),S.Mc(26,Z,2,0,"ng-template",null,12,S.Nc),S.Mc(28,tt,2,0,"ng-template",null,13,S.Nc),S.Mc(30,at,2,0,"ng-template",null,14,S.Nc)),2&t){const t=S.Ac(25),e=S.Ac(27),o=S.Ac(29),n=S.Ac(31);S.pc("@animate",S.vc(44,ot,S.uc(43,et))),S.Eb(1),S.pc("ngIf",a.cliente&&a.saldoCliente),S.Eb(1),S.pc("@animate",S.vc(47,ot,S.uc(46,et))),S.Eb(2),S.pc("scrollbarH",!1)("rowHeight",a.getRowHeight)("columnMode","flex")("headerHeight",50)("footerHeight",100)("scrollbarV",!0)("rows",a.tabla1.rows)("summaryRow",!0)("externalSorting",!0)("selectionType","single"),S.Eb(2),S.pc("cellClass",a.getCellClass)("sortable",!1)("flexGrow",.1),S.Eb(2),S.qc("name",S.lc(9,33,"Fecha")),S.pc("summaryTemplate",t)("flexGrow",1),S.Eb(3),S.qc("name",S.lc(12,35,"Tipo")),S.pc("summaryTemplate",e)("flexGrow",2),S.Eb(3),S.qc("name",S.lc(15,37,"Saldo")),S.pc("cellClass",a.getCellClass)("summaryTemplate",o)("flexGrow",1),S.Eb(3),S.qc("name",S.lc(18,39,"Cargar Pago")),S.pc("summaryTemplate",n)("flexGrow",1),S.Eb(3),S.qc("name",S.lc(21,41,"SALES.ACTIONS")),S.pc("flexGrow",1)("sortable",!1),S.Eb(3),S.pc("ngIf",a.tabla1.data.length>0)}},directives:[c.a,o.o,c.b,A.d,A.b,A.a,o.m,D.a,b.a,l.b,d.b,A.e,A.c,L.c],pipes:[w.c,o.d,o.f],styles:[""],data:{animation:[x.a]}}),t})(),data:{title:"Cuenta Corriente"}}];let rt=(()=>{class t{}return t.\u0275mod=S.Pb({type:t}),t.\u0275inj=S.Ob({factory:function(a){return new(a||t)},imports:[[o.c,r.u,n.a,A.f,d.c,d.c,c.c,d.c,l.c,i.a,d.c,h.b,u.f,m.b,f.b,g.c,p.b,b.b,w.b,y.a,s.g,v.k.forChild(nt)]]}),t})()},bPAe:function(t,a,e){"use strict";e.d(a,"a",function(){return l});var o=e("Iab2"),n=e("EUZL"),r=e("8Y7J");let l=(()=>{class t{constructor(){this.fileType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8",this.fileExtension=".xlsx"}exportExcel(t,a,e){const o=n.utils.json_to_sheet(t),r=n.write({Sheets:{[e]:o},SheetNames:[e]},{bookType:"xlsx",type:"array"});this.saveExcelFile(r,a)}saveExcelFile(t,a){const e=new Blob([t],{type:this.fileType});o.saveAs(e,a+this.fileExtension)}}return t.\u0275fac=function(a){return new(a||t)},t.\u0275prov=r.Nb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()}}]);