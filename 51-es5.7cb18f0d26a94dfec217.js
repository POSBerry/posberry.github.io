!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var o=0;o<t.length;o++){var i=t[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function o(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{BqQZ:function(t,i,r){"use strict";r.r(i),r.d(i,"ProductPricesModule",function(){return q});var a,c=r("SVse"),n=r("cp0P"),s=r("Sp5M"),d=r("AytR"),l=r("8Y7J"),u=r("IheW"),b=((a=function(){function t(o){e(this,t),this.http=o}return o(t,[{key:"obtenerFamilias",value:function(){return this.http.get(encodeURI(d.a.apiURL+'Familias?filter={"where":{"deletedon":{"eq":null}}}'))}}]),t}()).\u0275fac=function(e){return new(e||a)(l.bc(u.c))},a.\u0275prov=l.Nb({token:a,factory:a.\u0275fac,providedIn:"root"}),a),h=r("Q2Ze"),f=r("ZTz/"),p=r("s7LF"),g=r("jMqV"),m=r("e6WT"),_=r("UhP/"),v=r("TSSN");function M(e,t){if(1&e&&(l.Xb(0,"mat-option",11),l.Oc(1),l.Wb()),2&e){var o=t.$implicit;l.pc("value",o.id),l.Eb(1),l.Qc(" ",o.sfamilia," ")}}function W(e,t){if(1&e&&(l.Xb(0,"mat-option",11),l.Oc(1),l.Wb()),2&e){var o=t.$implicit;l.pc("value",o.id),l.Eb(1),l.Qc(" ",o.nombre," ")}}function w(e,t){if(1&e&&(l.Xb(0,"mat-option",11),l.Oc(1),l.Wb()),2&e){var o=t.$implicit;l.pc("value",o.id),l.Eb(1),l.Qc(" ",o.valor," ")}}function C(e,t){if(1&e&&(l.Xb(0,"mat-option",11),l.Oc(1),l.Wb()),2&e){var o=t.$implicit;l.pc("value",o.id),l.Eb(1),l.Qc(" ",o.valor," ")}}var X,P,E=[{path:"",component:(X=function(){function t(o,i){e(this,t),this.servicioPrecioProductos=o,this.servicioEmpresas=i,this.editor_redondeo=0,this.editor_margen=30,this.editor_lista_precios=0,this.editor_compras_dias=1,this.editor_costo_dias=1,this.editor_buscar="",this.editor_previsualizar_switch=!0,this.editor_costo_switch=!0,this.precio_base=[{id:0,valor:"Precio de Costo"},{id:1,valor:"Precio de Ultima Compra"},{id:2,valor:"Precio de Venta"}],this.editor_precio_base="0"}return o(t,[{key:"ngOnInit",value:function(){var e=this;Object(n.a)([this.servicioPrecioProductos.obtenerFamilias(),this.servicioEmpresas.obtenerEmpresas()]).subscribe(function(t){e.familias=t[0],e.familias.sort(function(e,t){return e.sfamilia>t.sfamilia?1:e.sfamilia<t.sfamilia?-1:0}),e.familias.length>0&&(e.editor_familia=e.familias[0].id),e.empresas=t[1],e.listadeprecios=[];for(var o=parseInt(e.empresas[0].icantidadlistasdeprecios),i=0;i<o;i++)e.listadeprecios.push({id:i,nombre:"Lista "+(i+1)});e.cantidaddecimales=e.empresas[0].icantidaddecimales,e.redondeo=0==e.empresas[0].icantidaddecimales?[{id:0,valor:10},{id:1,valor:100},{id:2,valor:1e3}]:[{id:0,valor:.1},{id:1,valor:.25},{id:2,valor:.5},{id:3,valor:1},{id:4,valor:2},{id:5,valor:5},{id:6,valor:10}]})}},{key:"redondear",value:function(e,t){return Math.round(e/t)*t}},{key:"precioProducto",value:function(e){var t=0,o=0;switch(this.editor_precio_base){case"0":t=e.CostoU;break;case"1":t=e.UltCompra;break;case"2":t=e.PrecioU}return o=t*(1+this.margenProducto(e)/100),this.editor_redondeo_switch&&this.editor_previsualizar_switch&&(o=this.redondear(o,this.redondeo[this.editor_redondeo].valor)),e.precioproducto=o,e.precioproducto}},{key:"margenProductoReal",value:function(e){var t=0;switch(this.editor_precio_base){case"0":t=e.CostoU;break;case"1":t=e.UltCompra;break;case"2":t=e.PrecioU}return e.margenproductoreal=this.getMargen(t,this.precioProducto(e)),e.margenproductoreal}},{key:"margenProducto",value:function(e){return this.editor_margen_switch&&this.editor_previsualizar_switch?Math.round(this.editor_margen):this.getMargen(e.CostoU,e.PrecioU)}},{key:"getMargen",value:function(e,t){return 0==e&&(e=t),100*(t/e-1)||0}},{key:"refresh_por_costo",value:function(){this.editor_costo_switch&&this.refresh()}},{key:"refresh_por_compras",value:function(){this.editor_compras_switch&&this.refresh()}},{key:"getLengthProductos",value:function(){if(this.productos_filtrados)return this.productos_filtrados.length}},{key:"refresh",value:function(){this.editor_compras_switch&&null!=this.editor_compras_dias&&Math.abs(this.editor_compras_dias),this.editor_costo_switch&&null!=this.editor_costo_dias&&Math.abs(this.editor_costo_dias)}},{key:"filtrar_productos",value:function(){if(this.productos_filtrados=[],""!=this.editor_buscar)var e=this.editor_buscar.toLowerCase();for(var t=0;t<this.productos.length;t++){var o=!0;if(""!=this.editor_buscar){var i=this.productos[t].Proveedor?this.productos[t].Proveedor.toLowerCase():"";o=-1!=(this.productos[t].Codigo+" - "+this.productos[t].Nombre.toLowerCase()+" - "+i).indexOf(e)}o&&this.mostrarProducto(this.productos[t])&&(this.productos_filtrados.push({}),this.productos_filtrados[this.productos_filtrados.length-1]=this.productos[t],this.productos_filtrados[this.productos_filtrados.length-1].cambiar=!0)}}},{key:"mostrarProducto",value:function(e){var t=this.precioProducto(e).toFixed(2);return(e.PrecioU?e.PrecioU:0).toFixed(2)!=t&&t>0}},{key:"guardar_cambios",value:function(){this.err_212=!1,this.guardando=!0,this.texto_guardando="Guardando...",this.cant_guardados=0,this.cambiados=0,this.error_precios=!1}},{key:"guardar_productos",value:function(){}},{key:"editarProducto",value:function(e){}}]),t}(),X.\u0275fac=function(e){return new(e||X)(l.Rb(b),l.Rb(s.a))},X.\u0275cmp=l.Lb({type:X,selectors:[["app-product-prices"]],decls:69,vars:60,consts:[["layout-gt-sm","row"],["layout","column","flex-gt-sm","50",2,"padding","10px"],["appearance","fill"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"ngModel","change","ngModelChange"],[1,"full-width"],["matInput","","type","number","step","1","min","0",3,"ngModel","placeholder","change","ngModelChange"],[2,"text-align","center"],["matInput","","type","number","step","any","min","0","max","100",3,"ngModel","placeholder","ngModelChange"],[3,"ngModel","ngModelChange"],[3,"value"]],template:function(e,t){1&e&&(l.Xb(0,"div",0),l.Xb(1,"div",1),l.Xb(2,"div"),l.Xb(3,"mat-form-field",2),l.Xb(4,"mat-label"),l.Oc(5),l.kc(6,"translate"),l.Wb(),l.Xb(7,"mat-select",3),l.fc("ngModelChange",function(e){return t.editor_familia=e})("selectionChange",function(){return t.filtrar_productos()}),l.Mc(8,M,2,2,"mat-option",4),l.Wb(),l.Wb(),l.Wb(),l.Xb(9,"div"),l.Xb(10,"mat-slide-toggle",5),l.fc("change",function(){return t.refresh()})("ngModelChange",function(e){return t.editor_familia_switch=e}),l.Oc(11),l.kc(12,"translate"),l.Wb(),l.Wb(),l.Xb(13,"div"),l.Xb(14,"mat-slide-toggle",5),l.fc("change",function(){return t.refresh()})("ngModelChange",function(e){return t.editor_compras_switch=e}),l.Oc(15),l.kc(16,"translate"),l.Wb(),l.Xb(17,"mat-form-field",6),l.Xb(18,"input",7),l.fc("change",function(){return t.refresh_por_compras()})("ngModelChange",function(e){return t.editor_compras_dias=e}),l.kc(19,"translate"),l.Wb(),l.Wb(),l.Wb(),l.Xb(20,"div"),l.Xb(21,"mat-slide-toggle",5),l.fc("change",function(){return t.refresh()})("ngModelChange",function(e){return t.editor_costo_switch=e}),l.Oc(22),l.kc(23,"translate"),l.Wb(),l.Xb(24,"mat-form-field",6),l.Xb(25,"input",7),l.fc("change",function(){return t.refresh_por_costo()})("ngModelChange",function(e){return t.editor_costo_dias=e}),l.kc(26,"translate"),l.Wb(),l.Wb(),l.Wb(),l.Xb(27,"div"),l.Xb(28,"mat-form-field",2),l.Xb(29,"mat-label"),l.Oc(30),l.kc(31,"translate"),l.Wb(),l.Xb(32,"mat-select",3),l.fc("ngModelChange",function(e){return t.editor_lista_precios=e})("selectionChange",function(){return t.refresh()}),l.Mc(33,W,2,2,"mat-option",4),l.Wb(),l.Wb(),l.Wb(),l.Wb(),l.Xb(34,"div",1),l.Xb(35,"h3",8),l.Oc(36,"Modificar precios masivamente"),l.Wb(),l.Xb(37,"div"),l.Xb(38,"mat-slide-toggle",5),l.fc("change",function(){return t.filtrar_productos()})("ngModelChange",function(e){return t.editor_margen_switch=e}),l.Oc(39),l.kc(40,"translate"),l.Wb(),l.Xb(41,"mat-form-field",6),l.Xb(42,"input",9),l.fc("ngModelChange",function(e){return t.editor_margen=e}),l.kc(43,"translate"),l.Wb(),l.Wb(),l.Wb(),l.Xb(44,"div"),l.Xb(45,"mat-slide-toggle",5),l.fc("change",function(){return t.filtrar_productos()})("ngModelChange",function(e){return t.editor_redondeo_switch=e}),l.Oc(46),l.kc(47,"translate"),l.Wb(),l.Xb(48,"mat-form-field",2),l.Xb(49,"mat-label"),l.Oc(50),l.kc(51,"translate"),l.Wb(),l.Xb(52,"mat-select",3),l.fc("ngModelChange",function(e){return t.editor_redondeo=e})("selectionChange",function(){return t.filtrar_productos()}),l.Mc(53,w,2,2,"mat-option",4),l.Wb(),l.Wb(),l.Wb(),l.Xb(54,"div"),l.Xb(55,"mat-form-field",2),l.Xb(56,"mat-label"),l.Oc(57),l.kc(58,"translate"),l.Wb(),l.Xb(59,"mat-select",3),l.fc("ngModelChange",function(e){return t.editor_precio_base=e})("selectionChange",function(){return t.filtrar_productos()}),l.Mc(60,C,2,2,"mat-option",4),l.Wb(),l.Wb(),l.Wb(),l.Xb(61,"div"),l.Xb(62,"mat-slide-toggle",10),l.fc("ngModelChange",function(e){return t.editor_precio_costo_switch=e}),l.Oc(63),l.kc(64,"translate"),l.Wb(),l.Wb(),l.Xb(65,"div"),l.Xb(66,"mat-slide-toggle",10),l.fc("ngModelChange",function(e){return t.editor_previsualizar_switch=e}),l.Oc(67),l.kc(68,"translate"),l.Wb(),l.Wb(),l.Wb(),l.Wb()),2&e&&(l.Eb(5),l.Pc(l.lc(6,32,"Familias")),l.Eb(2),l.pc("ngModel",t.editor_familia),l.Eb(1),l.pc("ngForOf",t.familias),l.Eb(2),l.pc("ngModel",t.editor_familia_switch),l.Eb(1),l.Qc(" ",l.lc(12,34,"Solo esta Familia"),""),l.Eb(3),l.pc("ngModel",t.editor_compras_switch),l.Eb(1),l.Qc(" ",l.lc(16,36,"Solo con compras en los \xfaltimos"),""),l.Eb(3),l.qc("placeholder",l.lc(19,38,"D\xedas")),l.pc("ngModel",t.editor_compras_dias),l.Eb(3),l.pc("ngModel",t.editor_costo_switch),l.Eb(1),l.Qc(" ",l.lc(23,40,"Con cambios en el costo en los \xfaltimos"),""),l.Eb(3),l.qc("placeholder",l.lc(26,42,"D\xedas")),l.pc("ngModel",t.editor_costo_dias),l.Eb(5),l.Pc(l.lc(31,44,"Lista de Precios")),l.Eb(2),l.pc("ngModel",t.editor_lista_precios),l.Eb(1),l.pc("ngForOf",t.listadeprecios),l.Eb(5),l.pc("ngModel",t.editor_margen_switch),l.Eb(1),l.Qc(" ",l.lc(40,46,"Cambiar margen de ganancia"),""),l.Eb(3),l.qc("placeholder",l.lc(43,48,"Margen")),l.pc("ngModel",t.editor_margen),l.Eb(3),l.pc("ngModel",t.editor_redondeo_switch),l.Eb(1),l.Qc(" ",l.lc(47,50,"Pol\xedtica de redondeo"),""),l.Eb(4),l.Pc(l.lc(51,52,"Redondear a")),l.Eb(2),l.pc("ngModel",t.editor_redondeo),l.Eb(1),l.pc("ngForOf",t.redondeo),l.Eb(4),l.Pc(l.lc(58,54,"Usar como precio base")),l.Eb(2),l.pc("ngModel",t.editor_precio_base),l.Eb(1),l.pc("ngForOf",t.precio_base),l.Eb(2),l.pc("ngModel",t.editor_precio_costo_switch),l.Eb(1),l.Qc(" ",l.lc(64,56,"Modificar Precio de Costo"),""),l.Eb(3),l.pc("ngModel",t.editor_previsualizar_switch),l.Eb(1),l.Qc(" ",l.lc(68,58,"Previsualizar"),""))},directives:[h.c,h.f,f.a,p.o,p.r,c.n,g.a,m.b,p.s,p.c,_.n],pipes:[v.c],styles:[""]}),X),data:{title:"CAMBIO DE PRECIOS"}}],k=r("iInd"),y=r("u9T3"),O=r("Dxy4"),F=r("PDjf"),U=r("f44v"),Q=r("iELJ"),L=r("Tj54"),x=r("zHaW"),I=r("M9ds"),z=r("ZFy/"),R=r("w9WL"),j=r("PCNd"),S=r("BxcV"),q=((P=function t(){e(this,t)}).\u0275mod=l.Pb({type:P}),P.\u0275inj=l.Ob({factory:function(e){return new(e||P)},imports:[[c.c,p.t,y.a,R.f,m.c,m.c,F.c,m.c,O.c,U.a,m.c,z.b,Q.f,x.b,g.b,I.c,f.b,L.b,v.b,j.a,S.a,p.j,k.k.forChild(E)]]}),P)}}])}();