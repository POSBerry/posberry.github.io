!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,o){if(!t)return;if("string"==typeof t)return e(t,o);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,o)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,a=new Array(e);o<e;o++)a[o]=t[o];return a}function o(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function i(t,e,o){return e&&r(t.prototype,e),o&&r(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{"2Doj":function(e,r,c){"use strict";c.r(r),c.d(r,"NewPurchaseModule",function(){return Wt});var n,s=c("SVse"),l=c("s7LF"),u=c("GmJt"),m=c("3kSh"),p=c("3sEA"),d=c("vpPe"),f=c("wd/R"),b=c("cp0P"),h=c("JX91"),v=c("lJxs"),g=c("Sp5M"),_=c("CHRX"),C=c("qA6C"),y=c("UVsP"),F=c("AytR"),k=c("8Y7J"),D=c("IheW"),w=((n=function(){function t(e){a(this,t),this.http=e}return i(t,[{key:"obtenerImpuestos",value:function(){return this.http.get(F.a.apiURL+'Impuestos?filter={"where":{"deletedon":{"eq":null}}}')}},{key:"obtenerSucursales",value:function(){return this.http.get(F.a.apiURL+'Sucursales?filter={"where":{"deletedon":{"eq":null}},"order":"sdescripcion ASC"}')}},{key:"obtenerDepositoXSucursal",value:function(t){return this.http.get("".concat(F.a.apiURL,"Sucursales/DepositoXSucursal?idsucursal=").concat(t))}},{key:"guardarCompra",value:function(t){return this.http.post(F.a.apiURL+"Compras",t)}},{key:"guardarCompraItem",value:function(t){return this.http.post(F.a.apiURL+"ComprasItems",t)}},{key:"guardarImpuestos",value:function(t){return this.http.post(F.a.apiURL+"ImpuestosXCompra",t)}}]),t}()).\u0275fac=function(t){return new(t||n)(k.bc(D.c))},n.\u0275prov=k.Nb({token:n,factory:n.\u0275fac,providedIn:"root"}),n),O=c("zHaW"),x=c("iInd"),E=c("VDRc"),S=c("Q2Ze"),W=c("e6WT"),X=c("vrAh"),I=c("ZTz/"),A=c("pMoy"),P=c("n1FK"),M=c("TN/R"),R=c("Dxy4"),N=c("Tj54"),j=c("PDjf"),V=c("w9WL"),T=c("UhP/"),U=c("TSSN");function L(t,e){if(1&t&&(k.Xb(0,"mat-option",53),k.Oc(1),k.Wb()),2&t){var o=e.$implicit;k.pc("value",o),k.Eb(1),k.Qc(" ",null==o?null:o.srazonsocial," ")}}function H(t,e){if(1&t&&(k.Xb(0,"mat-option",53),k.Oc(1),k.Wb()),2&t){var o=e.$implicit;k.pc("value",o),k.Eb(1),k.Qc(" ",o," ")}}function G(t,e){if(1&t&&(k.Xb(0,"mat-option",53),k.Oc(1),k.Wb()),2&t){var o=e.$implicit;k.pc("value",o),k.Eb(1),k.Qc(" ",o," ")}}function q(t,e){if(1&t&&(k.Xb(0,"mat-option",53),k.Oc(1),k.Wb()),2&t){var o=e.$implicit;k.pc("value",o),k.Eb(1),k.Qc(" ",o.sdescripcion," ")}}function B(t,e){if(1&t){var o=k.Yb();k.Xb(0,"mat-form-field",23),k.Xb(1,"mat-label"),k.Oc(2),k.kc(3,"translate"),k.Wb(),k.Xb(4,"mat-select",8),k.fc("ngModelChange",function(t){return k.Dc(o),k.jc().form_sucursal=t}),k.Mc(5,q,2,2,"mat-option",5),k.Wb(),k.Wb()}if(2&t){var a=k.jc();k.Eb(2),k.Pc(k.lc(3,3,"Dep\xf3sito de la Sucursal")),k.Eb(2),k.pc("ngModel",a.form_sucursal),k.Eb(1),k.pc("ngForOf",a.sucursales_data)}}function Q(t,e){if(1&t&&(k.Xb(0,"mat-option",53),k.Oc(1),k.Wb()),2&t){var o=e.$implicit;k.pc("value",o),k.Eb(1),k.Rc(" ",null==o?null:o.scodproducto," - ",null==o?null:o.snombre," ")}}function z(t,e){if(1&t){var o=k.Yb();k.Xb(0,"mat-form-field",54),k.Xb(1,"mat-label"),k.Oc(2),k.kc(3,"translate"),k.Wb(),k.Sb(4,"input",55),k.Xb(5,"mat-autocomplete",3,56),k.fc("optionSelected",function(t){return k.Dc(o),k.jc().selectedItemChangeProducto(t.option.value)}),k.Mc(7,Q,2,3,"mat-option",5),k.kc(8,"async"),k.Wb(),k.Wb()}if(2&t){var a=k.Ac(6),r=k.jc();k.Eb(2),k.Pc(k.lc(3,5,"Producto")),k.Eb(2),k.pc("formControl",r.editorProducto)("matAutocomplete",a),k.Eb(1),k.pc("displayWith",r.displayFnProductos),k.Eb(2),k.pc("ngForOf",k.lc(8,7,r.filteredProductos))}}function Y(t,e){if(1&t&&(k.Xb(0,"mat-form-field",57),k.Xb(1,"mat-label"),k.Oc(2,"Detalle"),k.Wb(),k.Sb(3,"input",58),k.Wb()),2&t){var o=k.jc();k.Eb(3),k.pc("formControl",o.form_servicio)}}function K(t,e){1&t&&(k.Xb(0,"mat-label"),k.Oc(1,"Precio Neto"),k.Wb())}function J(t,e){1&t&&(k.Xb(0,"mat-label"),k.Oc(1,"Precio Unitario"),k.Wb())}function $(t,e){if(1&t&&(k.Xb(0,"mat-form-field",14),k.Xb(1,"mat-label"),k.Oc(2,"Precio Final"),k.Wb(),k.Sb(3,"input",59),k.Wb()),2&t){var o=k.jc();k.Eb(3),k.pc("formControl",o.form_precio_final)}}function Z(t,e){if(1&t&&(k.Oc(0),k.kc(1,"number")),2&t){var o=e.row;k.Qc(" ",k.lc(1,1,null==o?null:o.rcantidad)," ")}}function tt(t,e){if(1&t&&k.Oc(0),2&t){var o=e.row;k.Qc(" ",null==o?null:o.sconcepto," ")}}function et(t,e){if(1&t&&(k.Oc(0),k.kc(1,"currency")),2&t){var o=e.row;k.Qc(" ",k.lc(1,1,null==o?null:o.rpreciou)," ")}}function ot(t,e){if(1&t&&(k.Xb(0,"ngx-datatable-column",38),k.kc(1,"translate"),k.Mc(2,et,2,3,"ng-template",39),k.Wb()),2&t){var o=k.jc();k.qc("name",k.lc(1,3,"Precio")),k.pc("cellClass",o.getCellClass)("flexGrow",1)}}function at(t,e){if(1&t&&(k.Oc(0),k.kc(1,"currency")),2&t){var o=e.row;k.Qc(" ",k.lc(1,1,null==o?null:o.rtotal)," ")}}function rt(t,e){if(1&t&&(k.Xb(0,"ngx-datatable-column",38),k.kc(1,"translate"),k.Mc(2,at,2,3,"ng-template",39),k.Wb()),2&t){var o=k.jc();k.qc("name",k.lc(1,3,"Total")),k.pc("cellClass",o.getCellClass)("flexGrow",1)}}function it(t,e){if(1&t&&(k.Oc(0),k.kc(1,"currency")),2&t){var o=e.row;k.Qc(" ",k.lc(1,1,null==o?null:o.rprecioneto)," ")}}function ct(t,e){if(1&t&&(k.Xb(0,"ngx-datatable-column",38),k.kc(1,"translate"),k.Mc(2,it,2,3,"ng-template",39),k.Wb()),2&t){var o=k.jc();k.qc("name",k.lc(1,3,"Precio Neto")),k.pc("cellClass",o.getCellClass)("flexGrow",1)}}function nt(t,e){if(1&t&&(k.Oc(0),k.kc(1,"currency")),2&t){var o=e.row;k.Qc(" ",k.lc(1,1,null==o?null:o.rtotalneto)," ")}}function st(t,e){if(1&t&&(k.Xb(0,"ngx-datatable-column",38),k.kc(1,"translate"),k.Mc(2,nt,2,3,"ng-template",39),k.Wb()),2&t){var o=k.jc();k.qc("name",k.lc(1,3,"Total Neto")),k.pc("cellClass",o.getCellClass)("flexGrow",1)}}function lt(t,e){if(1&t){var o=k.Yb();k.Xb(0,"button",60),k.fc("click",function(){k.Dc(o);var t=e.row;return k.jc().editarItem(t)}),k.Xb(1,"mat-icon"),k.Oc(2,"edit"),k.Wb(),k.Wb(),k.Xb(3,"button",61),k.fc("click",function(){k.Dc(o);var t=e.row;return k.jc().eliminarItem(t)}),k.Xb(4,"mat-icon"),k.Oc(5,"delete"),k.Wb(),k.Wb()}}function ut(t,e){1&t&&(k.Xb(0,"h4",44),k.Oc(1," Impuestos"),k.Wb())}function mt(t,e){if(1&t){var o=k.Yb();k.Xb(0,"mat-form-field",44),k.Xb(1,"mat-label"),k.Oc(2),k.Wb(),k.Xb(3,"input",64),k.fc("ngModelChange",function(t){return e.$implicit.total=t})("change",function(){return k.Dc(o),k.jc(2).calcular_total(!1)})("keyup",function(){return k.Dc(o),k.jc(2).calcular_total(!1)}),k.Wb(),k.Wb()}if(2&t){var a=e.$implicit;k.Eb(2),k.Pc(a.simpuesto),k.Eb(1),k.pc("ngModel",a.total)}}function pt(t,e){if(1&t&&(k.Xb(0,"div",62),k.Mc(1,mt,4,2,"mat-form-field",63),k.Wb()),2&t){var o=k.jc();k.Eb(1),k.pc("ngForOf",o.lista_impuestos)}}function dt(t,e){if(1&t){var o=k.Yb();k.Xb(0,"mat-form-field",44),k.Xb(1,"mat-label"),k.Oc(2,"Impuestos"),k.Wb(),k.Xb(3,"input",65),k.fc("change",function(){return k.Dc(o),k.jc().verificar_iva()})("keyup",function(){return k.Dc(o),k.jc().verificar_iva()}),k.Wb(),k.Wb()}if(2&t){var a=k.jc();k.Eb(3),k.pc("formControl",a.iva)}}function ft(t,e){1&t&&(k.Xb(0,"div",66),k.Xb(1,"b"),k.Oc(2,"Atenci\xf3n"),k.Wb(),k.Oc(3,": esta configurado para que esta compra NO afecte el stock.\n"),k.Wb())}var bt,ht,vt=function(){return{y:"50px",delay:"300ms"}},gt=function(t){return{value:"*",params:t}},_t=function(){return["/purchases/purchases-by-document/"]},Ct=[{path:"",component:(bt=function(){function e(t,o,r,i,c,n,s,u,m){a(this,e),this.servicioUUID=t,this.loader=o,this.snack=r,this.router=i,this.servicioNuevaCompra=c,this.servicioProductos=n,this.servicioEmpresas=s,this.servicioSucursales=u,this.confirmService=m,this.guardando=!1,this.editorProveedor=new l.e(""),this.editorProducto=new l.e(""),this.sucursal="",this.startDate=new l.e,this.endDate=new l.e,this.tiposFactura=["PRODUCTOS","SERVICIOS"],this.form_precio=new l.e(""),this.form_cantidad=new l.e(""),this.form_servicio=new l.e(""),this.form_tipoFactura="",this.form_tipoDocumento="",this.form_precio_final=new l.e(""),this.fecha=new l.e,this.fechacontable=new l.e,this.fechacaicae=new l.e,this.form_numero=new l.e(""),this.form_caicae=new l.e(""),this.form_afectarStock=new l.e(""),this.form_descuento=new l.e(""),this.subtotal=new l.e(""),this.iva=new l.e(""),this.total=new l.e(""),this.form_numero_sucursal=new l.e(""),this.form_acredito=new l.e(""),this.error_iva=!1,this.tipoFacturaBloqueado=!1,this.formModal=function(){var t=this;this.confirmService.confirm({message:"\xbfDesea guardar la compra?"}).subscribe(function(e){if(e){var o,a=1;t.form_sucursal||(t.form_sucursal=t.sucursales_data[0]),o=t.form_sucursal.idsucursal,t.loader.open(),t.servicioNuevaCompra.obtenerDepositoXSucursal(o).subscribe(function(e){a=e[0].DepositoXSucursal,t.loader.close(),null==a?t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3}):(t.guardando=!0,t.generarCompra(o,a))},function(e){t.loader.close(),t.snack.open("ERROR no se pudo obtener el dep\xf3sito","OK",{duration:4e3})})}})},this.sucursal="",this.tiposDocumento=[],this.detalle=[],this.detalleimpuestos=[],this.fechaFiltroInicio=new Date,this.fechaFiltroFin=f().add(1,"days").toDate()}return i(e,[{key:"_filterProveedores",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.proveedores.filter(function(t){return t.srazonsocial.toLowerCase().includes(e)})}return[]}},{key:"displayFnProveedores",value:function(t){return t&&t.srazonsocial?t.srazonsocial:""}},{key:"_filterProductos",value:function(t){if("string"==typeof t){var e=t.toLowerCase();return this.productos.filter(function(t){return t.snombre.toLowerCase().includes(e)})}return[]}},{key:"displayFnProductos",value:function(t){return t&&t.snombre?t.snombre:""}},{key:"getRowHeight",value:function(t){return 50}},{key:"getCellClass",value:function(t){var e=t.row,o=t.column;return{ngxgroup:e.isGroup,"ngx-alert-success ngx-alert-padding":"status"==o.prop&&e.idTipoDoc&&("F"==e.idTipoDoc[0]||"P"==e.idTipoDoc[0])&&"F"==e.bAnulado,"ngx-alert-danger ngx-alert-padding":"status"==o.prop&&e.idTipoDoc&&"N"==e.idTipoDoc[0]&&"F"==e.bAnulado,"ngx-alert-warning ngx-alert-padding":"status"==o.prop&&e.bAnulado&&"T"==e.bAnulado}}},{key:"tabla1OnActivate",value:function(t){"click"==t.type&&t.row.isGroup&&this.tabla1.setGroup(t.row)}},{key:"ngOnInit",value:function(){var t=this;this.tabla1=new _.a,this.tabla1.groupField="",this.tabla1.secondarySort="",this.tabla1.sum=[],this.tabla1.summaryRow=!1,this.tabla1.emptyRow=!1;var e=new Date;e.setHours(0,0,0,0);var o=new Date;o.setHours(23,59,59,999),this.startDate.setValue(e),this.endDate.setValue(o),this.loader.open(),this.servicioProductos.traerProductos("snombre ASC",function(){t.productos=t.servicioProductos.listaProductos,Object(b.a)([t.servicioEmpresas.obtenerEmpresas(),t.servicioProductos.obtenerProveedores(),t.servicioNuevaCompra.obtenerImpuestos(),t.servicioNuevaCompra.obtenerSucursales()]).subscribe(function(e){t.empresas=e[0],t.cantidaddecimales=t.empresas[0].icantidaddecimales,t.proveedores=e[1],t.impuestos=e[2],t.sucursales_data=e[3],t.filteredProveedores=t.editorProveedor.valueChanges.pipe(Object(h.a)(""),Object(v.a)(function(e){return t._filterProveedores(e)})),t.filteredProductos=t.editorProducto.valueChanges.pipe(Object(h.a)(""),Object(v.a)(function(e){return t._filterProductos(e)})),t.nuevaCompra(),t.loader.close()},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})},function(e){t.loader.close(),t.snack.open("ERROR","OK",{duration:4e3})})}},{key:"renameKeys",value:function(e,a){var r=Object.keys(e).map(function(t){return o({},a[t]||t,e[t])});return Object.assign.apply(Object,[{}].concat(t(r)))}},{key:"obtenerNombreProveedor",value:function(t){if(this.proveedores)for(var e=0;e<this.proveedores.length;e++)if(this.proveedores[e].id==t)return this.proveedores[e].srazonsocial;return""}},{key:"obtenerNombreProducto",value:function(t,e){for(var o=0;o<this.productos.length;o++)if(this.productos[o].id==t)return this.productos[o].snombre;return e}},{key:"obtenerCodigoProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e].scodproducto;return""}},{key:"cambiarTiposFactura",value:function(){this.form_servicio.setValue("")}},{key:"cambiarProveedor",value:function(t){var e="T"==t.bdeproductos,o="T"==t.bdeservicios;this.tipoFacturaBloqueado=!1,this.form_tipoFactura=this.tiposFactura[0],e&&!o&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[0]),o&&!e&&(this.tipoFacturaBloqueado=!0,this.form_tipoFactura=this.tiposFactura[1]),this.cargarTiposDocumento(t.scondicioniva,e)}},{key:"cargarTiposDocumento",value:function(t,e){this.tiposDocumento=["Presupuesto de Compra","Nota de Cr\xe9dito Presupuesto de Compra"],this.form_tipoDocumento="Presupuesto de Compra",e&&this.tiposDocumento.push("Remito de Compra"),"Monotributista"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Responsable Inscripto"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra A"),this.tiposDocumento.push("Nota de Cr\xe9dito A"),this.form_tipoDocumento="Factura de Compra A"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C")),"Consumidor Final"==this.empresas[0].scondicioniva&&("Responsable Inscripto"==t&&(this.tiposDocumento.push("Factura de Compra B"),this.tiposDocumento.push("Nota de Cr\xe9dito B"),this.form_tipoDocumento="Factura de Compra B"),"Monotributista"==t&&(this.tiposDocumento.push("Factura de Compra C"),this.tiposDocumento.push("Nota de Cr\xe9dito C"),this.form_tipoDocumento="Factura de Compra C"))}},{key:"buscarProducto",value:function(t){for(var e=0;e<this.productos.length;e++)if(this.productos[e].id==t)return this.productos[e];return{}}},{key:"editarItem",value:function(t){this.temp_item=t,this.form_tipoFactura==this.tiposFactura[0]?(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_producto=this.buscarProducto(t.idproducto)):(this.form_precio.setValue(t.rpreciou),this.form_cantidad.setValue(t.rcantidad),this.form_servicio.setValue(t.sconcepto))}},{key:"eliminarItem",value:function(t){var e=this.tabla1.data.indexOf(t);this.tabla1.data.splice(e,1),this.calcular_total(!0),this.tabla1.sortData(),0==this.tabla1.data.length&&this.editorProveedor.enable()}},{key:"guardarItem",value:function(){try{this.form_cantidad.setValue(this.form_cantidad.value?this.form_cantidad.value:1);var t=this.tabla1.data.indexOf(this.temp_item),e=this.form_precio.value,o=this.form_precio_final.value;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento&&(e=parseFloat((o/1.21).toFixed(this.cantidaddecimales))),-1!=t?(this.form_tipoFactura==this.tiposFactura[0]?(this.tabla1.data[t].idproducto=this.form_producto.id,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=o,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=this.form_producto.rporciva,this.tabla1.data[t].rtotal=o*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(o-e),this.tabla1.data[t].sconcepto=this.form_producto.snombre):(this.tabla1.data[t].idproducto=null,this.tabla1.data[t].rcantidad=this.form_cantidad.value,this.tabla1.data[t].rpreciou=o,this.tabla1.data[t].rprecioneto=e,this.tabla1.data[t].rporciva=21,this.tabla1.data[t].rtotal=o*this.form_cantidad.value,this.tabla1.data[t].rtotalneto=e*this.form_cantidad.value,this.tabla1.data[t].rimpuestos=Math.abs(o-e),this.tabla1.data[t].sconcepto=this.form_servicio.value),this.tabla1.data[t].impuesto_iva=this.tabla1.data[t].rporciva/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_dgr=this.tabla1.data[t].rporcdgr/100*this.tabla1.data[t].rtotalneto,this.tabla1.data[t].impuesto_interno=this.tabla1.data[t].rvalorimpinterno*this.tabla1.data[t].rcantidad):(this.tabla1.data.push(this.form_tipoFactura==this.tiposFactura[0]?{id:this.servicioUUID.generateUUID(),idproducto:this.form_producto.id,rcantidad:this.form_cantidad.value,rpreciou:o,rprecioneto:e,rporciva:this.form_producto.rporciva,rtotal:this.form_cantidad.value*o,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(o-e),sconcepto:this.form_producto.snombre}:{id:this.servicioUUID.generateUUID(),idproducto:null,rcantidad:this.form_cantidad.value,rpreciou:o,rprecioneto:e,rporciva:21,rtotal:this.form_cantidad.value*o,rtotalneto:e*this.form_cantidad.value,rimpuestos:Math.abs(o-e),sconcepto:this.form_servicio.value}),this.tabla1.data[this.tabla1.data.length-1].impuesto_iva=this.tabla1.data[this.tabla1.data.length-1].rporciva/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_dgr=this.tabla1.data[this.tabla1.data.length-1].rporcdgr/100*this.tabla1.data[this.tabla1.data.length-1].rtotalneto,this.tabla1.data[this.tabla1.data.length-1].impuesto_interno=this.tabla1.data[this.tabla1.data.length-1].rvalorimpinterno*this.tabla1.data[this.tabla1.data.length-1].rcantidad),this.form_precio.setValue(0),this.form_precio_final.setValue(0),this.form_cantidad.setValue(1),this.form_servicio.setValue(""),this.temp_item=null,this.calcular_total(!0),this.tabla1.sortData(),this.editorProveedor.disable()}catch(a){console.error(a)}}},{key:"tipoComprobanteDeCompra",value:function(t){return"Presupuesto de Compra"==t?"PDC":"Remito de Compra"==t?"RMC":"Factura de Compra A"==t?"CCA":"Factura de Compra B"==t?"CCB":"Factura de Compra C"==t?"CCC":"Nota de Cr\xe9dito A"==t?"CNA":"Nota de Cr\xe9dito B"==t?"CNB":"Nota de Cr\xe9dito C"==t?"CNC":"Nota de Cr\xe9dito Presupuesto de Compra"==t?"PSC":void 0}},{key:"querySearch",value:function(t){if(""==t)return this.proveedores;var e=[];t=(t=t.toLowerCase()).split(" ");for(var o=0;o<this.proveedores.length;o++){for(var a=this.proveedores[o].srazonsocial.toLowerCase(),r=!0,i=0;i<t.length;i++)if(-1==a.indexOf(t[i])){r=!1;break}r&&e.push(this.proveedores[o])}return e}},{key:"querySearchProducto",value:function(t){if(""==t)return this.productos;var e=[];t=(t=t.toLowerCase()).split(" ");for(var o=0;o<this.productos.length;o++)for(var a=this.productos[o],r=0;r<t.length;r++){var i=t[r];if(-1==a.snombre.toLowerCase().indexOf(i)&&a.scodproducto.toLowerCase()!=i&&a.sean!=i&&a.sean2!=i)break;e.push(this.productos[o])}return e}},{key:"selectedItemChangeProducto",value:function(t){this.form_producto=t,t&&null!=t.rcostou&&this.form_precio.setValue(t.rcostou),this.calcular_precio_neto(),this.calcular_precio_final()}},{key:"calcular_precio_neto",value:function(){var t=this.form_producto;"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento||(this.form_precio.setValue(parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales))),this.form_precio.setValue(t&&t.rcostou&&t.rporciva&&t.rporcdgr&&null!=t.rvalorimpinterno?parseFloat(((t.rcostou-t.rvalorimpinterno)/(t.rporciva/100+t.rporcdgr/100+1)).toFixed(this.cantidaddecimales)):0))}},{key:"calcular_precio_final",value:function(){var t=this.form_producto;this.form_precio_final.setValue(!t||"Factura de Compra A"!=this.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=this.form_tipoDocumento?this.form_precio.value:parseFloat((this.form_precio.value*(t.rporciva/100+t.rporcdgr/100+1)+t.rvalorimpinterno).toFixed(this.cantidaddecimales)))}},{key:"nuevaCompra",value:function(){var t=new Date;t.setHours(0,0,0,0),this.fecha.setValue(t);var e=new Date;e.setHours(0,0,0,0),this.fechacontable.setValue(e);var o=new Date;o.setHours(0,0,0,0),this.fechacaicae.setValue(f(o).add(10,"days").toDate()),this.tabla1.data=[],this.form_precio.setValue(0),this.form_cantidad.setValue(1),this.form_producto="",this.form_servicio.setValue(""),this.form_tipoFactura=this.tiposFactura[0],this.form_tipoDocumento=this.tiposDocumento[0],this.form_numero.setValue(""),this.form_caicae.setValue(""),this.form_afectarStock.setValue(!1),this.form_descuento.setValue(0),this.form_sucursal=this.sucursales_data[0],this.editorProveedor.setValue(this.proveedores[0]),this.cambiarProveedor(this.proveedores[0]),this.subtotal.setValue(0),this.iva.setValue(0),this.total.setValue(0),this.lista_impuestos=[],this.lista_impuestos=[];for(var a=0;a<this.impuestos.length;a++)this.lista_impuestos.push({id:this.impuestos[a].id,simpuesto:this.impuestos[a].simpuesto,total:0,idempresa:this.impuestos[a].idempresa,rporc:this.impuestos[a].rporc})}},{key:"cancelarCompra",value:function(){}},{key:"fechaAfip",value:function(){var t=this.fechacaicae.value,e=t.getUTCMonth()+1,o=t.getUTCDate(),a=t.getUTCFullYear();return a=e<10?a+"0"+e:a+""+e,o<10?a+"0"+o:a+""+o}},{key:"EsNotaDeCredito",value:function(t){return"CNA"==t||"CNB"==t||"CNC"==t||"CND"==t||"PSC"==t}},{key:"generarCompra",value:function(t,e){var o=this,a={id:this.servicioUUID.generateUUID(),idproveedor:this.editorProveedor.value.id,idtipodoc:this.tipoComprobanteDeCompra(this.form_tipoDocumento),idpv:this.form_numero_sucursal.value?this.form_numero_sucursal.value:1,idnumdoc:this.form_numero.value?this.form_numero.value:0,idsucursal:t,fdocumento:this.fecha.value.toISOString(),fcarga:(new Date).toISOString(),fvencimiento:this.fecha.value.toISOString(),fcontable:this.fechacontable.value.toISOString(),rtotneto:this.subtotal.value,rtotdescuento:this.form_descuento.value,rtotimpuestos:"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?this.iva.value:0,rtotbruto:this.total.value,rtotsaldo:this.form_acredito.value?this.total:0,scondpago:"EFE",banulado:"F",cae:this.form_caicae.value,caefchvto:this.fechaAfip(),bafectarstock:this.form_afectarStock.value?"T":"F",scondventa:this.form_acredito.value?"CRE":"CDO",cncdisponible:0,iaplicstock:this.EsNotaDeCredito(this.tipoComprobanteDeCompra(this.form_tipoDocumento))?-1:1,soperadoranulacion:"",idnctipodoc:"",idncpv:null,idnunumdoc:null,fanulacion:null,facancelacion:null};this.loader.open(),this.servicioNuevaCompra.guardarCompra(a).subscribe(function(a){var r=[],i=a;o.tabla1.data.slice(0).forEach(function(a,c){a.idcompra=i.id,a.idnumlinea=c+1,a.idsucursal=t,a.rimpuestos=a.rimpuestos?a.rimpuestos:0,a.rimpuestos=a.rimpuestos*a.rcantidad,o.form_afectarStock.value&&(a.iddeposito=e),delete a.rtotalneto,delete a.impuesto_iva,delete a.impuesto_dgr,delete a.impuesto_interno,r.push(o.servicioNuevaCompra.guardarCompraItem(a))}),"Factura de Compra A"!=o.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=o.form_tipoDocumento||o.lista_impuestos.forEach(function(e){if(e.total){var a={id:o.servicioUUID.generateUUID(),idcompra:i.id,idimpuesto:e.id,rmonto:e.total,idempresa:e.idempresa,idsucursal:t};r.push(o.servicioNuevaCompra.guardarImpuestos(a))}}),Object(b.a)(r).subscribe(function(t){o.loader.close(),o.snack.open("\xa1Compra Guardada!","OK",{duration:4e3}),o.router.navigateByUrl("purchases/purchases-by-document")},function(t){console.error(t),o.loader.close(),o.snack.open("ERROR al guardar los items o el iva","OK",{duration:4e3})})},function(t){console.error(t),o.loader.close(),o.snack.open("ERROR al guardar la compra","OK",{duration:4e3})})}},{key:"verificar_iva",value:function(){this.error_iva=this.total_impuestos!=this.iva.value}},{key:"calcular_total_impuestos",value:function(){for(var t=0,e=0;e<this.lista_impuestos.length;e++)t+=this.lista_impuestos[e].total;this.total_impuestos=parseFloat(t.toFixed(this.cantidaddecimales)),this.iva.setValue(this.total_impuestos)}},{key:"calcular_total",value:function(t){for(var e=0,o=0,a=0;a<this.tabla1.data.length;a++)e+=this.tabla1.data[a].rtotal,o+=this.tabla1.data[a].rtotalneto;if(t){for(var r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=0;for(a=0;a<this.tabla1.data.length;a++)for(r=0;r<this.lista_impuestos.length;r++){if(this.tabla1.data[a].rporciva==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[a].impuesto_iva;break}if(this.tabla1.data[a].rporcdgr==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[a].impuesto_dgr;break}if(this.tabla1.data[a].rvalorimpinterno==this.lista_impuestos[r].rporc){this.lista_impuestos[r].total+=this.tabla1.data[a].impuesto_interno;break}}for(r=0;r<this.lista_impuestos.length;r++)this.lista_impuestos[r].total=parseFloat(this.lista_impuestos[r].total.toFixed(this.cantidaddecimales))}"Factura de Compra A"==this.form_tipoDocumento||"Nota de Cr\xe9dito A"==this.form_tipoDocumento?(this.calcular_total_impuestos(),this.subtotal.setValue(parseFloat(o.toFixed(this.cantidaddecimales)))):(this.subtotal.setValue(parseFloat(e.toFixed(this.cantidaddecimales))),this.iva.setValue(0)),this.total.setValue(parseFloat((this.subtotal.value-this.form_descuento.value+this.iva.value).toFixed(this.cantidaddecimales)))}}]),e}(),bt.\u0275fac=function(t){return new(t||bt)(k.Rb(d.a),k.Rb(p.a),k.Rb(O.a),k.Rb(x.g),k.Rb(w),k.Rb(C.a),k.Rb(g.a),k.Rb(y.a),k.Rb(m.a))},bt.\u0275cmp=k.Lb({type:bt,selectors:[["app-new-purchase"]],decls:134,vars:133,consts:[["fxLayout","row wrap"],["appearance","fill","fxFlex","100",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Proveedor","matInput","",3,"formControl","matAutocomplete"],[3,"displayWith","optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["fxLayout","row wrap","fxLayout.lt-sm","column"],["appearance","fill","fxFlex","30",1,"m-8","graphic-select-form-field"],[3,"ngModel","ngModelChange"],["fxFlex","25","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_numero_sucursal","matInput","","type","number","max","9999","min","0",3,"formControl"],["name","form_numero","matInput","","type","number","max","99999999","min","0",3,"formControl"],["fxFlex","10",1,"m-8",2,"padding-top","15px"],["name","form_acredito",3,"formControl"],["fxFlex","10","appearance","fill",1,"m-8","graphic-select-form-field"],["matInput","",3,"ngxMatDatetimePicker","formControl"],["matSuffix","",3,"for"],[3,"showSpinners","showSeconds","stepHour","stepMinute","stepSecond","touchUi","color","enableMeridian","disableMinute","hideTime"],["picker",""],["picker2",""],["fxFlex","15","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_caicae","matInput","","type","number","min","0",3,"formControl"],["picker3",""],["appearance","fill","fxFlex","15",1,"m-8","graphic-select-form-field"],[3,"ngModel","disabled","ngModelChange","selectionChange"],["fxFlex","10",1,"m-8",2,"padding-top","15px",3,"hidden"],["name","form_afectarStock",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","15",4,"ngIf"],["name","form_cantidad","matInput","","type","number","min","0",3,"formControl"],["class","m-8 graphic-select-form-field","appearance","fill","fxFlex","50",4,"ngIf"],["class","m-8 graphic-select-form-field","fxFlex","50","appearance","fill",4,"ngIf"],[4,"ngIf"],["name","form_precio","matInput","","type","number","min","0",3,"formControl","change","keyup"],["class","m-8 graphic-select-form-field","fxFlex","10","appearance","fill",4,"ngIf"],["mat-button","","color","primary",1,"m-8",3,"click"],[1,"p-0"],["summaryRow","false",1,"material","expandable","bg-white",2,"height","70vh",3,"columnMode","headerHeight","footerHeight","rowHeight","scrollbarV","scrollbarH","rows","selectionType","activate"],["myTable",""],[3,"cellClass","name","flexGrow"],["ngx-datatable-cell-template",""],[3,"cellClass","name","flexGrow",4,"ngIf"],[3,"name","flexGrow","minWidth"],["class","m-8",4,"ngIf"],["layout-gt-xs","row",4,"ngIf"],[1,"m-8"],["matInput","","type","number","min","0","name","subtotal","aria-label","Subtotal",3,"formControl"],["matInput","","type","number","min","0","name","form_descuento","aria-label","Descuentos",3,"formControl","change","keyup"],["matInput","","type","number","min","0","name","total","aria-label","Total",3,"formControl"],["class","red-400 red-400-fg p-16",4,"ngIf"],["fxFlex","100",1,"mt-16"],["mat-raised-button","","color","primary",3,"disabled","click"],["fxFlex",""],["mat-button","","color","warn","type","button",3,"disabled","routerLink"],[3,"value"],["appearance","fill","fxFlex","50",1,"m-8","graphic-select-form-field"],["type","text","aria-label","Producto","matInput","",3,"formControl","matAutocomplete"],["auto2","matAutocomplete"],["fxFlex","50","appearance","fill",1,"m-8","graphic-select-form-field"],["name","form_servicio","matInput","","type","text","min","0",3,"formControl"],["readonly","","name","form_precio_final","matInput","","type","number","min","0",3,"formControl"],["mat-icon-button","","mat-sm-button","","color","foreground",1,"mr-16",3,"click"],["mat-icon-button","","mat-sm-button","","color","warn",1,"mr-16",3,"click"],["layout-gt-xs","row"],["class","m-8",4,"ngFor","ngForOf"],["matInput","","type","number","min","0","aria-label","Impuesto",3,"ngModel","ngModelChange","change","keyup"],["matInput","","type","number","min","0","name","iva","aria-label","Impuestos",3,"formControl","change","keyup"],[1,"red-400","red-400-fg","p-16"]],template:function(t,e){if(1&t&&(k.Xb(0,"div"),k.Xb(1,"div",0),k.Xb(2,"mat-form-field",1),k.Xb(3,"mat-label"),k.Oc(4),k.kc(5,"translate"),k.Wb(),k.Sb(6,"input",2),k.Xb(7,"mat-autocomplete",3,4),k.fc("optionSelected",function(t){return e.cambiarProveedor(t.option.value)}),k.Mc(9,L,2,2,"mat-option",5),k.kc(10,"async"),k.Wb(),k.Wb(),k.Wb(),k.Xb(11,"div",6),k.Xb(12,"mat-form-field",7),k.Xb(13,"mat-label"),k.Oc(14),k.kc(15,"translate"),k.Wb(),k.Xb(16,"mat-select",8),k.fc("ngModelChange",function(t){return e.form_tipoDocumento=t}),k.Mc(17,H,2,2,"mat-option",5),k.Wb(),k.Wb(),k.Xb(18,"mat-form-field",9),k.Xb(19,"mat-label"),k.Oc(20,"N\xfamero (primeros 4 d\xedgitos)"),k.Wb(),k.Sb(21,"input",10),k.Wb(),k.Xb(22,"mat-form-field",9),k.Xb(23,"mat-label"),k.Oc(24,"N\xfamero (\xfaltimos 8 d\xedgitos)"),k.Wb(),k.Sb(25,"input",11),k.Wb(),k.Xb(26,"div",12),k.Xb(27,"mat-checkbox",13),k.Oc(28,"A Cr\xe9dito"),k.Wb(),k.Wb(),k.Wb(),k.Xb(29,"div",6),k.Xb(30,"mat-form-field",14),k.Xb(31,"mat-label"),k.Oc(32),k.kc(33,"translate"),k.Wb(),k.Sb(34,"input",15),k.Sb(35,"mat-datepicker-toggle",16),k.Sb(36,"ngx-mat-datetime-picker",17,18),k.Wb(),k.Xb(38,"mat-form-field",14),k.Xb(39,"mat-label"),k.Oc(40),k.kc(41,"translate"),k.Wb(),k.Sb(42,"input",15),k.Sb(43,"mat-datepicker-toggle",16),k.Sb(44,"ngx-mat-datetime-picker",17,19),k.Wb(),k.Xb(46,"mat-form-field",20),k.Xb(47,"mat-label"),k.Oc(48,"CAI/CAE"),k.Wb(),k.Sb(49,"input",21),k.Wb(),k.Xb(50,"mat-form-field",14),k.Xb(51,"mat-label"),k.Oc(52),k.kc(53,"translate"),k.Wb(),k.Sb(54,"input",15),k.Sb(55,"mat-datepicker-toggle",16),k.Sb(56,"ngx-mat-datetime-picker",17,22),k.Wb(),k.Xb(58,"mat-form-field",23),k.Xb(59,"mat-label"),k.Oc(60),k.kc(61,"translate"),k.Wb(),k.Xb(62,"mat-select",24),k.fc("ngModelChange",function(t){return e.form_tipoFactura=t})("selectionChange",function(){return e.cambiarTiposFactura()}),k.Mc(63,G,2,2,"mat-option",5),k.Wb(),k.Wb(),k.Xb(64,"div",25),k.Xb(65,"mat-checkbox",26),k.Oc(66,"Afectar Stock"),k.Wb(),k.Wb(),k.Mc(67,B,6,5,"mat-form-field",27),k.Wb(),k.Wb(),k.Xb(68,"div",6),k.Xb(69,"mat-form-field",14),k.Xb(70,"mat-label"),k.Oc(71,"Cantidad"),k.Wb(),k.Sb(72,"input",28),k.Wb(),k.Mc(73,z,9,9,"mat-form-field",29),k.Mc(74,Y,4,1,"mat-form-field",30),k.Xb(75,"mat-form-field",14),k.Mc(76,K,2,0,"mat-label",31),k.Mc(77,J,2,0,"mat-label",31),k.Xb(78,"input",32),k.fc("change",function(){return e.calcular_precio_final()})("keyup",function(){return e.calcular_precio_final()}),k.Wb(),k.Wb(),k.Mc(79,$,4,1,"mat-form-field",33),k.Xb(80,"button",34),k.fc("click",function(){return e.guardarItem()}),k.Xb(81,"mat-icon"),k.Oc(82,"save"),k.Wb(),k.Oc(83),k.kc(84,"translate"),k.Wb(),k.Wb(),k.Xb(85,"mat-card",35),k.Xb(86,"mat-card-content",35),k.Xb(87,"ngx-datatable",36,37),k.fc("activate",function(t){return e.tabla1OnActivate(t)}),k.Xb(89,"ngx-datatable-column",38),k.kc(90,"translate"),k.Mc(91,Z,2,3,"ng-template",39),k.Wb(),k.Xb(92,"ngx-datatable-column",38),k.kc(93,"translate"),k.Mc(94,tt,1,1,"ng-template",39),k.Wb(),k.Mc(95,ot,3,5,"ngx-datatable-column",40),k.Mc(96,rt,3,5,"ngx-datatable-column",40),k.Mc(97,ct,3,5,"ngx-datatable-column",40),k.Mc(98,st,3,5,"ngx-datatable-column",40),k.Xb(99,"ngx-datatable-column",41),k.kc(100,"translate"),k.Mc(101,lt,6,0,"ng-template",39),k.Wb(),k.Wb(),k.Wb(),k.Wb(),k.Mc(102,ut,2,0,"h4",42),k.Mc(103,pt,2,1,"div",43),k.Xb(104,"h4",44),k.Oc(105,"Resumen"),k.Wb(),k.Xb(106,"div",6),k.Xb(107,"mat-form-field",44),k.Xb(108,"mat-label"),k.Oc(109,"Subtotal"),k.Wb(),k.Sb(110,"input",45),k.Wb(),k.Xb(111,"mat-form-field",44),k.Xb(112,"mat-label"),k.Oc(113,"Descuentos"),k.Wb(),k.Xb(114,"input",46),k.fc("change",function(){return e.calcular_total(!0)})("keyup",function(){return e.calcular_total(!0)}),k.Wb(),k.Wb(),k.Mc(115,dt,4,1,"mat-form-field",42),k.Xb(116,"mat-form-field",44),k.Xb(117,"mat-label"),k.Oc(118,"Total"),k.Wb(),k.Sb(119,"input",47),k.Wb(),k.Wb(),k.Mc(120,ft,4,0,"div",48),k.Xb(121,"div",6),k.Xb(122,"div",49),k.Xb(123,"button",50),k.fc("click",function(){return e.formModal()}),k.Xb(124,"mat-icon"),k.Oc(125,"save"),k.Wb(),k.Oc(126),k.kc(127,"translate"),k.Wb(),k.Sb(128,"span",51),k.Xb(129,"button",52),k.Xb(130,"mat-icon"),k.Oc(131,"cancel"),k.Wb(),k.Oc(132),k.kc(133,"translate"),k.Wb(),k.Wb(),k.Wb()),2&t){var o=k.Ac(8),a=k.Ac(37),r=k.Ac(45),i=k.Ac(57);k.Eb(4),k.Pc(k.lc(5,103,"Proveedor")),k.Eb(2),k.pc("formControl",e.editorProveedor)("matAutocomplete",o),k.Eb(1),k.pc("displayWith",e.displayFnProveedores),k.Eb(2),k.pc("ngForOf",k.lc(10,105,e.filteredProveedores)),k.Eb(5),k.Pc(k.lc(15,107,"Documento")),k.Eb(2),k.pc("ngModel",e.form_tipoDocumento),k.Eb(1),k.pc("ngForOf",e.tiposDocumento),k.Eb(4),k.pc("formControl",e.form_numero_sucursal),k.Eb(4),k.pc("formControl",e.form_numero),k.Eb(2),k.pc("formControl",e.form_acredito),k.Eb(5),k.Pc(k.lc(33,109,"Fecha")),k.Eb(2),k.pc("ngxMatDatetimePicker",a)("formControl",e.fecha),k.Eb(1),k.pc("for",a),k.Eb(1),k.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),k.Eb(4),k.Pc(k.lc(41,111,"Fecha Contable")),k.Eb(2),k.pc("ngxMatDatetimePicker",r)("formControl",e.fechacontable),k.Eb(1),k.pc("for",r),k.Eb(1),k.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),k.Eb(5),k.pc("formControl",e.form_caicae),k.Eb(3),k.Pc(k.lc(53,113,"Fecha CAI / CAE")),k.Eb(2),k.pc("ngxMatDatetimePicker",i)("formControl",e.fechacaicae),k.Eb(1),k.pc("for",i),k.Eb(1),k.pc("showSpinners",!0)("showSeconds",!0)("stepHour",1)("stepMinute",1)("stepSecond",1)("touchUi",!1)("color","white")("enableMeridian",!0)("disableMinute",!1)("hideTime",!0),k.Eb(4),k.Pc(k.lc(61,115,"Tipo de Factura")),k.Eb(2),k.pc("ngModel",e.form_tipoFactura)("disabled",e.tabla1.data.length>0||e.tipoFacturaBloqueado),k.Eb(1),k.pc("ngForOf",e.tiposFactura),k.Eb(1),k.pc("hidden",e.form_tipoFactura!=e.tiposFactura[0]),k.Eb(1),k.pc("formControl",e.form_afectarStock),k.Eb(2),k.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]&&e.form_afectarStock.value),k.Eb(5),k.pc("formControl",e.form_cantidad),k.Eb(1),k.pc("ngIf",e.form_tipoFactura==e.tiposFactura[0]),k.Eb(1),k.pc("ngIf",e.form_tipoFactura==e.tiposFactura[1]),k.Eb(2),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),k.Eb(1),k.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),k.Eb(1),k.pc("formControl",e.form_precio),k.Eb(1),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),k.Eb(4),k.Qc("",k.lc(84,117,"Guardar")," "),k.Eb(2),k.pc("@animate",k.vc(130,gt,k.uc(129,vt))),k.Eb(2),k.pc("columnMode","flex")("headerHeight",50)("footerHeight",50)("rowHeight",e.getRowHeight)("scrollbarV",!0)("scrollbarH",!1)("rows",e.tabla1.rows)("selectionType","single"),k.Eb(2),k.qc("name",k.lc(90,119,"Cantidad")),k.pc("cellClass",e.getCellClass)("flexGrow",1),k.Eb(3),k.qc("name",k.lc(93,121,"Concepto")),k.pc("cellClass",e.getCellClass)("flexGrow",2),k.Eb(3),k.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),k.Eb(1),k.pc("ngIf","Factura de Compra A"!=e.form_tipoDocumento&&"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),k.Eb(1),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),k.Eb(1),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"!=e.form_tipoDocumento),k.Eb(1),k.qc("name",k.lc(100,123,"SALES.ACTIONS")),k.pc("flexGrow",1)("minWidth",100),k.Eb(3),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),k.Eb(1),k.pc("ngIf",("Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento)&&0!=e.lista_impuestos.length),k.Eb(7),k.pc("formControl",e.subtotal),k.Eb(4),k.pc("formControl",e.form_descuento),k.Eb(1),k.pc("ngIf","Factura de Compra A"==e.form_tipoDocumento||"Nota de Cr\xe9dito A"==e.form_tipoDocumento),k.Eb(4),k.pc("formControl",e.total),k.Eb(1),k.pc("ngIf",!e.form_afectarStock.value),k.Eb(3),k.pc("disabled",e.guardando),k.Eb(3),k.Qc("",k.lc(127,125,"Guardar")," "),k.Eb(3),k.pc("disabled",e.guardando)("routerLink",k.uc(132,_t)),k.Eb(3),k.Qc("",k.lc(133,127,"Cancelar")," ")}},directives:[E.c,S.c,E.a,S.f,W.b,l.c,X.c,l.o,l.f,X.a,s.n,I.a,l.r,l.s,A.a,P.a,M.h,S.h,P.b,s.o,R.b,N.a,j.a,j.b,V.d,V.b,V.a,x.h,T.n],pipes:[U.c,s.b,s.g,s.d],styles:[""],data:{animation:[u.a]}}),bt),data:{title:"NUEVA COMPRA"}}],yt=c("u9T3"),Ft=c("f44v"),kt=c("iELJ"),Dt=c("jMqV"),wt=c("M9ds"),Ot=c("ZFy/"),xt=c("PCNd"),Et=c("BxcV"),St=c("OaSA"),Wt=((ht=function t(){a(this,t)}).\u0275mod=k.Pb({type:ht}),ht.\u0275inj=k.Ob({factory:function(t){return new(t||ht)},imports:[[s.c,l.t,yt.a,V.f,W.c,W.c,j.c,W.c,R.c,Ft.a,W.c,Ot.b,kt.f,O.b,Dt.b,wt.c,I.b,N.b,U.b,xt.a,X.b,Et.a,l.j,M.g,P.c,P.e,P.d,A.b,St.a,x.k.forChild(Ct)]]}),ht)},CHRX:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var c=r("wd/R"),n=function(){function t(){a(this,t),this.sum=[],this.data=[],this.rows=[],this.filter={},this.groups={},this.groupField="",this.secondarySort="",this.sortDir="asc",this.footer={},this.summaryRow=!0,this.emptyRow=!0,this.customFilter=function(t){return t}}return i(t,[{key:"setGroup",value:function(t){this.groups[t.name]=!this.groups[t.name],this.filterRows()}},{key:"setData",value:function(t){this.data=t,this.sortData()}},{key:"sortData",value:function(){var t=this;this.data.sort(function(e,o){if(e[t.groupField]==o[t.groupField]){if(t.secondarySort){if(null==e[t.secondarySort])return 1;if(null==o[t.secondarySort])return-1;if(e[t.secondarySort]>o[t.secondarySort])return 1*("desc"===t.sortDir?-1:1);if(e[t.secondarySort]<o[t.secondarySort])return-1*("desc"===t.sortDir?-1:1)}}else{if(null==e[t.groupField])return 1;if(null==o[t.groupField])return-1;if(e[t.groupField]>o[t.groupField])return 1;if(e[t.groupField]<o[t.groupField])return-1}return 0}),this.filterRows()}},{key:"filterRows",value:function(){var t=this,e=[];e=this.data.filter(function(e){for(var o in t.filter){if(t.filter[o]&&null==e[o])return!1;switch(typeof e[o]){case"number":if(t.filter[o]&&Math.trunc(e[o]).toString()!==Math.trunc(t.filter[o]).toString())return!1;break;case"string":if("f"==o.charAt(0).toLowerCase()&&c(e[o]).isValid){if(-1==c(e[o]).format("DD/MM/YYYY HH:mm:ss").indexOf(t.filter[o]))return!1;break}if(-1==e[o].toLowerCase().indexOf(t.filter[o].toLowerCase()))return!1}}return!0}),e=this.customFilter(e);var a={};this.groupField?a[this.groupField]=e.length.toString():a.count=e.length.toString(),this.sum.forEach(function(t){return a[t]=0});for(var r=0;r<e.length;r++)this.sum.forEach(function(t){return a[t]+=e[r][t]});if(a.isGroup=!0,this.footer=a,this.groupField){var i=[];e.forEach(function(e){-1==i.indexOf(e[t.groupField])&&i.push(e[t.groupField])}),i=i.map(function(t){return{name:t,count:1}});var n=[],s=!0,l=0,u=null,m=function(){u&&(u[t.groupField]+=" ("+i[l-1].count.toString()+")")};for(r=0;r<e.length;r++){if(s&&e[r][this.groupField]==i[l].name){var p;m();var d="+";this.groups[i[l].name]&&(d="-"),o(p={},this.groupField,d+" "+i[l].name),o(p,"isGroup",!0),o(p,"name",i[l].name),u=p,this.sum.forEach(function(t){return u[t]=0}),n.push(u),s=++l<i.length}else i[l-1].count++;this.sum.forEach(function(t){return u[t]+=e[r][t]}),n.push(e[r])}m(),e=null,n=n.filter(function(e){return!!e.isGroup||!!t.groups[e[t.groupField]]||void 0}),this.rows=n}else this.rows=e;this.summaryRow&&this.rows.push(this.footer),0==this.rows.length&&this.emptyRow&&this.rows.push({})}},{key:"updateFilter",value:function(t,e){if(t&&e){var o=t.target.value;t instanceof MouseEvent&&(o=""),this.filter[e]=o,this.filterRows()}return!0}},{key:"updateFilterBoolean",value:function(t,e){return this.filter[e]=t,this.filterRows(),!0}}],[{key:"prepararFiltroAPI",value:function(t){var e="";for(var o in t)t[o].search&&(e+="number"==typeof t[o].search?'{"'.concat(o,'":').concat(t[o].search,"},"):t[o].exact?'{"'.concat(o,'":"').concat(t[o].search,'"},'):'{"'.concat(o,'":{"ilike":"%').concat(t[o].search,'%"}},'));return e}}]),t}()},GmJt:function(t,e,o){"use strict";o.d(e,"a",function(){return i});var a=o("GS7A"),r=Object(a.g)([Object(a.l)({opacity:"{{opacity}}",transform:"scale({{scale}}) translate3d({{x}}, {{y}}, {{z}})"}),Object(a.e)("{{duration}} {{delay}} cubic-bezier(0.0, 0.0, 0.2, 1)",Object(a.l)("*"))],{params:{duration:"200ms",delay:"0ms",opacity:"0",scale:"1",x:"0",y:"0",z:"0"}}),i=[Object(a.n)("animate",[Object(a.m)("void => *",[Object(a.o)(r)])]),Object(a.n)("fadeInOut",[Object(a.k)("0",Object(a.l)({opacity:0,display:"none"})),Object(a.k)("1",Object(a.l)({opacity:1,display:"block"})),Object(a.m)("0 => 1",Object(a.e)("300ms")),Object(a.m)("1 => 0",Object(a.e)("300ms"))])]}}])}();